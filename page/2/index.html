<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="老司机种菜" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta property="og:type" content="website">
<meta property="og:title" content="老司机种菜">
<meta property="og:url" content="http://wodekouwei.com/page/2/index.html">
<meta property="og:site_name" content="老司机种菜">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="老司机种菜">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://wodekouwei.com/page/2/">





  <title> 老司机种菜 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2021aa5f03a4203621d42ef374e0d5f7";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">老司机种菜</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/06/17/l-python-env/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/06/17/l-python-env/" itemprop="url">
                  l-python-env
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-17T20:55:39+08:00">
                2019-06-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>pip install -r requirements.txt
conda install –yes –file requirements.txt</p>
<p>pip批量导出包含环境中所有组件的requirements.txt文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip freeze &gt; requirements.txt</span><br></pre></td></tr></table></figure>

<p>pip批量安装requirements.txt文件中包含的组件依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p>conda批量导出包含环境中所有组件的requirements.txt文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda list -e &gt; requirements.txt</span><br></pre></td></tr></table></figure>

<p>pip批量安装requirements.txt文件中包含的组件依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install --yes --file requirements.txt</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/06/16/l-python-sphinx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/06/16/l-python-sphinx/" itemprop="url">
                  使用sphinx自动提取python中的注释成为接口文档
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-16T22:32:18+08:00">
                2019-06-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/language/" itemprop="url" rel="index">
                    <span itemprop="name">language</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>写好了代码，交付给他人使用的时候，查看代码固然可以了解各类和函数的功能细节，但接口文档能更方便的查找和说明功能。所以，一价与代码同步的接口文档是很有必要的。sphinx可以根据python中的注释，自动的生成接口文档，这样有利于保证文档和代码功能的同步。让我们来了解如何自动生成文档。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class A:</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    你好！</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    @staticmethod</span><br><span class="line">    def Aa():</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        你也好！</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        fun1()</span><br></pre></td></tr></table></figure>

<p>看到类和函数中，都加入了注释。</p>
<ol start="2">
<li>安装shpinx<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install sphinx -i https://pypi.doubanio.com/simple --trusted-host pypi.doubanio.com</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>使用国内的镜像安装比较快。</p>
<ol start="3">
<li>配置shpinx<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ cd myproject</span><br><span class="line">$ sphinx-quickstart</span><br><span class="line">Enter the root path for documentation.</span><br><span class="line">&gt; Root path for the documentation [.]: doc</span><br><span class="line">&gt; Project name: XXX</span><br><span class="line">&gt; Author name(s): XXX</span><br><span class="line">&gt; Project version []: 1.0</span><br><span class="line">&gt; Project release [1.0]:</span><br><span class="line">&gt; Project language [en]: zh_CN  #如果注释中有中文，这里必须设置。否则生成接口文档出错。</span><br><span class="line">&gt; autodoc: automatically insert docstrings from modules (y/n) [n]: y</span><br><span class="line">其它项都选择默认</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>完成之后，会在当前目录创建 doc 目录，所有sphinx相关的文件都在 doc目录下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ ls doc/</span><br><span class="line">_build  conf.py  index.rst  Makefile  _static  _templates</span><br><span class="line">$ vi doc/conf.py  #修改文件内容</span><br><span class="line">sys.path.insert(0, os.path.abspath(&apos;.&apos;)) </span><br><span class="line">sys.path.insert(0, os.path.abspath(&apos;..&apos;)) #　缺少此行会导致在make html时提示 __import__出错，找不到module。 所以必须把上一级目录(即代码所在目录)include进来</span><br><span class="line"></span><br><span class="line">$ sphinx-apidoc -o doc/ .</span><br><span class="line">Creating file doc/a.rst.</span><br><span class="line">Creating file doc/modules.rst</span><br><span class="line"></span><br><span class="line"># 把生成的 doc/modules.rst添加到index.rst</span><br><span class="line">$ vi doc/index.rst</span><br><span class="line"></span><br><span class="line">Contents:</span><br><span class="line"> .. toctree::</span><br><span class="line">    :maxdepth: 2</span><br><span class="line"></span><br><span class="line">    modules.rst</span><br><span class="line"></span><br><span class="line">生成html页面</span><br><span class="line">$ cd doc</span><br><span class="line">$ make html</span><br></pre></td></tr></table></figure>

<p>生成的html文档，在doc/_build/html里。</p>
<p>sphinx对仅工作在python2.7 或python3上。当文件中有中文时，可能会报错：’ascii’ codec can’t decode byte 0xe2 in position xxx。可以在报错的地方加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(&apos;utf-8&apos;)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/06/16/db-redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/06/16/db-redis/" itemprop="url">
                  db-redis
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-16T18:10:22+08:00">
                2019-06-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="MAC环境安装"><a href="#MAC环境安装" class="headerlink" title="MAC环境安装"></a>MAC环境安装</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ol>
<li>首先是<a href="https://redis.io/" target="_blank" rel="noopener">官网</a>下载redis,下载 stable 版本，稳定版本。</li>
<li>安装与编译:</li>
</ol>
<ul>
<li>解压：<code>tar zxvf redis-4.0.10.tar.gz</code></li>
<li>移动到： <code>mv redis-4.0.10 /usr/local/</code></li>
<li>切换到：<code>cd /usr/local/redis-4.0.10/</code></li>
<li>编译测试 <code>sudo make test</code>,如果在第5步测试时报如下错：Executing test client: couldn’t execute “src/redis-benchmark”: no such file or directory.则执行以下两个步骤 <code>sudo make distclean</code>和<code>sudo make</code></li>
<li>编译安装 sudo make install</li>
</ul>
<ol start="3">
<li>安装成功测试:输入redis-server启动redis</li>
<li>测试redis:新建一个终端窗口，输入命令行redis-cli</li>
</ol>
<h3 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h3><p>在长时间不操作redis数据库，再次进行set key 值时，会报错误
(error) MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error．</p>
<p>（错误）misconf redis被配置以保存数据库快照，但misconf redis目前不能在硬盘上持久化。用来修改数据集合的命令不能用，请使用日志的错误详细信息。</p>
<p>解决方案如下：
运行　<code>config set stop-writes-on-bgsave-error no</code>命令,关闭配置项stop-writes-on-bgsave-error解决该问题。</p>
<h3 id="redis的配置"><a href="#redis的配置" class="headerlink" title="redis的配置"></a>redis的配置</h3><p> Redis 的配置文件位于 Redis 安装目录下，文件名为 redis.conf。</p>
<p>你可以通过 修改redis.conf配置和使用CONFIG  SET 命令设置配置项。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; CONFIG SET CONFIG_SETTING_NAME NEW_CONFIG_VALUE</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">redis 127.0.0.1:6379&gt; CONFIG SET loglevel &quot;notice&quot;</span><br><span class="line">OK</span><br><span class="line">redis 127.0.0.1:6379&gt; CONFIG GET loglevel</span><br><span class="line"> </span><br><span class="line">1) &quot;loglevel&quot;</span><br><span class="line">2) &quot;notice&quot;</span><br></pre></td></tr></table></figure>

<h4 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h4><p>redis.conf 配置项说明如下：</p>
<ol>
<li><p>Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">daemonize no</span><br></pre></td></tr></table></figure>
</li>
<li><p>当Redis以守护进程方式运行时，Redis默认会把pid写入/var/run/redis.pid文件，可以通过pidfile指定</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pidfile /var/run/redis.pid</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定Redis监听端口，默认端口为6379，作者在自己的一篇博文中解释了为什么选用6379作为默认端口，因为6379在手机按键上MERZ对应的号码，而MERZ取自意大利歌女Alessia Merz的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">port 6379</span><br></pre></td></tr></table></figure>
</li>
<li><p>绑定的主机地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bind 127.0.0.1</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>5.当 客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">timeout 300</span><br></pre></td></tr></table></figure>

<ol start="6">
<li><p>指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loglevel verbose</span><br></pre></td></tr></table></figure>
</li>
<li><p>日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logfile stdout</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置数据库的数量，默认数据库为0，可以使用<code>SELECT &lt;dbid&gt;</code>命令在连接上指定数据库id</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">databases 16</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">save &lt;seconds&gt; &lt;changes&gt;</span><br><span class="line">Redis默认配置文件中提供了三个条件：</span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line">分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdbcompression yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定本地数据库文件名，默认值为dump.rdb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbfilename dump.rdb</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定本地数据库存放目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir ./</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>当master服务设置了密码保护时，slav服务连接master的密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">masterauth &lt;master-password&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过<code>AUTH &lt;password&gt;</code>命令提供密码，默认关闭</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requirepass foobared</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置 maxclients 0，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maxclients 128</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，会把Key存放内存，Value会存放在swap区</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maxmemory &lt;bytes&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">appendonly no</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定更新日志文件名，默认为appendonly.aof</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">appendfilename appendonly.aof</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定更新日志条件，共有3个可选值： </p>
<ul>
<li>no：表示等操作系统进行数据缓存同步到磁盘（快） </li>
<li>always：表示每次更新操作后手动调用fsync()将数据写到磁盘（慢，安全） </li>
<li>everysec：表示每秒同步一次（折衷，默认值）</li>
</ul>
<p>appendfsync everysec</p>
</li>
<li><p>指定是否启用虚拟内存机制，默认值为no，简单的介绍一下，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中（在后面的文章我会仔细分析Redis的VM机制）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm-enabled no</span><br></pre></td></tr></table></figure>
</li>
<li><p>虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm-swap-file /tmp/redis.swap</span><br></pre></td></tr></table></figure>
</li>
<li><p>将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据 就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm-max-memory 0</span><br></pre></td></tr></table></figure>
</li>
<li><p>Redis swap文件分成了很多的page，一个对象可以保存在多个page上面，但一个page上不能被多个对象共享，vm-page-size是要根据存储的 数据大小来设定的，作者建议如果存储很多小对象，page大小最好设置为32或者64bytes；如果存储很大大对象，则可以使用更大的page，如果不 确定，就使用默认值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm-page-size 32</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置swap文件中的page数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，，在磁盘上每8个pages将消耗1byte的内存。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm-pages 134217728</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vm-max-threads 4</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glueoutputbuf yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hash-max-zipmap-entries 64</span><br><span class="line"></span><br><span class="line">hash-max-zipmap-value 512</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定是否激活重置哈希，默认为开启（后面在介绍Redis的哈希算法时具体介绍）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">activerehashing yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include /path/to/local.conf</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://www.runoob.com/redis/redis-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/redis/redis-tutorial.html</a></p>
<h2 id="Centos环境安装"><a href="#Centos环境安装" class="headerlink" title="Centos环境安装"></a>Centos环境安装</h2><p>下载地址：<a href="https://redis.io/download" target="_blank" rel="noopener">https://redis.io/download</a></p>
<h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><p>下载源码，解压缩到 /usr/local/ 重命名成 redis，编译安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-5.0.5.tar.gz</span><br><span class="line">cd /usr/local</span><br><span class="line">tar xzf /root/redis-5.0.5.tar.gz</span><br><span class="line">mv redis-5.0.5 redis</span><br><span class="line">cd redis</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<p>复制配置文件到 /etc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp redis.conf /etc/</span><br></pre></td></tr></table></figure>

<p>参数查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server --help</span><br></pre></td></tr></table></figure>

<p>版本参看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server -v</span><br></pre></td></tr></table></figure>

<h3 id="启动Redis服务器"><a href="#启动Redis服务器" class="headerlink" title="启动Redis服务器"></a>启动Redis服务器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis.conf</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：此命令仅有一个启动参数，指定/path/to/redis.conf目录下的配置文件，不加参数执行默认配置。</p>
</blockquote>
<p>退出关闭按 ctlr+c</p>
<p>设置后台运行，进入etc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/redis.conf</span><br></pre></td></tr></table></figure>

<p>修改 daemonize no 为 daemonize yes，这样就可以默认启动就后台运行</p>
<p>测试启动，返回PONG，启动成功。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server /etc/redis.conf</span><br><span class="line">redis-cli ping</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-4.0.1]# netstat -tulnp | grep 6379 </span><br><span class="line">tcp        0      0 127.0.0.1:6379              0.0.0.0:*                   LISTEN      7949/redis-server 1</span><br></pre></td></tr></table></figure>

<p>停止Redis</p>
<h3 id="关闭服务"><a href="#关闭服务" class="headerlink" title="关闭服务"></a>关闭服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-cli shutdown</span><br><span class="line">netstat -tulnp | grep 6379</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli ping</span><br></pre></td></tr></table></figure>

<p>Could not connect to Redis at 127.0.0.1:6379: Connection refused</p>
<blockquote>
<p>注:可指定端口:<code>redis-cli -p &lt;port&gt; shutdown</code></p>
</blockquote>
<h3 id="连接Redis"><a href="#连接Redis" class="headerlink" title="连接Redis"></a>连接Redis</h3><p>两种链接redis的方法：
方法一、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">redis-cli      #也可以指定ip，端口号启动redis（redis-cli -h 192.168.1.2 -p 6379） </span><br><span class="line">127.0.0.1:6379&gt;  </span><br><span class="line">127.0.0.1:6379&gt; quit</span><br></pre></td></tr></table></figure>

<p>方法二、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.1.2 6379 </span><br><span class="line">Trying 192.168.1.2... </span><br><span class="line">Connected to 192.168.1.2. </span><br><span class="line">Escape character is &apos;^]&apos;. </span><br><span class="line">quit </span><br><span class="line">+OK </span><br><span class="line">Connection closed by foreign host</span><br></pre></td></tr></table></figure>

<h3 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h3><p>设置 /etc/redis.conf 中 daemonize 为 yes，确保守护进程开启,也就是在后台可以运行.(设置为yes后,启动时好像没有redis的启动界面,不知道为什么)
编写脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/init.d/redis</span><br></pre></td></tr></table></figure>

<p>复制下面代码到脚本中(注意要修改里面redis的安装路径,以 /usr/local/redis 路径为例)(这段代码就是redis根目录 /utils/redis_init_script 启动脚本的代码)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"># chkconfig: 2345 10 90  </span><br><span class="line"># description: Start and Stop redis   </span><br><span class="line"></span><br><span class="line">REDISPORT=6379</span><br><span class="line">EXEC=/usr/local/redis/src/redis-server</span><br><span class="line">CLIEXEC=/usr/local/redis/src/redis-cli</span><br><span class="line"></span><br><span class="line">PIDFILE=/var/run/redis_$&#123;REDISPORT&#125;.pid</span><br><span class="line">CONF=&quot;/etc/redis.conf&quot;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">    start)</span><br><span class="line">        if [ -f $PIDFILE ]</span><br><span class="line">        then</span><br><span class="line">                echo &quot;$PIDFILE exists, process is already running or crashed&quot;</span><br><span class="line">        else</span><br><span class="line">                echo &quot;Starting Redis server...&quot;</span><br><span class="line">                $EXEC $CONF &amp;</span><br><span class="line">        fi</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        if [ ! -f $PIDFILE ]</span><br><span class="line">        then</span><br><span class="line">                echo &quot;$PIDFILE does not exist, process is not running&quot;</span><br><span class="line">        else</span><br><span class="line">                PID=$(cat $PIDFILE)</span><br><span class="line">                echo &quot;Stopping ...&quot;</span><br><span class="line">                $CLIEXEC -p $REDISPORT shutdown</span><br><span class="line">                while [ -x /proc/$&#123;PID&#125; ]</span><br><span class="line">                do</span><br><span class="line">                    echo &quot;Waiting for Redis to shutdown ...&quot;</span><br><span class="line">                    sleep 1</span><br><span class="line">                done</span><br><span class="line">                echo &quot;Redis stopped&quot;</span><br><span class="line">        fi</span><br><span class="line">        ;;</span><br><span class="line">    restart)</span><br><span class="line">        &quot;$0&quot; stop</span><br><span class="line">        sleep 3</span><br><span class="line">        &quot;$0&quot; start</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        echo &quot;Please use start or stop or restart as first argument&quot;</span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<p>保存退出,设置权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /etc/init.d/redis</span><br></pre></td></tr></table></figure>

<p>启动redis</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service redis start</span><br></pre></td></tr></table></figure>

<p>设置开机启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig redis on</span><br></pre></td></tr></table></figure>

<p>测试开机启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p>开机完成测试redis是否打开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli ping</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/06/16/db-mongo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/06/16/db-mongo/" itemprop="url">
                  db-mongo
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-16T18:02:48+08:00">
                2019-06-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Mongo之安装"><a href="#Mongo之安装" class="headerlink" title="Mongo之安装"></a>Mongo之安装</h3><p><a href="https://docs.mongodb.com/master/tutorial/install-mongodb-on-os-x/?_ga=1.77041618.692823854.1464012466" target="_blank" rel="noopener">参考</a></p>
<h4 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a>Centos</h4><h5 id="1-下载安装包"><a href="#1-下载安装包" class="headerlink" title="1.下载安装包"></a>1.下载安装包</h5><p>远程安装mongodb压缩包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-3.4.9.tgz</span><br></pre></td></tr></table></figure>

<h5 id="2-解压缩安装包"><a href="#2-解压缩安装包" class="headerlink" title="2.解压缩安装包"></a>2.解压缩安装包</h5><p>在/opt下创建modules文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir modules</span><br></pre></td></tr></table></figure>

<p>然后解压到这里:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">tar -xzvf mongodb-linux-x86_64-3.4.9.tgz -C /opt/modules/</span><br></pre></td></tr></table></figure>

<p>进入modules文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/modules/</span><br></pre></td></tr></table></figure>

<p>重命名为mongodb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv mongodb-linux-x86_64-3.4.9 mongodb </span><br><span class="line">cd mongodb/</span><br></pre></td></tr></table></figure>

<h5 id="3-创建数据库存放目录和日志存放目录"><a href="#3-创建数据库存放目录和日志存放目录" class="headerlink" title="3.创建数据库存放目录和日志存放目录"></a>3.创建数据库存放目录和日志存放目录</h5><p>将服务的数据存放在/opt/data目录下,需要创建db目录用于存放数据库文件,logs目录存放日志文件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /opt/data/mongodb/data </span><br><span class="line">mkdir -p /opt/data/mongodb/data/db </span><br><span class="line">mkdir -p /opt/data/mongodb/data/logs </span><br><span class="line">touch /opt/data/mongodb/data/logs/mogodb.log</span><br></pre></td></tr></table></figure>

<h5 id="4-创建MongoDB配置文件mongodb-conf"><a href="#4-创建MongoDB配置文件mongodb-conf" class="headerlink" title="4.创建MongoDB配置文件mongodb.conf"></a>4.创建MongoDB配置文件mongodb.conf</h5><p>mongodb.conf主要配置MongoDB的监听端口,数据库目录,日志存放位置,日志输出方式以及是否开启后台运行等:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/data/mongodb/data/ </span><br><span class="line">vim mongodb.conf</span><br></pre></td></tr></table></figure>

<p>mongodb.conf 具体配置信息如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 端口号 </span><br><span class="line">port=27017</span><br><span class="line"># 数据库路径 </span><br><span class="line">dbpath=/opt/data/mongodb/data/db </span><br><span class="line"># 日志输出文件路径 </span><br><span class="line">logpath=/opt/data/mongodb/data/logs/mongodb.log </span><br><span class="line">pidfilepath=/opt/data/mongodb/data/mongo.pid </span><br><span class="line"># 设置后台运行 </span><br><span class="line">fork=true </span><br><span class="line"># 日志输出方式 </span><br><span class="line">logappend=true</span><br><span class="line"># 启动http界面,端口号为28017 </span><br><span class="line">httpinterface=true</span><br></pre></td></tr></table></figure>

<h5 id="5-启动MongoDB服务"><a href="#5-启动MongoDB服务" class="headerlink" title="5.启动MongoDB服务"></a>5.启动MongoDB服务</h5><p>执行以下命令启动MongoDB服务:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/modules/mongodb/ </span><br><span class="line">bin/mongod --config /opt/data/mongodb/data/mongodb.conf</span><br></pre></td></tr></table></figure>

<p>会打印下面信息：about to fork child process, waiting until server is ready for connections.
forked process: 20913
child process started successfully, parent exiting</p>
<h5 id="6-验证MongoDB服务是否启动成功"><a href="#6-验证MongoDB服务是否启动成功" class="headerlink" title="6.验证MongoDB服务是否启动成功"></a>6.验证MongoDB服务是否启动成功</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i:27017</span><br></pre></td></tr></table></figure>

<p>成功打印COMMAND   PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
mongod  20913 root    7u  IPv4 376964      0t0  TCP *:27017 (LISTEN)
可以通过ip访问,http://你的公网ip:28017/, 显示数据库一些信息,说明启动成功了
It looks like you are trying to access MongoDB over HTTP on the native driver port.</p>
<h4 id="ubuntu环境"><a href="#ubuntu环境" class="headerlink" title="ubuntu环境"></a>ubuntu环境</h4><p><a href="https://docs.mongodb.com/master/tutorial/install-mongodb-on-ubuntu/" target="_blank" rel="noopener">ubunut下安装</a></p>
<h6 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h6><ol>
<li><p>Update Homebrew’s package database.
 In a system shell ,issue the following command:</p>
<blockquote>
<p>brew update</p>
</blockquote>
</li>
<li><p>Install MongoDB.
 You can install MongoDB via brew with several different options.Use one of the following operations:</p>
<ul>
<li><p>Install the MongoDB binaries
  To install the MongoDB binaries ,issue the following command in system shell:</p>
<blockquote>
<p>brew install mongodb</p>
</blockquote>
</li>
<li><p>Install the MongoDB Binaries with TLS/SSL Support
  To install the MongoDB binaries that have TLS/SSL suport ,issue the following from a system shell:</p>
<blockquote>
<p>brew install mongodb –with-openssl</p>
</blockquote>
</li>
<li><p>Install the Lastest Development Release of MongoDB
  To install the lastest development release for use in testing and development,issue the following command in a system shell:</p>
<blockquote>
<p>brew install mongodb –devel</p>
</blockquote>
</li>
</ul>
</li>
<li><p>Install MongoDB Community Edition Manually.
Only install MongoDB Community Edition using this procedure if you cannot use homebrew.</p>
<ul>
<li>Download the binary files for the desired release of MongoDB<pre><code>Download the binaries from https://www.mongodb.org/downloads.
For example, to download the latest release through the shell, issue the following:</code></pre><blockquote>
<p>curl -O <a href="https://fastdl.mongodb.org/osx/mongodb-osx-x86_64-3.2.6.tgz" target="_blank" rel="noopener">https://fastdl.mongodb.org/osx/mongodb-osx-x86_64-3.2.6.tgz</a></p>
</blockquote>
</li>
<li>Extract the files from the downloaded archive.<pre><code>For example, from a system shell, you can extract through the tar command:</code></pre><blockquote>
<p>tar -zxvf mongodb-osx-x86_64-3.2.6.tgz</p>
</blockquote>
</li>
<li>Copy the extracted archive to the target directo<pre><code>Copy the extracted folder to the location from which MongoDB will run.</code></pre><blockquote>
<p>mkdir -p mongodb</p>
<pre><code>cp -R -n mongodb-osx-x86_64-3.2.6/ mongodb</code></pre></blockquote>
</li>
<li>Ensure the location of the binaries is in the PATH variable.<pre><code>The MongoDB binaries are in the bin/ directory of the archive. To ensure that the binaries are in your PATH, you can modify your PATH.
For example, you can add the following line to your shell’s rc file (e.g. ~/.bashrc):</code></pre><blockquote>
<p>export PATH=<mongodb-install-directory>/bin:$PATH</mongodb-install-directory></p>
</blockquote>
</li>
</ul>
</li>
</ol>
<p>Replace <mongodb-install-directory> with the path to the extracted MongoDB archive.</mongodb-install-directory></p>
<h6 id="brew-安装结果"><a href="#brew-安装结果" class="headerlink" title="brew 安装结果"></a>brew 安装结果</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">brew install mongodb</span><br><span class="line">==&gt; Installing dependencies for mongodb: openssl</span><br><span class="line">==&gt; Installing mongodb dependency: openssl</span><br><span class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/openssl-1.0.2h_1.el_capitan</span><br><span class="line">######################################################################## 100.0%</span><br><span class="line">==&gt; Pouring openssl-1.0.2h_1.el_capitan.bottle.tar.gz</span><br><span class="line">==&gt; Caveats</span><br><span class="line">A CA file has been bootstrapped using certificates from the system</span><br><span class="line">keychain. To add additional certificates, place .pem files in</span><br><span class="line">  /usr/local/etc/openssl/certs</span><br><span class="line"></span><br><span class="line">and run</span><br><span class="line">  /usr/local/opt/openssl/bin/c_rehash</span><br><span class="line"></span><br><span class="line">This formula is keg-only, which means it was not symlinked into /usr/local.</span><br><span class="line"></span><br><span class="line">Apple has deprecated use of OpenSSL in favor of its own TLS and crypto libraries</span><br><span class="line"></span><br><span class="line">Generally there are no consequences of this for you. If you build your</span><br><span class="line">own software and it requires this formula, you&apos;ll need to add to your</span><br><span class="line">build variables:</span><br><span class="line"></span><br><span class="line">    LDFLAGS:  -L/usr/local/opt/openssl/lib</span><br><span class="line">    CPPFLAGS: -I/usr/local/opt/openssl/include</span><br><span class="line"></span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /usr/local/Cellar/openssl/1.0.2h_1: 1,691 files, 12M</span><br><span class="line">==&gt; Installing mongodb</span><br><span class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/mongodb-3.2.6.el_capitan.bo</span><br><span class="line">######################################################################## 100.0%</span><br><span class="line">==&gt; Pouring mongodb-3.2.6.el_capitan.bottle.tar.gz</span><br><span class="line">==&gt; Caveats</span><br><span class="line">To have launchd start mongodb now and restart at login:</span><br><span class="line">  brew services start mongodb</span><br><span class="line">Or, if you don&apos;t want/need a background service you can just run:</span><br><span class="line">  mongod --config /usr/local/etc/mongod.conf</span><br><span class="line">==&gt; Summary</span><br><span class="line">🍺  /usr/local/Cellar/mongodb/3.2.6: 17 files, 263.8M</span><br></pre></td></tr></table></figure>

<h6 id="Run-MongoDB"><a href="#Run-MongoDB" class="headerlink" title="Run MongoDB"></a>Run MongoDB</h6><p>1.Create the data directory
Before you start MongoDB for the first time ,create the directory to which the mongod process will write data.By default ,the mongod process uses the /data/db/directory.If you create a directory other than this one ,you must specify that directory in the dbpath option when starting the mongod proecss later in this peocedure.
The following example command creates the default /data/db directory:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/db</span><br></pre></td></tr></table></figure>

<p>2.Set permissions for the data direcory.
Before running mongod for the first time,ensure that the user account running mongod has read and write permissions for the directory.
3.Run MongoDB.
To run MongoDB,run the mongod process at the system prompt.If necessary,specify the path the mongod or the data directory.See the following examples.</p>
<ul>
<li><p>Run without specifying paths
If your system Path variable includes the location of the mongod binary and if you use the default data directory(i.e.,/data/db),simply enter mongod at the system prompt:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod</span><br></pre></td></tr></table></figure>
</li>
<li><p>Specify the path of the mongod
If your PATH does not include the location of the mongod binary,enter the full path to the mongod binary at the system prompt:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;path to binary&gt;/mongod</span><br></pre></td></tr></table></figure>
</li>
<li><p>Specify the path of the data directory
If you do not use the defautl data directory (i.i.,/data/db),specify the path to the data directory using the –dbpath option:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath &lt;path to data directory&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Begin using MongoDB.
mongod 默认数据保存路径:/data/db/    默认端口:27017
修改默认路径:–dbpath
修改默认端口:–port
启动后台服务:–fork(必须使用–logpath自动创建日志输出目录)</p>
</li>
</ul>
<h6 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h6><p>1.启动</p>
<ul>
<li>mongod 启动mongo服务</li>
<li>mongo 启动客户端</li>
</ul>
<p>2.停止服务</p>
<ul>
<li><p>方法一
ps -ef | grep mongodb 找到你要查找的进程号
kill - 2 pid  杀掉</p>
</li>
<li><p>方法二
进入mongo数据库里面进行操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mongo</span><br><span class="line">use admin</span><br><span class="line">db.shutdownServer();</span><br></pre></td></tr></table></figure>
</li>
<li><p>错误
在linux下大家停止很多服务喜欢直接kill -9 PID,但是对于MongoDB如果执行了kill - 9 PID,在下次启动时可能提示错误,导致服务无法启动,这个时候可以通过执行:rm -f path/db/mongod.lock,也即删除指定数据目录下的mongod.lock问价即可.</p>
</li>
</ul>
<h4 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h4><p>I’ve just installed MOngoDB via homebrew und want to start it via command line mongod.</p>
<p>When I do that, i’ll get this message:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">2016-03-05T19:23:55.763+0100 I CONTROL  [initandlisten] MongoDB starting : pid=52426 port=27017 dbpath=/data/db 64-bit host=Matthias-MBP</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten] db version v3.2.3</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten] git version: b326ba837cf6f49d65c2f85e1b70f6f31ece7937</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten] allocator: system</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten] modules: none</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten] build environment:</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten]     distarch: x86_64</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten]     target_arch: x86_64</span><br><span class="line">2016-03-05T19:23:55.764+0100 I CONTROL  [initandlisten] options: &#123;&#125;</span><br><span class="line">2016-03-05T19:23:55.765+0100 I -        [initandlisten] Detected data files in /data/db created by the &apos;wiredTiger&apos; storage engine, so setting the active storage engine to &apos;wiredTiger&apos;.</span><br><span class="line">2016-03-05T19:23:55.765+0100 I STORAGE  [initandlisten] wiredtiger_open config: create,cache_size=4G,session_max=20000,eviction=(threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000),checkpoint=(wait=60,log_size=2GB),statistics_log=(wait=0),</span><br><span class="line">2016-03-05T19:23:56.483+0100 I CONTROL  [initandlisten]</span><br><span class="line">2016-03-05T19:23:56.483+0100 I CONTROL  [initandlisten] ** WARNING: soft rlimits too low. Number of files is 256, should be at least 1000</span><br><span class="line">2016-03-05T19:23:56.486+0100 I NETWORK  [HostnameCanonicalizationWorker] Starting hostname canonicalization worker</span><br><span class="line">2016-03-05T19:23:56.486+0100 I FTDC     [initandlisten] Initializing full-time diagnostic data capture with directory &apos;/data/db/diagnostic.data&apos;</span><br><span class="line">2016-03-05T19:23:56.488+0100 I NETWORK  [initandlisten] waiting for connections on port 27017</span><br><span class="line">2016-03-05T19:23:56.513+0100 W NETWORK  [HostnameCanonicalizationWorker] Failed to obtain address information for hostname Matthias-MBP: nodename nor servname provided, or not known</span><br></pre></td></tr></table></figure>

<p>The last line doesn’t sound correct. What is the problem?
The first line of logs says</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MongoDB starting : pid=52426 port=27017 dbpath=/data/db 64-bit host=Matthias-MBP&quot;.</span><br></pre></td></tr></table></figure>

<p>Notice that host name is Matthias-MBP, so you can add 127.0.0.1 Matthias-MBP in /etc/hosts file. After Ctrl-C and re-run mongod, the error message will disappear.</p>
<h2 id="操作相关"><a href="#操作相关" class="headerlink" title="操作相关"></a>操作相关</h2><h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><ol>
<li><p>Help查看命令提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">help</span><br><span class="line">db.help();</span><br><span class="line">db.yourColl.help();</span><br><span class="line">db.youColl.find().help();</span><br><span class="line">rs.help();</span><br></pre></td></tr></table></figure>
</li>
<li><p>切换/创建数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;use yourDB;</span><br><span class="line">当创建一个集合(table)的时候会自动创建当前数据库</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询所有数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show dbs;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除当前使用数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.dropDatabase();</span><br></pre></td></tr></table></figure>
</li>
<li><p>从指定主机上克隆数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.cloneDatabase(“127.0.0.1”);</span><br><span class="line">将指定机器上的数据库的数据克隆到当前数据库</span><br></pre></td></tr></table></figure>
</li>
<li><p>从指定的机器上复制指定数据库数据到某个数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.copyDatabase(&quot;mydb&quot;, &quot;temp&quot;, &quot;127.0.0.1&quot;);</span><br><span class="line">将本机的mydb的数据复制到temp数据库中</span><br></pre></td></tr></table></figure>
</li>
<li><p>修复当前数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.repairDatabase();</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前使用的数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.getName();</span><br><span class="line">db;</span><br><span class="line">db和getName方法是一样的效果，都可以查询当前使用的数据库</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示当前db状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.stats();</span><br></pre></td></tr></table></figure>
</li>
<li><p>当前db版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.version();</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前db的链接机器地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getMongo();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="Collection聚集集合"><a href="#Collection聚集集合" class="headerlink" title="Collection聚集集合"></a>Collection聚集集合</h3><ol>
<li><p>创建一个聚集集合（table）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(“collName”, &#123;size: 20, capped: 5, max: 100&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>得到指定名称的聚集集合（table）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(&quot;account&quot;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>得到当前db的所有聚集集合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getCollectionNames();</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示当前db所有聚集索引的状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.printCollectionStats();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="用户相关"><a href="#用户相关" class="headerlink" title="用户相关"></a>用户相关</h3><ol>
<li>添加一个用户<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.addUser(&quot;name&quot;);</span><br><span class="line">db.addUser(&quot;userName&quot;, &quot;pwd123&quot;, true);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>添加用户、设置密码、是否只读</p>
<ol start="2">
<li><p>数据库认证、安全模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.auth(&quot;userName&quot;, &quot;123123&quot;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示当前所有用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show users;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.removeUser(&quot;userName&quot;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ol>
<li><p>查询之前的错误信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getPrevError();</span><br></pre></td></tr></table></figure>
</li>
<li><p>清除错误记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.resetError();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Collection聚合集合操作"><a href="#Collection聚合集合操作" class="headerlink" title="Collection聚合集合操作"></a>Collection聚合集合操作</h2><p>###查看聚集集合基本信息</p>
<ol>
<li><p>查看帮助</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.yourColl.help();</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询当前集合的数据条数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.yourColl.count();</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看数据空间大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.dataSize();</span><br></pre></td></tr></table></figure>
</li>
<li><p>得到当前聚集集合所在的db</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.getDB();</span><br></pre></td></tr></table></figure>
</li>
<li><p>得到当前聚集的状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.stats();</span><br></pre></td></tr></table></figure>
</li>
<li><p>得到聚集集合总大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.totalSize();</span><br></pre></td></tr></table></figure>
</li>
<li><p>聚集集合储存空间大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.storageSize();</span><br></pre></td></tr></table></figure>
</li>
<li><p>Shard版本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.getShardVersion()</span><br></pre></td></tr></table></figure>
</li>
<li><p>聚集集合重命名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.renameCollection(&quot;users&quot;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>将userInfo重命名为users</p>
<ol start="10">
<li>删除当前聚集集合<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.drop();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="聚集集合查询"><a href="#聚集集合查询" class="headerlink" title="聚集集合查询"></a>聚集集合查询</h3><ol>
<li>查询所有记录<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.find();</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>相当于：<code>select * from userInfo;</code>
默认每页显示20条记录，当显示不下的情况下，可以用it迭代命令查询下一页数据。注意：键入it命令不能带“；”
但是你可以设置每页显示数据的大小，用DBQuery.shellBatchSize = 50;这样每页就显示50条记录了。</p>
<ol start="2">
<li>查询去掉后的当前聚集集合中的某列的重复数据<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.distinct(&quot;name&quot;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>会过滤掉name中的相同数据
相当于：<code>select distict name from userInfo;</code></p>
<ol start="3">
<li><p>查询age = 22的记录
<code>db.userInfo.find({&quot;age&quot;: 22});</code>
相当于： <code>select * from userInfo where age = 22;</code></p>
</li>
<li><p>查询age &gt; 22的记录
<code>db.userInfo.find({age: {$gt: 22}});</code>
相当于：<code>select * from userInfo where age &gt; 22;</code></p>
</li>
<li><p>查询age &lt; 22的记录
<code>db.userInfo.find({age: {$lt: 22}});</code>
相当于：<code>select * from userInfo where age &lt; 22;</code></p>
</li>
<li><p>查询age &gt;= 25的记录
<code>db.userInfo.find({age: {$gte: 25}});</code>
相当于：<code>select * from userInfo where age &gt;= 25;</code></p>
</li>
<li><p>查询age &lt;= 25的记录
<code>db.userInfo.find({age: {$lte: 25}});</code></p>
</li>
<li><p>查询age &gt;= 23 并且 age &lt;= 26
<code>db.userInfo.find({age: {$gte: 23, $lte: 26}});</code></p>
</li>
<li><p>查询name中包含 mongo的数据
<code>db.userInfo.find({name: /mongo/});</code>
//相当于%%
<code>select * from userInfo where name like ‘%mongo%’;</code></p>
</li>
<li><p>查询name中以mongo开头的
<code>db.userInfo.find({name: /^mongo/});</code>
<code>select * from userInfo where name like ‘mongo%’;</code></p>
</li>
<li><p>查询指定列name、age数据
<code>db.userInfo.find({}, {name: 1, age: 1});</code>
相当于：<code>select name, age from userInfo;</code>
当然name也可以用true或false,当用ture的情况下河name:1效果一样，如果用false就是排除name，显示name以外的列信息。</p>
</li>
</ol>
<p>12、查询指定列name、age数据, age &gt; 25
<code>db.userInfo.find({age: {$gt: 25}}, {name: 1, age: 1});</code>
相当于：<code>select name, age from userInfo where age &gt; 25;</code></p>
<ol start="13">
<li><p>按照年龄排序
升序：<code>db.userInfo.find().sort({age: 1});</code>
降序：<code>db.userInfo.find().sort({age: -1});</code></p>
</li>
<li><p>查询name = zhangsan, age = 22的数据
<code>db.userInfo.find({name: &#39;zhangsan&#39;, age: 22});</code>
相当于：<code>select * from userInfo where name = ‘zhangsan’ and age = ‘22’;</code></p>
</li>
<li><p>查询前5条数据
<code>db.userInfo.find().limit(5);</code>
相当于：<code>select top 5 * from userInfo;</code></p>
</li>
<li><p>查询10条以后的数据
<code>db.userInfo.find().skip(10);</code>
相当于：<code>select * from userInfo where id not in (
select top 10 * from userInfo
);</code></p>
</li>
<li><p>查询在5-10之间的数据
<code>db.userInfo.find().limit(10).skip(5);</code>
可用于分页，limit是pageSize，skip是第几页*pageSize</p>
</li>
<li><p>or与 查询
<code>db.userInfo.find({$or: [{age: 22}, {age: 25}]});</code>
相当于：<code>select * from userInfo where age = 22 or age = 25;</code></p>
</li>
<li><p>查询第一条数据
<code>db.userInfo.findOne();</code>
相当于：<code>select top 1 * from userInfo;
db.userInfo.find().limit(1);</code></p>
</li>
<li><p>查询某个结果集的记录条数
<code>db.userInfo.find({age: {$gte: 25}}).count();</code>
相当于：<code>select count(*) from userInfo where age &gt;= 20;</code></p>
</li>
<li><p>按照某列进行排序
<code>db.userInfo.find({sex: {$exists: true}}).count();</code>
相当于：<code>select count(sex) from userInfo;</code></p>
</li>
</ol>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><ol>
<li><p>创建索引</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.userInfo.ensureIndex(&#123;name: 1&#125;);</span><br><span class="line">db.userInfo.ensureIndex(&#123;name: 1, ts: -1&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询当前聚集集合所有索引
<code>db.userInfo.getIndexes();</code></p>
</li>
<li><p>查看总索引记录大小
<code>db.userInfo.totalIndexSize();</code></p>
</li>
<li><p>读取当前集合的所有index信息
<code>db.users.reIndex();</code></p>
</li>
<li><p>删除指定索引
<code>db.users.dropIndex(&quot;name_1&quot;);</code></p>
</li>
<li><p>删除所有索引索引
<code>db.users.dropIndexes();</code></p>
</li>
</ol>
<h3 id="修改、添加、删除集合数据"><a href="#修改、添加、删除集合数据" class="headerlink" title="修改、添加、删除集合数据"></a>修改、添加、删除集合数据</h3><ol>
<li><p>添加
<code>db.users.save({name: ‘zhangsan’, age: 25, sex: true});</code>
添加的数据的数据列，没有固定，根据添加的数据为准</p>
</li>
<li><p>修改
<code>db.users.update({age: 25}, {$set: {name: &#39;changeName&#39;}}, false, true);</code>
相当于：<code>update users set name = ‘changeName’ where age = 25;</code></p>
</li>
</ol>
<p><code>db.users.update({name: &#39;Lisi&#39;}, {$inc: {age: 50}}, false, true);</code>
相当于：<code>update users set age = age + 50 where name = ‘Lisi’;</code></p>
<p><code>db.users.update({name: &#39;Lisi&#39;}, {$inc: {age: 50}, $set: {name: &#39;hoho&#39;}}, false, true);</code>
相当于：<code>update users set age = age + 50, name = ‘hoho’ where name = ‘Lisi’;</code></p>
<ol start="3">
<li><p>删除
<code>db.users.remove({age: 132});</code></p>
</li>
<li><p>查询修改删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db.users.findAndModify(&#123;</span><br><span class="line">    query: &#123;age: &#123;$gte: 25&#125;&#125;,</span><br><span class="line">    sort: &#123;age: -1&#125;,</span><br><span class="line">    update: &#123;$set: &#123;name: &apos;a2&apos;&#125;, $inc: &#123;age: 2&#125;&#125;,</span><br><span class="line">    remove: true</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">db.runCommand(&#123; findandmodify : &quot;users&quot;,</span><br><span class="line">    query: &#123;age: &#123;$gte: 25&#125;&#125;,</span><br><span class="line">    sort: &#123;age: -1&#125;,</span><br><span class="line">    update: &#123;$set: &#123;name: &apos;a2&apos;&#125;, $inc: &#123;age: 2&#125;&#125;,</span><br><span class="line">    remove: true</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>update 或 remove 其中一个是必须的参数; 其他参数可选。
|参数|详解|默认值|
|—|—|—|
|query|查询过滤条件|{}|
|sort|如果多个文档符合查询过滤条件，将以该参数指定的排列方式选择出排在首位的对象，该对象将被操作|{}|
|remove|若为true，被选中对象将在返回前被删除|N/A|
|update|一个 修改器对象|N/A|
|new|若为true，将返回修改后的对象而不是原始对象。在删除操作中，该参数被忽略。|false|
|fields|参见Retrieving a Subset of Fields (1.5.0+)|All fields|
|upsert|创建新对象若查询结果为空。 示例 (1.5.4+)|false|</p>
<h3 id="语句块操作"><a href="#语句块操作" class="headerlink" title="语句块操作"></a>语句块操作</h3><ol>
<li><p>简单Hello World
<code>print(&quot;Hello World!&quot;);</code>
这种写法调用了print函数，和直接写入”Hello World!”的效果是一样的；</p>
</li>
<li><p>将一个对象转换成json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tojson(new Object());</span><br><span class="line">tojson(new Object(&apos;a&apos;));</span><br></pre></td></tr></table></figure>
</li>
<li><p>循环添加数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; for (var i = 0; i &lt; 30; i++) &#123;</span><br><span class="line">... db.users.save(&#123;name: &quot;u_&quot; + i, age: 22 + i, sex: i % 2&#125;);</span><br><span class="line">... &#125;;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>这样就循环添加了30条数据，同样也可以省略括号的写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; for (var i = 0; i &lt; 30; i++) db.users.save(&#123;name: &quot;u_&quot; + i, age: 22 + i, sex: i % 2&#125;);</span><br></pre></td></tr></table></figure>

<p>也是可以的，当你用db.users.find()查询的时候，显示多条数据而无法一页显示的情况下，可以用it查看下一页的信息；</p>
<ol start="4">
<li>find 游标查询<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;var cursor = db.users.find();</span><br><span class="line">&gt; while (cursor.hasNext()) &#123;</span><br><span class="line">    printjson(cursor.next());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>这样就查询所有的users信息，同样可以这样写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var cursor = db.users.find();</span><br><span class="line">while (cursor.hasNext()) &#123; printjson(cursor.next); &#125;</span><br></pre></td></tr></table></figure>

<p>同样可以省略{}号</p>
<ol start="5">
<li><p>forEach迭代循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.users.find().forEach(printjson);</span><br><span class="line">forEach中必须传递一个函数来处理每条迭代的数据信息</span><br></pre></td></tr></table></figure>
</li>
<li><p>将find游标当数组处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var cursor = db.users.find();</span><br><span class="line">cursor[4];</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>取得下标索引为4的那条数据
既然可以当做数组处理，那么就可以获得它的长度：cursor.length();或者cursor.count();
那样我们也可以用循环显示数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for (var i = 0, len = c.length(); i &lt; len; i++) printjson(c[i]);</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>将find游标转换成数组<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; var arr = db.users.find().toArray();</span><br><span class="line">&gt; printjson(arr[2]);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>用toArray方法将其转换为数组</p>
<ol start="8">
<li>定制我们自己的查询结果
只显示age &lt;= 28的并且只显示age这列数据<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.users.find(&#123;age: &#123;$lte: 28&#125;&#125;, &#123;age: 1&#125;).forEach(printjson);</span><br><span class="line">db.users.find(&#123;age: &#123;$lte: 28&#125;&#125;, &#123;age: true&#125;).forEach(printjson);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>排除age的列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.users.find(&#123;age: &#123;$lte: 28&#125;&#125;, &#123;age: false&#125;).forEach(printjson);</span><br></pre></td></tr></table></figure>

<ol start="9">
<li>forEach传递函数显示信息<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.things.find(&#123;x:4&#125;).forEach(function(x) &#123;print(tojson(x));&#125;);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>上面介绍过forEach需要传递一个函数，函数会接受一个参数，就是当前循环的对象，然后在函数体重处理传入的参数</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/05/26/env-centos-gitlab/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/05/26/env-centos-gitlab/" itemprop="url">
                  env-centos-gitlab
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-26T11:52:46+08:00">
                2019-05-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/env/" itemprop="url" rel="index">
                    <span itemprop="name">env</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、-安装并配置必要的依赖关系"><a href="#一、-安装并配置必要的依赖关系" class="headerlink" title="一、 安装并配置必要的依赖关系"></a>一、 安装并配置必要的依赖关系</h3><p>在CentOS系统上安装所需的依赖：ssh，防火墙,postfix(用于邮件通知) ，wget，以下这些命令也会打开系统防火墙中的HTTP和SSH端口访问。</p>
<ol>
<li><p>安装ssh: <code>sudo yum install -y curl policycoreutils-pythonopenssh-server</code></p>
</li>
<li><p>将SSH服务设置成开机自启动，安装命令：<code>sudo systemctl enable sshd</code></p>
</li>
<li><p>启动SSH服务，安装命令：<code>sudo systemctl start sshd</code></p>
</li>
<li><p>安装防火墙（如果已经安装了防火墙并且已经在运行状态，则可直接进行第6步）:<code>yum install firewalld systemd -y</code></p>
</li>
<li><p>开启防火墙，安装命令：<code>service firewalld  start</code></p>
</li>
<li><p>添加http服务到firewalld,pemmanent表示永久生效，若不加–permanent系统下次启动后就会失效。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#开放ssh、http服务</span><br><span class="line">sudo firewall-cmd --add-service=ssh --permanent</span><br><span class="line">sudo firewall-cmd --add-service=http --permanent</span><br><span class="line"></span><br><span class="line">#重载防火墙规则</span><br><span class="line">sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>
</li>
<li><p>接下来，安装Postfix以发送通知邮件，安装命令：<code>sudo yum install postfix</code></p>
</li>
<li><p>将postfix服务设置成开机自启动，安装命令：<code>sudo systemctl enable postfix</code></p>
</li>
<li><p>启动postfix，安装命令：<code>sudo systemctl start postfix</code>
遇到问题:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Job for postfix.service failed because the control process exited with error code. See &quot;systemctl status postfix.service&quot; and &quot;journalctl -xe&quot; for details.</span><br><span class="line">(cmdb) [root@node1 ~]# journalctl -xe</span><br><span class="line">Jan 21 16:30:01 node1.cn systemd[1]: Starting Session 764 of user root.</span><br><span class="line">-- Subject: Unit session-764.scope has begun start-up</span><br><span class="line">-- Defined-By: systemd</span><br><span class="line">-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel</span><br><span class="line"></span><br><span class="line">▽ Unit session-764.scope has begun starting up.</span><br><span class="line">Jan 21 16:30:01 node1.cn CROND[5943]: (root) CMD (/usr/lib64/sa/sa1 1 1)</span><br><span class="line">Jan 21 16:30:21 node1.cn polkitd[450]: Registered Authentication Agent for unix-process:5950:36693241 (system bus name :1.1600 [/usr/bin/pkttyagent --notify-fd 5 --fallback], object path /org</span><br><span class="line">Jan 21 16:30:21 node1.cn systemd[1]: Reloading.</span><br><span class="line">Jan 21 16:30:21 node1.cn systemd[1]: Configuration file /usr/lib/systemd/system/eni.service is marked world-inaccessible. This has no effect as configuration data is accessible via APIs witho</span><br><span class="line">Jan 21 16:30:21 node1.cn polkitd[450]: Unregistered Authentication Agent for unix-process:5950:36693241 (system bus name :1.1600, object path /org/freedesktop/PolicyKit1/AuthenticationAgent, </span><br><span class="line">Jan 21 16:30:28 node1.cn polkitd[450]: Registered Authentication Agent for unix-process:5967:36693923 (system bus name :1.1601 [/usr/bin/pkttyagent --notify-fd 5 --fallback], object path /org</span><br><span class="line">Jan 21 16:30:28 node1.cn systemd[1]: Starting Postfix Mail Transport Agent...</span><br><span class="line">-- Subject: Unit postfix.service has begun start-up</span><br><span class="line">-- Defined-By: systemd</span><br><span class="line">-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel</span><br><span class="line">-- </span><br><span class="line">-- Unit postfix.service has begun starting up.</span><br><span class="line">Jan 21 16:30:28 node1.cn aliasesdb[5973]: /usr/sbin/postconf: fatal: parameter inet_interfaces: no local interface found for ::1</span><br><span class="line">Jan 21 16:30:29 node1.cn postfix/sendmail[5975]: fatal: parameter inet_interfaces: no local interface found for ::1</span><br><span class="line">Jan 21 16:30:29 node1.cn aliasesdb[5973]: newaliases: fatal: parameter inet_interfaces: no local interface found for ::1</span><br><span class="line">Jan 21 16:30:29 node1.cn postfix[5978]: fatal: parameter inet_interfaces: no local interface found for ::1</span><br><span class="line">Jan 21 16:30:30 node1.cn systemd[1]: postfix.service: control process exited, code=exited status=1</span><br><span class="line">Jan 21 16:30:30 node1.cn systemd[1]: Failed to start Postfix Mail Transport Agent.</span><br><span class="line">-- Subject: Unit postfix.service has failed</span><br><span class="line">-- Defined-By: systemd</span><br><span class="line">-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>解决方法：
修改 /etc/postfix/main.cf的设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inet_protocols = ipv4</span><br><span class="line">inet_interfaces = all</span><br></pre></td></tr></table></figure>

<p>重新启动postfix即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start postfix.service</span><br></pre></td></tr></table></figure>

<h3 id="二、-安装"><a href="#二、-安装" class="headerlink" title="二、 安装"></a>二、 安装</h3><h4 id="1、YUM安装gitlab"><a href="#1、YUM安装gitlab" class="headerlink" title="1、YUM安装gitlab"></a>1、YUM安装gitlab</h4><p>添加GitLab社区版Package</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></figure>

<p>安装GitLab社区版</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y gitlab-ce</span><br></pre></td></tr></table></figure>

<h4 id="2、配置GitLab站点Url"><a href="#2、配置GitLab站点Url" class="headerlink" title="2、配置GitLab站点Url"></a>2、配置GitLab站点Url</h4><p>GitLab默认的配置文件路径是/etc/gitlab/gitlab.rb</p>
<p>默认的站点Url配置项是：
external_url ‘<a href="http://gitlab.example.com:8082&#39;" target="_blank" rel="noopener">http://gitlab.example.com:8082&#39;</a></p>
<p>这里我将GitLab站点Url修改为<a href="http://git.wodekouwei.com" target="_blank" rel="noopener">http://git.wodekouwei.com</a>
也可以用IP代替域名，这里根据自己需求来即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#修改配置文件</span><br><span class="line">sudo vi /etc/gitlab/gitlab.rb</span><br><span class="line"></span><br><span class="line">#配置首页地址（大约在第15行）</span><br><span class="line">external_url &apos;http://git.wodekouwei.com:8082&apos;</span><br></pre></td></tr></table></figure>

<h4 id="2、配置端口号"><a href="#2、配置端口号" class="headerlink" title="2、配置端口号"></a>2、配置端口号</h4><p>修改nginx端口<code>sudo vi /etc/gitlab/gitlab.rb</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx[&apos;listen_port&apos;] = 8083</span><br><span class="line">unicorn[&apos;port&apos;] = 8092</span><br></pre></td></tr></table></figure>

<p>修改<code>/var/opt/gitlab/gitlab-rails/etc/unicorn.rb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">listen &quot;127.0.0.1:8092&quot;, :tcp_nopush =&gt; true</span><br></pre></td></tr></table></figure>

<p><code>sudo vi /var/opt/gitlab/nginx/conf/gitlab-http.conf</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen *:8083;</span><br></pre></td></tr></table></figure>

<p>修改unicorn端口<code>sudo vi /etc/gitlab/gitlab.rb</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unicorn[&apos;port&apos;] = 8092</span><br></pre></td></tr></table></figure>

<p>保存配置，重启</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl reconfigure</span><br><span class="line">sudo gitlab-ctl restart</span><br><span class="line">sudo gitlab-ctl status</span><br></pre></td></tr></table></figure>

<p>sudo gitlab-ctl tail</p>
<p>如果还是想从80端口访问gitlab，我们可以用监听在80端口的nginx做一个反向代理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service nginx restart</span><br></pre></td></tr></table></figure>

<p>后可以正常访问。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name gitlab.123.123.cn;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        #rewrite ^(.*) http://127.0.0.1:8082;</span><br><span class="line">        proxy_pass http://127.0.0.1:8082;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、配置smtp邮件发送"><a href="#3、配置smtp邮件发送" class="headerlink" title="3、配置smtp邮件发送"></a>3、配置smtp邮件发送</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vi /etc/gitlab/gitlab.rb                            </span><br><span class="line"># Change the external_url to the address your users will type in their browser</span><br><span class="line">external_url &apos;http://xxhost.com&apos;</span><br><span class="line"></span><br><span class="line">#Sending application email via SMTP</span><br><span class="line">gitlab_rails[&apos;smtp_enable&apos;] = true</span><br><span class="line">gitlab_rails[&apos;smtp_address&apos;] = &quot;smtp.163.com&quot;</span><br><span class="line">gitlab_rails[&apos;smtp_port&apos;] = 25 </span><br><span class="line">gitlab_rails[&apos;smtp_user_name&apos;] = &quot;xxuser@163.com&quot;</span><br><span class="line">gitlab_rails[&apos;smtp_password&apos;] = &quot;xxpassword&quot;</span><br><span class="line">gitlab_rails[&apos;smtp_domain&apos;] = &quot;163.com&quot;</span><br><span class="line">gitlab_rails[&apos;smtp_authentication&apos;] = :login</span><br><span class="line">gitlab_rails[&apos;smtp_enable_starttls_auto&apos;] = true</span><br><span class="line"></span><br><span class="line">##修改gitlab配置的发信人</span><br><span class="line">gitlab_rails[&apos;gitlab_email_from&apos;] = &quot;xxuser@163.com&quot;</span><br><span class="line">user[&quot;git_user_email&quot;] = &quot;xxuser@163.com&quot;</span><br></pre></td></tr></table></figure>

<h4 id="4、启动并访问GitLab"><a href="#4、启动并访问GitLab" class="headerlink" title="4、启动并访问GitLab"></a>4、启动并访问GitLab</h4><p>启动GitLab</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#重新配置并启动</span><br><span class="line">sudo gitlab-ctl reconfigure</span><br><span class="line"></span><br><span class="line">#完成后将会看到如下输出</span><br><span class="line">Running handlers complete</span><br><span class="line">Chef Client finished, 432/613 resources updated in 03 minutes 43 seconds</span><br><span class="line">gitlab Reconfigured!</span><br></pre></td></tr></table></figure>

<p>访问GitLab
将设置的域名DNS解析到服务器IP，或者修改本地host将域名指向服务器IP。
访问：<a href="http://git.wodekouwei.com:8082" target="_blank" rel="noopener">http://git.wodekouwei.com:8082</a></p>
<h3 id="三、GitLab常用配置"><a href="#三、GitLab常用配置" class="headerlink" title="三、GitLab常用配置"></a>三、GitLab常用配置</h3><h4 id="1、禁用创建组权限"><a href="#1、禁用创建组权限" class="headerlink" title="1、禁用创建组权限"></a>1、禁用创建组权限</h4><p>GitLab默认所有的注册用户都可以创建组。但对于团队来说，通常只会给Leader相关权限。
虽然可以在用户管理界面取消权限，但毕竟不方便。我们可以通过配置GitLab默认禁用创建组权限。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#修改配置文件</span><br><span class="line">sudo vi /etc/gitlab/gitlab.rb</span><br><span class="line"></span><br><span class="line">#开启gitlab_rails[&apos;gitlab_default_can_create_group&apos;] 选项，并将值设置为false</span><br><span class="line">### GitLab user privileges</span><br><span class="line">gitlab_rails[&apos;gitlab_default_can_create_group&apos;] = false</span><br><span class="line"></span><br><span class="line">#保存后，重新配置并启动GitLab</span><br><span class="line">sudo gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>

<h4 id="2、gitlab-ctl常用命令介绍"><a href="#2、gitlab-ctl常用命令介绍" class="headerlink" title="2、gitlab-ctl常用命令介绍"></a>2、gitlab-ctl常用命令介绍</h4><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>check-config</td>
<td>检查在gitlab中是否有任何配置。在指定版本中删除的rb</td>
</tr>
<tr>
<td>deploy-page</td>
<td>安装部署页面</td>
</tr>
<tr>
<td>diff-config</td>
<td>将用户配置与包可用配置进行比较</td>
</tr>
<tr>
<td>remove-accounts</td>
<td>删除所有用户和组</td>
</tr>
<tr>
<td>upgrade</td>
<td>升级</td>
</tr>
<tr>
<td>service-list</td>
<td>查看所有服务</td>
</tr>
<tr>
<td>once</td>
<td>如果GitLab服务停止了就启动服务，如果已启动就不做任何操作</td>
</tr>
<tr>
<td>restart</td>
<td>重启GitLab服务</td>
</tr>
<tr>
<td>start</td>
<td>如果GitLab服务停止了就启动服务，如果已启动就重启服务</td>
</tr>
<tr>
<td>stop</td>
<td>停止GitLab服务</td>
</tr>
<tr>
<td>status</td>
<td>查看GitLab服务状态</td>
</tr>
<tr>
<td>reconfigure</td>
<td>reconfigure重新配置GitLab并启动</td>
</tr>
</tbody></table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/05/13/tips-res1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/05/13/tips-res1/" itemprop="url">
                  tips-res1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-13T17:18:49+08:00">
                2019-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>关于我</p>
<ul>
<li>区长</li>
<li><a href="https://fucknmb.com" target="_blank" rel="noopener">区长的独立博客</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy" target="_blank" rel="noopener">CSDN博客-区长</a></li>
<li><a href="https://lizhangqu.github.io/" target="_blank" rel="noopener">github博客</a></li>
<li><a href="http://www.weibo.com/u/3262478847/home" target="_blank" rel="noopener">新浪微博-_区长</a></li>
<li><a href="https://www.zhihu.com/people/lizhangqu" target="_blank" rel="noopener">知乎-区长</a></li>
<li><a href="li330324@gmail.com">邮箱-li330324@gmail.com</a></li>
</ul>
</blockquote>
<h3 id="扔物线（凯哥）的-HenCoder"><a href="#扔物线（凯哥）的-HenCoder" class="headerlink" title="扔物线（凯哥）的 HenCoder"></a>扔物线（凯哥）的 HenCoder</h3><ul>
<li><a href="http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="noopener">给 Android 开发者的 RxJava 详解</a></li>
<li><a href="https://github.com/hencoder" target="_blank" rel="noopener">hencoder</a></li>
<li><a href="http://hencoder.com/overview/" target="_blank" rel="noopener">HenCoder：给高级 Android 工程师的进阶手册</a></li>
<li><a href="http://hencoder.com/ui-1-1" target="_blank" rel="noopener">Android 开发进阶: 自定义 View 1-1 绘制基础</a></li>
<li><a href="http://hencoder.com/ui-1-2/" target="_blank" rel="noopener">Android 开发进阶: 自定义 View 1-2 Paint 详解</a></li>
<li><a href="http://hencoder.com/ui-1-3/" target="_blank" rel="noopener">Android 开发进阶: 自定义 View 1-3 文字的绘制</a></li>
<li><a href="http://hencoder.com/ui-1-4/" target="_blank" rel="noopener">Android 开发进阶: 自定义 View 1-4 Canvas 对绘制的辅助</a></li>
</ul>
<h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><ul>
<li><a href="https://github.com/veggiemonk/awesome-docker/blob/master/README.md" target="_blank" rel="noopener">awesome-docker</a></li>
</ul>
<h3 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h3><ul>
<li><a href="http://fucknmb.com/2017/06/02/%E5%BD%93Android%E5%BC%80%E5%8F%91%E8%80%85%E9%81%87%E8%A7%81TensorFlow/" target="_blank" rel="noopener">当 Android 开发者遇见 TensorFlow</a></li>
<li><a href="https://morvanzhou.github.io/about/" target="_blank" rel="noopener">莫烦Python</a></li>
<li><a href="http://blog.topspeedsnail.com/" target="_blank" rel="noopener">TensorFlow练习</a></li>
<li><a href="https://github.com/Tencent/ncnn" target="_blank" rel="noopener">Tencent/ncnn</a></li>
</ul>
<h3 id="输入法"><a href="#输入法" class="headerlink" title="输入法"></a>输入法</h3><ul>
<li><a href="https://developer.android.com/guide/topics/text/creating-input-method.html" target="_blank" rel="noopener">Creating an Input Method</a></li>
<li><a href="https://developer.android.com/guide/topics/text/image-keyboard.html" target="_blank" rel="noopener">Image Keyboard Support</a></li>
<li><a href="https://github.com/lizhangqu/PinyinIME" target="_blank" rel="noopener">谷歌拼音输入法Android Studio工程</a></li>
<li><a href="https://android.googlesource.com/platform/development/+/master/samples/SoftKeyboard/" target="_blank" rel="noopener">谷歌示例代码-全键盘输入法例子</a></li>
<li><a href="http://stackoverflow.com/questions/3185237/android-keyboard-keys-background" target="_blank" rel="noopener">android-keyboard-keys-background</a></li>
<li><a href="http://stackoverflow.com/questions/17714172/how-to-change-key-background-of-any-key-in-android-soft-keyboard" target="_blank" rel="noopener">how-to-change-key-background-of-any-key-in-android-soft-keyboard</a></li>
<li><a href="http://burnignorance.com/android-apps-development/setting-keyboard-key-background-image/" target="_blank" rel="noopener">setting-keyboard-key-background-image/</a></li>
<li><a href="http://stackoverflow.com/questions/15789997/how-to-change-background-color-of-key-for-android-soft-keyboard" target="_blank" rel="noopener">how-to-change-background-color-of-key-for-android-soft-keyboard</a></li>
<li><a href="http://stackoverflow.com/questions/18180136/how-to-change-background-color-or-theme-of-keys-dynamically-in-custom-keyboard-a" target="_blank" rel="noopener">how-to-change-background-color-or-theme-of-keys-dynamically-in-custom-keyboard-a</a></li>
<li><a href="https://developer.android.com/reference/android/inputmethodservice/Keyboard.Key.html" target="_blank" rel="noopener">Keyboard.Key</a></li>
<li><a href="http://stackoverflow.com/questions/18224520/how-to-set-different-background-of-keys-for-android-custom-keyboard" target="_blank" rel="noopener">how-to-set-different-background-of-keys-for-android-custom-keyboard</a></li>
<li><a href="http://www.blackcj.com/blog/2016/03/30/building-a-custom-android-keyboard/" target="_blank" rel="noopener">building-a-custom-android-keyboard</a></li>
<li><a href="https://github.com/zeuxisoo/android-emoji-keyboard" target="_blank" rel="noopener">android-emoji-keyboard</a></li>
<li><a href="https://stackoverflow.com/questions/7752580/creating-a-softkeyboard-with-multiple-alternate-characters-per-key" target="_blank" rel="noopener">creating-a-softkeyboard-with-multiple-alternate-characters-per-key</a></li>
<li><a href="http://stackoverflow.com/questions/7770099/how-do-you-disable-the-softkeyboard-key-preview-window" target="_blank" rel="noopener">禁用预览</a></li>
</ul>
<h3 id="Emoji"><a href="#Emoji" class="headerlink" title="Emoji"></a>Emoji</h3><ul>
<li><a href="https://en.wikipedia.org/wiki/Emoji" target="_blank" rel="noopener">wiki Emoji</a></li>
<li><a href="https://www.webpagefx.com/tools/emoji-cheat-sheet/" target="_blank" rel="noopener">emoji-cheat-sheet</a></li>
<li><a href="http://www.oicqzone.com/tool/emoji/" target="_blank" rel="noopener">emoji</a></li>
<li><a href="http://unicode.org/emoji/charts-beta/full-emoji-list.html" target="_blank" rel="noopener">full-emoji-list</a></li>
</ul>
<h3 id="网络栈"><a href="#网络栈" class="headerlink" title="网络栈"></a>网络栈</h3><ul>
<li><a href="http://hanpfei.github.io/" target="_blank" rel="noopener">Chromium网络栈 WolfcsTech</a></li>
<li><a href="https://github.com/lizhangqu/chromium-net-for-android" target="_blank" rel="noopener">chromium-net-for-android</a></li>
<li><a href="https://github.com/lizhangqu/CurlForAndroid" target="_blank" rel="noopener">CurlForAndroid</a></li>
<li><a href="https://cs.chromium.org/chromium/src/" target="_blank" rel="noopener">chromium src</a></li>
<li><a href="http://luohaha.github.io/Chinese-uvbook/source/networking.html" target="_blank" rel="noopener">libuv中文教程</a></li>
</ul>
<h3 id="交叉编译"><a href="#交叉编译" class="headerlink" title="交叉编译"></a>交叉编译</h3><ul>
<li><a href="http://fucknmb.com/2017/06/27/cmake-%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">cmake 交叉编译</a></li>
<li><a href="http://fucknmb.com/2017/06/24/Android-Gradle-Plugin%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8BexternalNativeBuild/" target="_blank" rel="noopener">Android Gradle Plugin 源码解析之 externalNativeBuild</a></li>
<li><a href="http://fucknmb.com/2017/06/22/NDK%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E5%B8%B8%E7%94%A8%E5%8F%98%E9%87%8F/" target="_blank" rel="noopener">NDK 交叉编译常用变量</a></li>
<li><a href="http://fucknmb.com/2017/06/12/Chromium-%E7%BD%91%E7%BB%9C%E6%A0%88%E7%9A%84%E7%BC%96%E8%AF%91%E4%B8%8E%E4%BD%BF%E7%94%A8/" target="_blank" rel="noopener">Chromium 网络栈的编译与使用</a></li>
<li><a href="http://fucknmb.com/2017/05/24/CURL-NDK%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">CURL NDK 交叉编译</a></li>
<li><a href="http://fucknmb.com/2017/06/05/Android-NDK-%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E6%A3%80%E6%B5%8B/" target="_blank" rel="noopener">Android NDK 内存泄露检测</a></li>
<li><a href="http://fucknmb.com/2017/06/04/libuv-NDK%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">libuv NDK 交叉编译</a></li>
<li><a href="http://fucknmb.com/2017/05/24/openssl-NDK%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">openssl NDK 交叉编译</a></li>
<li><a href="http://fucknmb.com/2017/05/24/libnghttp2-NDK%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">libnghttp2 NDK 交叉编译</a></li>
<li><a href="http://fucknmb.com/2017/05/11/Android-Studio-Library%E6%A8%A1%E5%9D%97%E4%B8%ADNative%E4%BB%A3%E7%A0%81%E8%BF%9B%E8%A1%8Cdebug%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/" target="_blank" rel="noopener">Android Studio Library 模块中 Native 代码进行 debug 的一些坑</a></li>
<li><a href="http://fucknmb.com/2017/04/09/Android%E5%9C%A8NDK%E5%B1%82%E4%BD%BF%E7%94%A8OpenSSL%E8%BF%9B%E8%A1%8CRSA%E5%8A%A0%E5%AF%86/" target="_blank" rel="noopener">Android 在 NDK 层使用 OpenSSL 进行 RSA 加密</a></li>
</ul>
<h3 id="Sping-Boot"><a href="#Sping-Boot" class="headerlink" title="Sping Boot"></a>Sping Boot</h3><ul>
<li><a href="http://udn.yyuap.com/doc/Spring-Boot-Reference-Guide/I.%20Spring%20Boot%20Documentation/index.html" target="_blank" rel="noopener">Spring Boot文档</a></li>
<li><a href="https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples" target="_blank" rel="noopener">spring-boot-samples</a></li>
<li><a href="https://github.com/ityouknow/spring-boot-examples" target="_blank" rel="noopener">Spring Boot Examples</a></li>
</ul>
<h3 id="微信小程序"><a href="#微信小程序" class="headerlink" title="微信小程序"></a>微信小程序</h3><ul>
<li><a href="https://github.com/justjavac/awesome-wechat-weapp" target="_blank" rel="noopener">awesome-wechat-weapp</a></li>
<li><a href="https://github.com/Notedown-cn/wxopen" target="_blank" rel="noopener">文档</a></li>
<li><a href="https://github.com/gavinkwoe/weapp-ide-crack" target="_blank" rel="noopener">ide破解</a></li>
</ul>
<h3 id="HTTP2-0"><a href="#HTTP2-0" class="headerlink" title="HTTP2.0"></a>HTTP2.0</h3><ul>
<li><a href="http://fucknmb.com/2017/01/17/Https&Http2.0&HttpDNS%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/" target="_blank" rel="noopener">Https&amp;Http2.0&amp;HttpDNS 的那些事</a></li>
<li><a href="https://tools.keycdn.com/http2-test" target="_blank" rel="noopener">测试是否支持http2.0，需翻墙</a></li>
<li><a href="http://www.httpvshttps.com/" target="_blank" rel="noopener">httpvshttps</a></li>
<li><a href="https://chrome.google.com/webstore/detail/mpbpobfflnpcgagjijhmgnchggcjblin" target="_blank" rel="noopener">chrome 插件HTTP/2 and SPDY indicator</a></li>
<li><a href="https://imququ.com/post/http2-resource.html" target="_blank" rel="noopener">HTTP/2 资料汇总</a></li>
<li><a href="http://mrpeak.cn/blog/http2/" target="_blank" rel="noopener">HTTP 2.0的那些事</a></li>
<li><a href="https://http2.github.io/http2-spec/#malformed" target="_blank" rel="noopener">http2-spec</a></li>
<li><a href="https://imququ.com/post/why-tls-handshake-failed-with-http2-enabled.html?f=http://blogread.cn/" target="_blank" rel="noopener">从启用 HTTP/2 导致网站无法访问说起</a></li>
<li><a href="http://httpwg.org/specs/rfc7541.html" target="_blank" rel="noopener">Header Compression for HTTP/2
</a></li>
<li><a href="http://httpwg.org/specs/rfc7540.html" target="_blank" rel="noopener">Hypertext Transfer Protocol Version 2 </a></li>
</ul>
<h3 id="Android-性能优化"><a href="#Android-性能优化" class="headerlink" title="Android 性能优化"></a>Android 性能优化</h3><ul>
<li><a href="https://github.com/Juude/awesome-android-performance" target="_blank" rel="noopener">Android性能优化视频，文档以及工具</a></li>
<li><a href="http://hukai.me/blog/archives/" target="_blank" rel="noopener">胡凯-性能优化</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/42238627" target="_blank" rel="noopener">Android最佳性能实践(1)：合理管理内存</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/42238633" target="_blank" rel="noopener">Android最佳性能实践(2)：分析内存的使用情况</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/42318689" target="_blank" rel="noopener">Android最佳性能实践(3)：高性能编码优化</a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/43376527" target="_blank" rel="noopener">Android最佳性能实践(4)：布局优化技巧</a></li>
<li><a href="https://github.com/moduth/blockcanary" target="_blank" rel="noopener">blockcanary-轻松找出Android App界面卡顿元凶</a></li>
<li><a href="http://blog.csdn.net/yanzhenjie1003/article/details/52201896" target="_blank" rel="noopener">Android Splash页秒开 Activity白屏 Activity黑屏</a></li>
</ul>
<h3 id="Android-Hybrid-amp-JSBridge技术"><a href="#Android-Hybrid-amp-JSBridge技术" class="headerlink" title="Android Hybrid&amp;JSBridge技术"></a>Android Hybrid&amp;JSBridge技术</h3><ul>
<li><a href="http://www.cnblogs.com/yexiaochai/p/4921635.html" target="_blank" rel="noopener">浅谈Hybrid技术的设计与实现</a></li>
<li><a href="http://www.tuicool.com/articles/m6RVFfA" target="_blank" rel="noopener">谈谈App混合开发</a></li>
<li><a href="http://blog.csdn.net/xyz_lmn/article/details/39399225" target="_blank" rel="noopener">在WebView中如何让JS与Java安全地互相调用</a></li>
<li><a href="http://blog.csdn.net/marshalchen/article/details/11124541" target="_blank" rel="noopener">WebView中接口隐患与手机挂马利用</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/50752595" target="_blank" rel="noopener"> Android JSBridge的原理与实现</a></li>
</ul>
<h3 id="React-Native-与-Weex-专题"><a href="#React-Native-与-Weex-专题" class="headerlink" title="React Native 与 Weex 专题"></a>React Native 与 Weex 专题</h3><ul>
<li><a href="http://alibaba.github.io/weex/" target="_blank" rel="noopener">weex</a></li>
<li><a href="https://segmentfault.com/a/1190000004586390" target="_blank" rel="noopener">深入源码探索 ReactNative 通信机制</a></li>
<li><a href="https://segmentfault.com/a/1190000004743424" target="_blank" rel="noopener">React Native首屏白屏优化</a></li>
<li><a href="http://www.lcode.org/react-native/" target="_blank" rel="noopener">React Native专题系列文章更新ing(涉及基础,组件,进阶以及开源项目)</a></li>
<li><a href="http://richard-cao.github.io/2015/12/03/React-native-Android-热更新/" target="_blank" rel="noopener">React-native-Android-热更新</a></li>
<li><a href="https://github.com/ele828/react-native-guide" target="_blank" rel="noopener">React-Native学习指南</a></li>
<li><a href="http://facebook.github.io/react-native/" target="_blank" rel="noopener">Facebook的react-native</a></li>
<li><a href="http://www.liaohuqiu.net/cn/posts/react-native-1/" target="_blank" rel="noopener">React Native: 配置和起步</a></li>
<li><a href="http://www.liaohuqiu.net/cn/posts/react-native-android-package/" target="_blank" rel="noopener">React Native: Android 的打包</a></li>
<li><a href="http://www.jianshu.com/p/847a54e0c385" target="_blank" rel="noopener">React Native For Android初体验</a></li>
<li><a href="https://github.com/w4lle/JianDan-React-Native" target="_blank" rel="noopener">JianDan-React-Native</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI1MTA1MzM2Nw==&mid=207782506&idx=1&sn=3ff6b03c0d59fbda406f64739d9272cf&scene=1&srcid=1009Q3qo6mLeT2ydjdzUwLQ7&from=groupmessage&isappinstalled=0#rd" target="_blank" rel="noopener">React Native For Android 架构初探</a></li>
<li><a href="https://github.com/race604/react-native-viewpager" target="_blank" rel="noopener">react-native-viewpager</a></li>
<li><a href="http://www.race604.com/react-native-android-practice/" target="_blank" rel="noopener">React Native for Android 实践 – 实现知乎日报客户端</a></li>
<li><a href="http://blog.desmondyao.com/2016/07/02/rn-bridge/" target="_blank" rel="noopener">【React Native for Android】jsBridge实现原理</a></li>
<li><a href="http://zjutkz.net/2016/05/03/%E5%85%B6%E5%AE%9E%E6%B2%A1%E9%82%A3%E4%B9%88%E5%A4%8D%E6%9D%82%EF%BC%81%E6%8E%A2%E7%A9%B6react-native%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/" target="_blank" rel="noopener">其实没那么复杂！探究react-native通信机制</a></li>
</ul>
<h3 id="Android插件化开发与动态加载"><a href="#Android插件化开发与动态加载" class="headerlink" title="Android插件化开发与动态加载"></a>Android插件化开发与动态加载</h3><ul>
<li><a href="https://github.com/Qihoo360/RePlugin" target="_blank" rel="noopener">360的RePlugin</a></li>
<li><a href="https://github.com/Qihoo360/DroidPlugin" target="_blank" rel="noopener">360的DroidPlugin</a></li>
<li><a href="https://github.com/didi/VirtualAPK" target="_blank" rel="noopener">滴滴的VirtualAPK</a></li>
<li><a href="https://github.com/alibaba/Atlas" target="_blank" rel="noopener">手淘的Atlas</a></li>
<li><a href="https://github.com/wequick/Small" target="_blank" rel="noopener">Small</a></li>
<li><a href="https://github.com/CtripMobile/DynamicAPK" target="_blank" rel="noopener">携程DynamicAPK</a></li>
<li><a href="https://github.com/iReaderAndroid/ZeusPlugin" target="_blank" rel="noopener">掌阅-最简单易懂的Android插件补丁框架</a></li>
<li><a href="https://github.com/bunnyblue/ACDD" target="_blank" rel="noopener">OpenAtlas，已改名为ACDD，可以在手机淘宝中见到踪影</a></li>
<li><a href="https://github.com/singwhatiwanna/dynamic-load-apk" target="_blank" rel="noopener">dynamic-load-apk</a></li>
<li><a href="http://tech.meituan.com/mt-android-auto-split-dex.html" target="_blank" rel="noopener">美团分包</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzAwNDY1ODY2OQ==&mid=207151651&idx=1&sn=9eab282711f4eb2b4daf2fbae5a5ca9a&3rd=MzA3MDU4NTYzMw==&scene=6#rd" target="_blank" rel="noopener">微信/手Q加载方案</a></li>
<li><a href="http://www.androidblog.cn/index.php/Index/detail/id/16" target="_blank" rel="noopener">Android博客周刊专题之《插件化开发》</a></li>
<li><a href="https://github.com/asLody/TurboDex" target="_blank" rel="noopener">Fast load dex in memory</a></li>
<li><a href="https://github.com/limpoxe/Android-Plugin-Framework" target="_blank" rel="noopener">Android Plugin Framework 插件开发框架及示例程序，原理介绍等</a></li>
<li><a href="https://github.com/lizhangqu/MainDex" target="_blank" rel="noopener">获取主dex</a></li>
<li><a href="https://github.com/asLody/VirtualApp" target="_blank" rel="noopener">应用双开VirtualApp</a></li>
<li><a href="http://yydcdut.com/2016/03/20/split-dex/" target="_blank" rel="noopener">Android Dex分包之旅</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/20515113" target="_blank" rel="noopener">ANROID动态加载技术 系列索引</a></li>
</ul>
<h3 id="Android-热更新"><a href="#Android-热更新" class="headerlink" title="Android 热更新"></a>Android 热更新</h3><ul>
<li><a href="https://github.com/alibaba/dexposed" target="_blank" rel="noopener">dexposed</a></li>
<li><a href="https://github.com/alibaba/AndFix" target="_blank" rel="noopener">AndFix</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzI1MTA1MzM2Nw==&mid=400118620&idx=1&sn=b4fdd5055731290eef12ad0d17f39d4a&scene=0#wechat_redirect" target="_blank" rel="noopener">QQ空间热修复</a></li>
<li><a href="https://github.com/dodola/HotFix" target="_blank" rel="noopener">QQ空间热修复实现方案</a></li>
<li><a href="https://github.com/jasonross/Nuwa" target="_blank" rel="noopener">Nuwa 女娲</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIzMDEyNzM4NQ==&mid=2650956297&idx=1&sn=f4bfdd7b16f95b6d34c6f34d8ce392e0&scene=0&uin=MTY4NDEwODc2Mg%3D%3D&key=cf237d7ae24775e8a8b56c7ea2bb2868382d9036f67165867c202e363b23bb4e596335de9da22825b530281867b47449&devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.11.6+build(15G31)&version=12000006&lang=zh_CN&nettype=WIFI&fontScale=100&pass_ticket=95LpBT0hMvr3CsOzDCiFvaRxltvzQUdRKYWgyVX2qwUNRC1PW%2Bmf8ebbmyh6bwrH" target="_blank" rel="noopener">Android HotPatch从入门到“放弃”</a></li>
<li><a href="http://wereadteam.github.io/2016/07/26/AndroidPatch/?from=timeline&isappinstalled=0" target="_blank" rel="noopener">Android Patch 方案与持续交付</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAwNDY1ODY2OQ==&mid=2649286341&idx=1&sn=054d595af6e824cbe4edd79427fc2706&scene=2&srcid=0804Rg6BqGmPSPyeUOOLXds3&from=timeline&isappinstalled=0&uin=MTY4NDEwODc2Mg%3D%3D&key=cf237d7ae24775e86d7c5f57902ee2b81f05b64d1b6baf39ba9ad8115ea453e72d5d9f36a58c506d01f2a84e9b6c2eca&devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.11.6+build(15G31)&version=12000006&lang=zh_CN&nettype=WIFI&fontScale=100&pass_ticket=95LpBT0hMvr3CsOzDCiFvaRxltvzQUdRKYWgyVX2qwUNRC1PW%2Bmf8ebbmyh6bwrH" target="_blank" rel="noopener">Android N混合编译与对热补丁影响解析</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAwNDY1ODY2OQ==&mid=2649286306&idx=1&sn=d6b2865e033a99de60b2d4314c6e0a25&scene=0&uin=MTY4NDEwODc2Mg%3D%3D&key=cf237d7ae24775e8857eb5c8144bf27076228deefafb6a0afd4416d54ed479daa6a67f0363c96df893d5cf4e4d3db423&devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.11.6+build(15G31)&version=12000006&lang=zh_CN&nettype=WIFI&fontScale=100&pass_ticket=95LpBT0hMvr3CsOzDCiFvaRxltvzQUdRKYWgyVX2qwUNRC1PW%2Bmf8ebbmyh6bwrH" target="_blank" rel="noopener">微信Android热补丁实践演进之路</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/51475499" target="_blank" rel="noopener">Android热更新之so库的热更新</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/51405207" target="_blank" rel="noopener">Android aapt实现资源分区（补充携程aapt源码）</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/50839263" target="_blank" rel="noopener">Android 热修复使用Gradle Plugin1.5改造Nuwa插件</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/50812674" target="_blank" rel="noopener">Android 热修复Nuwa的原理及Gradle插件源码解析</a></li>
<li><a href="https://github.com/zzz40500/Tinker_imitator" target="_blank" rel="noopener">Tinker_imitator</a></li>
<li><a href="https://github.com/iReaderAndroid/PatchPluginForZeus" target="_blank" rel="noopener">ZeusPlugin插件框架热修复gradle插件源码</a></li>
<li><a href="https://github.com/dodola/RocooFix" target="_blank" rel="noopener">RocooFix</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/51760578" target="_blank" rel="noopener"> Android Classloader热修复技术之百家齐放</a></li>
<li><a href="http://zjutkz.net/2016/05/10/%E4%BB%8EInstant-Run%E5%87%BA%E5%8F%91%EF%BC%8C%E8%B0%88%E8%B0%88Android%E4%B8%8A%E7%9A%84%E7%83%AD%E4%BF%AE%E5%A4%8D/" target="_blank" rel="noopener">从Instant-Run出发，谈谈Android上的热修复</a></li>
<li><a href="https://github.com/byteam/delta" target="_blank" rel="noopener">Android热修复与增量升级，基于微信Tinker原理</a></li>
<li><a href="http://tech.meituan.com/android_robust.html" target="_blank" rel="noopener">美团Android热更新方案Robust</a></li>
<li><a href="https://github.com/Tencent/tinker" target="_blank" rel="noopener">腾讯Tinker</a></li>
<li><a href="https://github.com/Meituan-Dianping/Robust" target="_blank" rel="noopener">美团Robust</a></li>
</ul>
<h3 id="Android-加固与反编译"><a href="#Android-加固与反编译" class="headerlink" title="Android 加固与反编译"></a>Android 加固与反编译</h3><ul>
<li><a href="https://github.com/Juude/droidReverse" target="_blank" rel="noopener">android反编译工具的合集</a></li>
<li><a href="http://ibotpeaches.github.io/Apktool/" target="_blank" rel="noopener">Apktool</a></li>
<li><a href="http://sourceforge.net/projects/dex2jar/" target="_blank" rel="noopener">dex2jar</a></li>
<li><a href="https://github.com/MasonLiuChn/DecompileApk" target="_blank" rel="noopener">DecompileApk</a></li>
<li><a href="http://www.jianshu.com/p/856bf5b437aa" target="_blank" rel="noopener">Android APK加固技术方案调研</a></li>
<li><a href="https://github.com/joker535/Baffle" target="_blank" rel="noopener">Android apk包res 资源混淆工具</a></li>
<li><a href="https://github.com/shwenzhang/AndResGuard" target="_blank" rel="noopener">微信资源混淆</a></li>
<li><a href="http://tech.meituan.com/mt-android-resource-obfuscation.html" target="_blank" rel="noopener">美团Android资源混淆保护实践</a></li>
<li><a href="https://github.com/JohnnyYin/ResProguard" target="_blank" rel="noopener">美团Android资源混淆实现方案</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIzNDA3MDgwNA==&mid=2649229991&idx=1&sn=0fc62c65609143936d10849de6eb8069&scene=2&srcid=0629LJbsgjl7ctiSLYjRYXf5&from=timeline&isappinstalled=0&uin=MTY4NDEwODc2Mg%3D%3D&key=cf237d7ae24775e8a22350257773584f0e2dc2ae515c3e0b8779155f7a039c04e16a736510fe4d44b761a3f2b651a43b&devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.11.6+build(15G31)&version=12000006&lang=zh_CN&nettype=WIFI&fontScale=100&pass_ticket=95LpBT0hMvr3CsOzDCiFvaRxltvzQUdRKYWgyVX2qwUNRC1PW%2Bmf8ebbmyh6bwrH" target="_blank" rel="noopener">Apk脱壳圣战之—如何脱掉“360加固”的壳</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIzNDA3MDgwNA==&mid=2649229983&idx=1&sn=de2bd1a408d74e102ecd13a05512d1fa&scene=21#wechat_redirect" target="_blank" rel="noopener">Android脱壳圣战之—如何脱掉”爱加密”家的保护壳</a></li>
<li><a href="https://github.com/zhonghanwen/AndroidProguardPlugin" target="_blank" rel="noopener">一键生成项目混淆代码插件</a></li>
<li><a href="http://blog.csdn.net/jiangwei0910410003/article/details/49336613" target="_blank" rel="noopener">Android逆向之旅—SO(ELF)文件格式详解</a></li>
<li><a href="http://blog.csdn.net/jiangwei0910410003/article/details/50568487" target="_blank" rel="noopener">Android逆向之旅—解析编译之后的AndroidManifest文件格式</a></li>
<li><a href="http://blog.csdn.net/jiangwei0910410003/article/details/50628894" target="_blank" rel="noopener">Android逆向之旅—解析编译之后的Resource.arsc文件格式</a></li>
<li><a href="http://blog.csdn.net/jiangwei0910410003/article/details/50668549" target="_blank" rel="noopener">Android逆向之旅—解析编译之后的Dex文件格式</a></li>
</ul>
<h3 id="Android-Studio专题"><a href="#Android-Studio专题" class="headerlink" title="Android Studio专题"></a>Android Studio专题</h3><ul>
<li><a href="https://github.com/rholder/gradle-view" target="_blank" rel="noopener">查看依赖关系的插件</a></li>
<li><a href="https://github.com/judasn/IntelliJ-IDEA-Tutorial" target="_blank" rel="noopener">IntelliJ IDEA 简体中文专题教程</a></li>
<li><a href="http://tianweishu.com/2015/12/21/android-studio-debug-tips-you-may-not-know/" target="_blank" rel="noopener">Android Studio 你不知道的调试技巧</a></li>
<li><a href="http://www.jayfeng.com/2015/11/07/Android%E6%89%93%E5%8C%85%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/" target="_blank" rel="noopener">Android打包的那些事</a></li>
<li><a href="https://github.com/keyboardsurfer/idea-live-templates" target="_blank" rel="noopener">idea-live-templates 模板</a></li>
<li><a href="https://github.com/KeepSafe/dexcount-gradle-plugin" target="_blank" rel="noopener">方法数统计插件，可用于统计是否达到65536个方法</a></li>
<li><a href="https://github.com/winterDroid/android-drawable-importer-intellij-plugin" target="_blank" rel="noopener">Android-Drawable-Importer插件</a></li>
<li><a href="https://github.com/zzz40500/GsonFormat" target="_blank" rel="noopener">GsonFormat Json对应的Bean快速生成插件</a></li>
<li><a href="https://github.com/inmite/android-selector-chapek" target="_blank" rel="noopener">android-selector-chapek Selector生成插件</a></li>
<li><a href="https://github.com/avast/android-butterknife-zelezny" target="_blank" rel="noopener">快速生成butterknife注解插件</a></li>
<li><a href="https://github.com/konifar/android-material-design-icon-generator-plugin" target="_blank" rel="noopener">android-material-design-icon-generator图标插件</a></li>
<li><a href="https://github.com/evant/gradle-retrolambda" target="_blank" rel="noopener">Retrolambda 在java 6 7中使用 lambda表达式插件</a></li>
<li><a href="https://github.com/ligi/GradleDependenciesHelperPlugin" target="_blank" rel="noopener">Gradle依赖自动补齐插件</a></li>
<li><a href="https://github.com/nicoulaj/idea-markdown" target="_blank" rel="noopener">idea-markdown编辑器插件</a></li>
<li><a href="https://github.com/Haehnchen/idea-android-studio-plugin" target="_blank" rel="noopener">从布局中生成View的声明插件</a></li>
<li><a href="https://www.codota.com/" target="_blank" rel="noopener">codota代码片段搜索，支持Chrome和Android Studio</a></li>
<li><a href="https://github.com/dmytrodanylyk/folding-plugin" target="_blank" rel="noopener">布局文件分组插件</a></li>
<li><a href="https://github.com/JerzyPuchalski/Android-DPI-Calculator" target="_blank" rel="noopener">DPI计算插件</a></li>
<li><a href="https://github.com/msdx/gradle-publish" target="_blank" rel="noopener">gradle-publish 发布库插件</a></li>
<li><a href="https://github.com/andforce/release-android-lib-to-jcenter" target="_blank" rel="noopener">发布lib到jcenter</a></li>
<li><a href="https://chrome.google.com/webstore/detail/vysor-beta/gidgenkbbabolejbgbpnhbimgjbffefm" target="_blank" rel="noopener">vysor 这个是Chrome的插件，电脑操作手机</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-tricks-moving-around/" target="_blank" rel="noopener">android-studio-tips-tricks-moving-around/</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-of-the-day-roundup-1/" target="_blank" rel="noopener">http://www.developerphil.com/android-studio-tips-of-the-day-roundup-1/</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-of-the-day-roundup-2/" target="_blank" rel="noopener">http://www.developerphil.com/android-studio-tips-of-the-day-roundup-2/</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-of-the-day-roundup-3/" target="_blank" rel="noopener">http://www.developerphil.com/android-studio-tips-of-the-day-roundup-3/</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-of-the-day-roundup-4/" target="_blank" rel="noopener">http://www.developerphil.com/android-studio-tips-of-the-day-roundup-4/</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-of-the-day-roundup-5/" target="_blank" rel="noopener">http://www.developerphil.com/android-studio-tips-of-the-day-roundup-5/</a></li>
<li><a href="http://www.developerphil.com/android-studio-tips-of-the-day-roundup-6/" target="_blank" rel="noopener">http://www.developerphil.com/android-studio-tips-of-the-day-roundup-6/</a></li>
<li><a href="http://jiajixin.cn/2015/10/11/android-studio-plugin-dev/" target="_blank" rel="noopener">Android Studio插件开发</a></li>
<li><a href="http://jiajixin.cn/2015/10/11/android-sdk-mirror/" target="_blank" rel="noopener">Android SDK镜像服务器搭建</a></li>
<li><a href="https://ydmmocoo.github.io/2016/06/28/Android-Studio%E6%8F%92%E4%BB%B6%E6%95%B4%E7%90%86/" target="_blank" rel="noopener">Android Studio 插件整理 48 个</a></li>
</ul>
<h3 id="RxJava-amp-amp-RxAndroid-amp-amp-agera学习资源"><a href="#RxJava-amp-amp-RxAndroid-amp-amp-agera学习资源" class="headerlink" title="RxJava&amp;&amp;RxAndroid&amp;&amp;agera学习资源"></a>RxJava&amp;&amp;RxAndroid&amp;&amp;agera学习资源</h3><ul>
<li><a href="https://github.com/ReactiveX/RxJava/" target="_blank" rel="noopener">RxJava Github地址</a></li>
<li><a href="https://github.com/ReactiveX/RxAndroid" target="_blank" rel="noopener">RxAndroid Github地址</a></li>
<li><a href="https://github.com/mcxiaoke/RxDocs" target="_blank" rel="noopener">RxJava中文文档翻译</a></li>
<li><a href="https://github.com/lzyzsd/Awesome-RxJava" target="_blank" rel="noopener">Awesome-RxJava</a></li>
<li><a href="http://www.jianshu.com/p/72911b9ba2d7" target="_blank" rel="noopener">在正确的线程上观察</a></li>
<li><a href="http://gank.io/post/560e15be2dca930e00da1083" target="_blank" rel="noopener">给 Android 开发者的 RxJava 详解</a></li>
<li><a href="https://segmentfault.com/a/1190000004049490" target="_blank" rel="noopener">谜之RxJava （一） —— 最基本的观察者模式</a></li>
<li><a href="https://segmentfault.com/a/1190000004049841" target="_blank" rel="noopener">谜之RxJava （二） —— Magic Lift</a></li>
<li><a href="https://segmentfault.com/a/1190000004051191" target="_blank" rel="noopener">迷之RxJava （三）—— 线程切换</a></li>
<li><a href="https://segmentfault.com/a/1190000004855661" target="_blank" rel="noopener">迷之RxJava （三）update —— 线程切换（二）</a></li>
<li><a href="https://segmentfault.com/a/1190000004856071" target="_blank" rel="noopener">迷之RxJava （三）update 2 —— subscribeOn 和 observeOn 的区别</a></li>
<li><a href="https://segmentfault.com/a/1190000004077117" target="_blank" rel="noopener">迷之RxJava（四）—— Retrofit和RxJava的基情</a></li>
<li><a href="https://code-labs.cn/codelabs/android-agera/#0" target="_blank" rel="noopener">android-agera</a></li>
<li><a href="https://github.com/google/agera/wiki" target="_blank" rel="noopener">agera</a></li>
<li><a href="http://gank.io/post/56e80c2c677659311bed9841" target="_blank" rel="noopener">RxJava 与 Retrofit 结合的最佳实践</a></li>
</ul>
<h3 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h3><ul>
<li><a href="http://fucknmb.com/2017/07/05/%E5%8F%88%E6%8E%8C%E6%8F%A1%E4%BA%86%E4%B8%80%E9%A1%B9%E6%96%B0%E6%8A%80%E8%83%BD-%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95Gradle%E6%8F%92%E4%BB%B6/" target="_blank" rel="noopener">又掌握了一项新技能 - 断点调试 Gradle 插件</a></li>
<li><a href="http://fucknmb.com/2017/06/24/Android-Gradle-Plugin%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E4%B9%8BexternalNativeBuild/" target="_blank" rel="noopener">Android Gradle Plugin 源码解析之 externalNativeBuild</a></li>
<li><a href="http://fucknmb.com/2017/06/01/Android-Gradle-Plugin%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B8%8E%E7%BC%96%E8%AF%91/" target="_blank" rel="noopener">Android Gradle Plugin 源码阅读与编译</a></li>
<li><a href="http://fucknmb.com/2017/01/12/Gradle%E5%87%BD%E6%95%B0%E5%A4%8D%E7%94%A8%E7%9A%84%E4%B8%80%E7%82%B9%E5%AE%9E%E8%B7%B5/" target="_blank" rel="noopener">Gradle 函数复用的一点实践</a></li>
<li><a href="https://segmentfault.com/a/1190000004229002" target="_blank" rel="noopener">Gradle for Android</a></li>
<li><a href="http://google.github.io/android-gradle-dsl/current/" target="_blank" rel="noopener">谷歌Gradle官方文档</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIzNTA3MjQwNw==&mid=2650672318&idx=1&sn=74fb2afc4e409be3014ea83aa623a792&scene=2&srcid=0814iBs3jyLcRldTGb3oqFIT&from=timeline&isappinstalled=0&uin=MTY4NDEwODc2Mg%3D%3D&key=cf237d7ae24775e8ab813a673c218977220f758d689261e1700639f2be2698a142186e9c68a3727f6e55683cee9ee94e&devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.11.6+build(15G31)&version=12000006&lang=zh_CN&nettype=WIFI&fontScale=100&pass_ticket=95LpBT0hMvr3CsOzDCiFvaRxltvzQUdRKYWgyVX2qwUNRC1PW%2Bmf8ebbmyh6bwrH" target="_blank" rel="noopener">Android Gradle 构建系统·初探</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/52079413" target="_blank" rel="noopener">Gradle系列之从init.gradle说起</a></li>
<li><a href="http://blog.csdn.net/innost/article/details/48228651" target="_blank" rel="noopener">深入理解Android之Gradle</a></li>
</ul>
<h3 id="Android-开发中值得看的优秀内容和工具"><a href="#Android-开发中值得看的优秀内容和工具" class="headerlink" title="Android 开发中值得看的优秀内容和工具"></a>Android 开发中值得看的优秀内容和工具</h3><ul>
<li><a href="https://github.com/Meituan-Dianping/walle" target="_blank" rel="noopener">多渠道 v2签名 walle</a></li>
<li><a href="http://androidcat.com/?step=1&view=CatFragment" target="_blank" rel="noopener">androidcat</a></li>
<li><a href="https://github.com/mzlogin/awesome-adb" target="_blank" rel="noopener">ADB 用法大全</a></li>
<li><a href="http://gudong.name/2016/04/07/checkstyle.html" target="_blank" rel="noopener">使用 CheckStyle 检查代码</a></li>
<li><a href="http://www.jianshu.com/p/3518cf8c6e4c" target="_blank" rel="noopener">图解 Retrofit - ServiceMethod</a></li>
<li><a href="http://www.jianshu.com/p/aad5aacd79bf" target="_blank" rel="noopener">OkHttp3源码分析-综述</a></li>
<li><a href="http://dev.qq.com/topic/57ac4a0ea374c75371c08ce8" target="_blank" rel="noopener">Android进程保活招式大全</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA5MDg3MjczMg==&mid=2652003543&idx=1&sn=849c06ac198cbfe9cdcfae90b2a17021&scene=1&srcid=0815jxyNu3OlM7PEE8PGhNYa&key=305bc10ec50ec19b21a47f33276f15cf9aee4503429d7392ce9c57f25fe26abae9fb7cffaa188ed67fd7057f3bbdd764&ascene=0&uin=MTM5ODYyMTY4Mg%3D%3D" target="_blank" rel="noopener">08/07 北京 GDG Android Meetup 活动回顾，讲义，照片</a></li>
<li><a href="https://github.com/square/javapoet" target="_blank" rel="noopener">Java源码生成（Square JavaWriter）</a></li>
<li><a href="https://github.com/CameloeAnthony/AndroidArchitectureCollection/blob/master/README.md" target="_blank" rel="noopener">安卓架构文章合集（a collection of android Architecture）</a></li>
<li><a href="http://www.eyrefree.org/2016/03/23/2016-03-23-Hexo-Coding-Pages/" target="_blank" rel="noopener">OS X 下使用 Hexo 和 Coding Pages 搭建静态博客</a></li>
<li><a href="http://androidxref.com" target="_blank" rel="noopener">Android系统源码查看，支持在线跟踪引用</a></li>
<li><a href="http://jiajixin.cn" target="_blank" rel="noopener">贾吉鑫</a></li>
<li><a href="http://wangxinghe.me/blog/2016-02-25/android-tools-traceview/" target="_blank" rel="noopener">TraceView性能优化工具使用</a></li>
<li><a href="https://github.com/facebook/network-connection-class" target="_blank" rel="noopener">network-connection-class</a></li>
<li><a href="https://github.com/amfe/article" target="_blank" rel="noopener">阿里巴巴技术文章</a></li>
<li><a href="http://www.jayfeng.com/2015/11/07/Android%E6%89%93%E5%8C%85%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/" target="_blank" rel="noopener">Android打包的那些事</a></li>
<li><a href="http://www.infoq.com/cn/android-weekly/" target="_blank" rel="noopener">InfoQAndroid周报</a></li>
<li><a href="http://www.devtf.cn/" target="_blank" rel="noopener">开发技术前线</a></li>
<li><a href="http://tech.meituan.com/mt-android-auto-split-dex.html" target="_blank" rel="noopener">美团Android DEX自动拆包及动态加载简介</a></li>
<li><a href="https://github.com/kesenhoo/android-training-course-in-chinese" target="_blank" rel="noopener">Android官方培训课程中文版</a></li>
<li><a href="https://github.com/bboyfeiyu/android-tech-frontier" target="_blank" rel="noopener">一个定期翻译国外Android优质的技术、开源库、软件架构设计、测试等文章的开源项目</a></li>
<li><a href="https://github.com/codepath/android_guides" target="_blank" rel="noopener">Android Guides</a></li>
<li><a href="https://github.com/android-cn/android-open-project-analysis" target="_blank" rel="noopener">Android 开源项目源码解析</a></li>
<li><a href="http://chiuki.github.io/android-shaders-filters" target="_blank" rel="noopener">Android 图像处理教学</a></li>
<li><a href="https://github.com/Trinea/android-open-project" target="_blank" rel="noopener">Android 开源项目分类汇总</a> </li>
<li><a href="https://github.com/simple-android-framework-exchange/the-fucking-traps-in-android-dev" target="_blank" rel="noopener">开发过程中遇到的坑</a></li>
<li><a href="https://github.com/aosp-exchange-group/share" target="_blank" rel="noopener">Android 开源交流</a></li>
<li><a href="https://github.com/simple-android-framework-exchange/simple-android-opensource-framework" target="_blank" rel="noopener">Android 著名开源库的简版实现</a></li>
<li><a href="https://github.com/android-cn/android-discuss" target="_blank" rel="noopener">Android 问题交流讨论，大部分是面试题</a> </li>
<li><a href="https://github.com/simple-android-framework-exchange/android_design_patterns_analysis" target="_blank" rel="noopener">android 设计模式</a></li>
<li><a href="https://github.com/android-cn/android-jobs" target="_blank" rel="noopener">Android 全国职位列表</a></li>
<li><a href="https://github.com/aosp-exchange-group/fuck-2014-flirt-2015" target="_blank" rel="noopener">fuck-2014-flirt-2015</a></li>
<li><a href="http://www.androiddevtools.cn/" target="_blank" rel="noopener">AndroidDevTools开发相关资料下载</a></li>
<li><a href="https://github.com/futurice/android-best-practices" target="_blank" rel="noopener">android-best-practices最佳实践</a></li>
<li><a href="https://github.com/iluwatar/java-design-patterns" target="_blank" rel="noopener">java设计模式</a></li>
<li><a href="https://github.com/tianzhijiexian/Android-Best-Practices" target="_blank" rel="noopener">Android最佳实践示例</a></li>
<li><a href="http://droidyue.com/blog/2014/09/20/interaction-between-java-and-javascript-in-android/?comefrom=http://blogread.cn/news/" target="_blank" rel="noopener">Android 中 Java 与JavaScript 交互最详尽的总结</a></li>
<li><a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2015/0824/3356.html" target="_blank" rel="noopener">如何为drawable着色</a></li>
<li><a href="http://www.race604.com/tint-drawable/" target="_blank" rel="noopener">Drawable 着色的后向兼容方案</a></li>
<li><a href="https://github.com/lightSky/Awesome-MaterialDesign" target="_blank" rel="noopener">Awesome-MaterialDesign</a></li>
<li><a href="https://github.com/lizhangqu/InterviewQuestion" target="_blank" rel="noopener">Android 面试题InterviewQuestion</a></li>
<li><a href="https://github.com/JStumpp/awesome-android" target="_blank" rel="noopener">awesome-android</a></li>
<li><a href="https://futurestud.io/blog/retrofit-getting-started-and-android-client/" target="_blank" rel="noopener">Retrofit相关文章</a></li>
<li><a href="http://litesuits.com/" target="_blank" rel="noopener">Lite Android</a></li>
<li><a href="http://bugly.qq.com/blog/" target="_blank" rel="noopener">Bugly Blog</a></li>
<li><a href="http://gold.xitu.io/#/tag/Android" target="_blank" rel="noopener">掘金</a></li>
</ul>
<h3 id="安卓网络层-包含图片"><a href="#安卓网络层-包含图片" class="headerlink" title="安卓网络层(包含图片)"></a>安卓网络层(包含图片)</h3><ul>
<li><a href="https://github.com/square/okhttp" target="_blank" rel="noopener">okhttp</a></li>
<li><a href="https://github.com/square/retrofit" target="_blank" rel="noopener">retrofit</a></li>
<li><a href="http://square.github.io/picasso/" target="_blank" rel="noopener">picasso</a></li>
<li><a href="https://android.googlesource.com/platform/frameworks/volley" target="_blank" rel="noopener">Volley</a></li>
<li><a href="https://github.com/facebook/fresco" target="_blank" rel="noopener">fresco</a></li>
<li><a href="https://github.com/nostra13/Android-Universal-Image-Loader" target="_blank" rel="noopener">Android-Universal-Image-Loader</a></li>
<li><a href="https://github.com/stephanenicolas/robospice" target="_blank" rel="noopener">robospice</a></li>
<li><a href="http://loopj.com/android-async-http/" target="_blank" rel="noopener">android-async-http</a></li>
<li><a href="https://github.com/amitshekhariitbhu/Fast-Android-Networking" target="_blank" rel="noopener">Fast-Android-Networking</a></li>
</ul>
<h3 id="安卓orm框架，用得比较多的就GreenDao，Ormlite"><a href="#安卓orm框架，用得比较多的就GreenDao，Ormlite" class="headerlink" title="安卓orm框架，用得比较多的就GreenDao，Ormlite"></a>安卓orm框架，用得比较多的就GreenDao，Ormlite</h3><ul>
<li><a href="http://greendao-orm.com/" target="_blank" rel="noopener">greenDAO</a></li>
<li><a href="http://ormlite.com/sqlite_java_android_orm.shtml" target="_blank" rel="noopener">ORMLite</a></li>
<li><a href="https://github.com/pardom/ActiveAndroid/wiki/Getting-started" target="_blank" rel="noopener">ActiveAndroid</a></li>
<li><a href="http://satyan.github.io/sugar/index.html" target="_blank" rel="noopener">SugarORM</a></li>
<li><a href="http://siminov.github.io/android-orm/" target="_blank" rel="noopener">Siminov</a></li>
<li><a href="http://www.androrm.net/" target="_blank" rel="noopener">androrm</a></li>
<li><a href="https://bitbucket.org/qbusict/cupboard/wiki/GettingStarted" target="_blank" rel="noopener">cupboard</a></li>
<li><a href="https://github.com/racket/realm" target="_blank" rel="noopener">realm</a></li>
</ul>
<h3 id="安卓Json解析"><a href="#安卓Json解析" class="headerlink" title="安卓Json解析"></a>安卓Json解析</h3><ul>
<li><a href="https://github.com/google/gson" target="_blank" rel="noopener">Gson,用法简单，速度慢</a></li>
<li><a href="https://github.com/alibaba/fastjson" target="_blank" rel="noopener">fastjson，号称最快</a></li>
<li><a href="https://github.com/FasterXML/jackson" target="_blank" rel="noopener">jackson</a></li>
</ul>
<h3 id="Android-单元测试"><a href="#Android-单元测试" class="headerlink" title="Android 单元测试"></a>Android 单元测试</h3><ul>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwOTQ1MjAwMg==&mid=2247483744&idx=1&sn=e322c5dc19952c563e00a24815399300&scene=0#wechat_redirect" target="_blank" rel="noopener">使用Mockito和Roboletric进行Android单元测试</a></li>
<li><a href="http://robolectric.org/" target="_blank" rel="noopener">Robolectric</a></li>
</ul>
<h3 id="Android-开源软件"><a href="#Android-开源软件" class="headerlink" title="Android 开源软件"></a>Android 开源软件</h3><ul>
<li><a href="https://github.com/wangdan/AisenWeiBo" target="_blank" rel="noopener">一个第三方开源微博</a></li>
<li><a href="https://github.com/openproject/AndroidDigest" target="_blank" rel="noopener">android相关的干货(文摘，名博，github等等)</a></li>
<li><a href="https://github.com/Leaking/WeGit" target="_blank" rel="noopener">第三方github客户端</a></li>
<li><a href="http://git.oschina.net/oschina/" target="_blank" rel="noopener">开源中国的系列软件</a></li>
<li><a href="https://github.com/Jhuster/EWeightScale" target="_blank" rel="noopener">体重档案</a></li>
<li><a href="http://skillcollege.github.io/SimplifyReader/" target="_blank" rel="noopener">Simplifyreader</a></li>
<li><a href="https://github.com/lzjun567/XiYuanFangApp" target="_blank" rel="noopener">西源坊</a></li>
</ul>
<h3 id="Android-开发辅助工具"><a href="#Android-开发辅助工具" class="headerlink" title="Android 开发辅助工具"></a>Android 开发辅助工具</h3><ul>
<li><a href="http://gold.xitu.io/entry/56488b7660b20fc9b9c2f0be" target="_blank" rel="noopener">Charles 从入门到精通</a></li>
<li><a href="http://apps.evozi.com/apk-downloader/" target="_blank" rel="noopener">Google Play APK下载器</a></li>
<li><a href="http://www.slideshare.net/" target="_blank" rel="noopener">slideshare</a></li>
<li><a href="https://www.codota.com/" target="_blank" rel="noopener">codota代码片段搜索，支持Chrome和Android Studio</a></li>
<li><a href="https://chrome.google.com/webstore/detail/vysor-beta/gidgenkbbabolejbgbpnhbimgjbffefm" target="_blank" rel="noopener">vysor 这个是Chrome的插件，电脑操作手机</a></li>
<li><a href="https://github.com/buunguyen/octotree" target="_blank" rel="noopener">Browser extension to display GitHub code in tree format</a></li>
<li><a href="http://laod.cn/hosts/2015-google-hosts.html" target="_blank" rel="noopener">google hosts翻墙，有vpn的忽略</a></li>
<li><a href="http://tool.oschina.net/" target="_blank" rel="noopener">开源中国在线工具</a></li>
<li><a href="http://apistore.baidu.com/" target="_blank" rel="noopener">百度ApiStore</a></li>
<li><a href="https://github.com/vim-scripts/Auto-Pairs" target="_blank" rel="noopener">Vim插件</a></li>
<li><a href="https://github.com/macdao/ocds-guide-to-setting-up-mac" target="_blank" rel="noopener">强迫症的 Mac 设置指南</a></li>
<li><a href="https://github.com/judasn/Linux-Tutorial" target="_blank" rel="noopener">Linux-Tutorial</a></li>
<li><a href="https://github.com/judasn/Markdown-Syntax-CN" target="_blank" rel="noopener">Markdown-Syntax-CN</a></li>
<li><a href="https://insight.io/" target="_blank" rel="noopener">insight chrome 代码查看插件</a></li>
</ul>
<h3 id="Android-推送（含IM）"><a href="#Android-推送（含IM）" class="headerlink" title="Android 推送（含IM）"></a>Android 推送（含IM）</h3><ul>
<li><a href="http://www.easemob.com/" target="_blank" rel="noopener">环信，支持即时音视频</a></li>
<li><a href="http://www.qcloud.com/product/avc.html" target="_blank" rel="noopener">腾讯云通讯，支持即时音视频</a></li>
<li><a href="https://www.jpush.cn/" target="_blank" rel="noopener">极光推送和IM</a></li>
<li><a href="http://www.getui.com/" target="_blank" rel="noopener">个推</a></li>
<li><a href="http://dev.xiaomi.com/doc/?page_id=1670" target="_blank" rel="noopener">小米推送，在MIUI上属于系统服务框架，共享系统级长连接</a></li>
<li><a href="http://push.baidu.com/" target="_blank" rel="noopener">百度云推送,部分机型收不到推送，如小米，Bug是否修复未知</a></li>
<li><a href="http://xg.qq.com/xg/" target="_blank" rel="noopener">腾讯信鸽推送</a></li>
<li><a href="https://www.umeng.com/push" target="_blank" rel="noopener">友盟推送</a></li>
<li><a href="https://leancloud.cn/" target="_blank" rel="noopener">leancloud</a></li>
<li><a href="http://www.bmob.cn/products" target="_blank" rel="noopener">bmob云推送，含IM</a></li>
<li><a href="https://github.com/mogujie/TeamTalk" target="_blank" rel="noopener">蘑菇街TeamTalk</a></li>
<li><a href="http://www.igniterealtime.org/downloads/index.jsp" target="_blank" rel="noopener">Openfire+Smack开源Xmpp解决方案</a></li>
</ul>
<h3 id="Android后端等服务"><a href="#Android后端等服务" class="headerlink" title="Android后端等服务"></a>Android后端等服务</h3><ul>
<li><a href="https://parse.com/" target="_blank" rel="noopener">parse，缺点是服务器在国外，速度慢</a></li>
<li><a href="https://leancloud.cn/" target="_blank" rel="noopener">leancloud，国内的，仿parse</a></li>
<li><a href="http://www.bmob.cn/" target="_blank" rel="noopener">Bmob后端云</a></li>
<li><a href="http://www.qiniu.com/" target="_blank" rel="noopener">七牛云存储</a></li>
<li><a href="http://www.apicloud.com/" target="_blank" rel="noopener">apicloud</a></li>
</ul>
<h3 id="Android-应用内测平台"><a href="#Android-应用内测平台" class="headerlink" title="Android 应用内测平台"></a>Android 应用内测平台</h3><ul>
<li><a href="http://www.pgyer.com/" target="_blank" rel="noopener">蒲公英，内测应用</a></li>
<li><a href="http://fir.im/" target="_blank" rel="noopener">Fir.im，内测应用</a></li>
</ul>
<h3 id="Android社会化分享，短信验证，意见反馈，支付等相关"><a href="#Android社会化分享，短信验证，意见反馈，支付等相关" class="headerlink" title="Android社会化分享，短信验证，意见反馈，支付等相关"></a>Android社会化分享，短信验证，意见反馈，支付等相关</h3><ul>
<li><a href="http://www.umeng.com/" target="_blank" rel="noopener">友盟,社会化分析，意见反馈</a></li>
<li><a href="http://mob.com/" target="_blank" rel="noopener">Sharesdk，社会化分析</a></li>
<li><a href="https://pingxx.com" target="_blank" rel="noopener">Ping++，支付</a></li>
<li><a href="http://docs.bmob.cn/androidpay/index.html?menukey=fast_start&key=start_android_pay" target="_blank" rel="noopener">bmob支付，Bmob为广大开发人员提供的统一、正规的收费手段，让没有企业认证的个人开发者，也能通过支付宝和微信向用户收费</a></li>
<li><a href="http://www.yuntongxun.com/ability/toPriceTariff" target="_blank" rel="noopener">容联云通讯</a></li>
</ul>
<h3 id="安卓开发值得关注的库"><a href="#安卓开发值得关注的库" class="headerlink" title="安卓开发值得关注的库"></a>安卓开发值得关注的库</h3><ul>
<li><a href="https://github.com/evernote/android-job" target="_blank" rel="noopener">定时任务&amp;计划任务-印象笔记android-job</a></li>
<li><a href="https://github.com/JZ-Darkal/AndroidHttpCapture" target="_blank" rel="noopener">AndroidHttpCapture 手机上抓包</a></li>
<li><a href="https://projectlombok.org/" target="_blank" rel="noopener">方法自动生成</a></li>
<li><a href="https://github.com/xiaopansky/SpiderWebScoreView" target="_blank" rel="noopener">Android上的一个蛛网评分控件</a></li>
<li><a href="https://github.com/KeepSafe/ReLinker" target="_blank" rel="noopener">ReLinker 安全加载so库的方式</a></li>
<li><a href="https://github.com/mthli/SugarTask" target="_blank" rel="noopener">SugarTask</a></li>
<li><a href="https://github.com/taoliuh/v2ex" target="_blank" rel="noopener">sync adapter</a></li>
<li><a href="https://github.com/badoo/android-weak-handler" target="_blank" rel="noopener">Android Weak Handler防止内存泄露</a></li>
<li><a href="https://github.com/path/android-priority-jobqueue" target="_blank" rel="noopener">Android Priority Job Queue 异步任务调度</a></li>
<li><a href="https://github.com/yigit/android-priority-jobqueue" target="_blank" rel="noopener">android-priority-jobqueue</a></li>
<li><a href="https://github.com/H07000223/FlycoDialog_Master" target="_blank" rel="noopener">Android对话框</a></li>
<li><a href="https://github.com/tianzhijiexian/ExRecyclerView/" target="_blank" rel="noopener">扩展的RecyclerView，拥有添加头、底等多种操作</a></li>
<li><a href="https://github.com/lightSky/Awesome-MaterialDesign" target="_blank" rel="noopener">MaterialDesign相关库</a></li>
<li><a href="https://github.com/ikew0ng/SwipeBackLayout" target="_blank" rel="noopener">右滑返回SwipeBackLayout</a></li>
<li><a href="https://github.com/JulienGenoud/android-percent-support-lib-sample" target="_blank" rel="noopener">百分比布局</a></li>
<li><a href="https://github.com/greenrobot/EventBus" target="_blank" rel="noopener">EventBus</a></li>
<li><a href="https://github.com/ksoichiro/Android-ObservableScrollView/" target="_blank" rel="noopener">ObservableScrollView</a></li>
<li><a href="https://github.com/openproject/LessCode" target="_blank" rel="noopener">工具库less code, more efficient for android</a></li>
<li><a href="https://github.com/JoanZapata/base-adapter-helper" target="_blank" rel="noopener">通用适配器</a></li>
<li><a href="https://github.com/SnowdreamFramework/android-log" target="_blank" rel="noopener">android-log</a></li>
<li><a href="http://nineoldandroids.com/" target="_blank" rel="noopener">NineOldAndroids</a></li>
<li><a href="https://github.com/jgilfelt/android-viewbadger" target="_blank" rel="noopener">BadgeView </a></li>
<li><a href="https://github.com/hdodenhof/CircleImageView" target="_blank" rel="noopener">CircleImageView</a></li>
<li><a href="https://github.com/MostafaGazar/CustomShapeImageView" target="_blank" rel="noopener">CustomShapeImageView</a></li>
<li><a href="https://github.com/pedant/sweet-alert-dialog" target="_blank" rel="noopener">SweetAlert for Android, a beautiful and clever alert dialog</a></li>
<li><a href="https://github.com/johannilsson/android-pulltorefresh" target="_blank" rel="noopener">android-pulltorefresh</a></li>
<li><a href="https://github.com/jfeinstein10/SlidingMenu" target="_blank" rel="noopener">SlidingMenu</a></li>
<li><a href="https://github.com/JakeWharton/ViewPagerIndicator" target="_blank" rel="noopener">ViewPagerIndicator</a></li>
<li><a href="https://github.com/daimajia/AndroidViewAnimations" target="_blank" rel="noopener">一个动画集合库</a></li>
<li><a href="https://github.com/JoanZapata/android-iconify" target="_blank" rel="noopener">FontAwesome for Android</a></li>
<li><a href="https://github.com/lucasr/twoway-view" target="_blank" rel="noopener">RecyclerView made simple</a></li>
<li><a href="http://jsoup.org/" target="_blank" rel="noopener">jsoup库(java)</a></li>
<li><a href="https://github.com/maarek/android-wheel" target="_blank" rel="noopener">android-wheel</a></li>
<li><a href="https://github.com/wyouflf/xUtils" target="_blank" rel="noopener">xUtils</a></li>
<li><a href="https://github.com/Trinea/android-common" target="_blank" rel="noopener">android-common</a></li>
<li><a href="https://github.com/zxing/zxing" target="_blank" rel="noopener">zxing</a></li>
<li><a href="https://github.com/wangjiegulu/AndroidBucket" target="_blank" rel="noopener">Android开发常用整理</a></li>
<li><a href="https://github.com/ZhaoKaiQiang/ParticleLayout" target="_blank" rel="noopener">左滑粒子删除效果</a></li>
<li><a href="https://github.com/typicode/json-server" target="_blank" rel="noopener">JSON Server：零编码快速“伪造” REST API</a></li>
<li><a href="https://github.com/owncloud/" target="_blank" rel="noopener">owncloud</a></li>
<li><a href="https://github.com/Freelander/Android_Data" target="_blank" rel="noopener">Android_Data (Android 学习资料收集)</a></li>
</ul>
<h3 id="安卓资源相关"><a href="#安卓资源相关" class="headerlink" title="安卓资源相关"></a>安卓资源相关</h3><ul>
<li><a href="http://androiddrawables.com/" target="_blank" rel="noopener">安卓每个版本的Drawable图标</a></li>
<li><a href="https://github.com/liltof/font-awsome-for-android" target="_blank" rel="noopener">FontAwesome字体图标安卓字符串</a></li>
<li><a href="http://www.google.com/design/spec/style/color.html" target="_blank" rel="noopener">色系</a></li>
<li><a href="https://github.com/MatthewYork/Colours" target="_blank" rel="noopener">颜色库</a></li>
<li><a href="https://www.iconfinder.com/" target="_blank" rel="noopener">IconFinder图标资源</a></li>
<li><a href="http://www.iconfont.cn/" target="_blank" rel="noopener">阿里巴巴矢量图</a></li>
<li><a href="https://icomoon.io/app/#/select" target="_blank" rel="noopener">icomoon</a></li>
<li><a href="http://romannurik.github.io/AndroidAssetStudio/" target="_blank" rel="noopener">AndroidAssetStudio</a></li>
<li><a href="http://android-holo-colors.com/" target="_blank" rel="noopener">Android Holo颜色生成器</a></li>
<li><a href="http://jgilfelt.github.io/android-actionbarstylegenerator/" target="_blank" rel="noopener">Android Action Bar Style Generator</a></li>
<li><a href="http://romannurik.github.io/AndroidAssetStudio/nine-patches.html" target="_blank" rel="noopener">在线.9.png图片生成器</a></li>
<li><a href="http://angrytools.com/android/button/" target="_blank" rel="noopener">安卓button在线制作工具</a></li>
<li><a href="http://omapzoom.org/?p=platform/frameworks/base.git;a=blob;f=core/res/res/values/themes.xml;hb=master" target="_blank" rel="noopener">Theme.xml属性</a></li>
<li><a href="https://www.parse.com/" target="_blank" rel="noopener">移动APP云计算平台Parse</a></li>
</ul>
<h3 id="git"><a href="#git" class="headerlink" title="git"></a>git</h3><ul>
<li><a href="http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">Git教程</a></li>
<li><a href="http://segmentfault.com/a/1190000003836345?utm_source=Weibo&utm_medium=shareLink&utm_campaign=socialShare" target="_blank" rel="noopener">用 Git Hooks 进行自动部署</a></li>
<li><a href="http://blog.jobbole.com/76861/" target="_blank" rel="noopener">Git工作流指南：Forking工作流</a></li>
</ul>
<h3 id="Android-NoSql"><a href="#Android-NoSql" class="headerlink" title="Android NoSql"></a>Android NoSql</h3><ul>
<li><a href="https://github.com/realm/realm-java" target="_blank" rel="noopener">realm-java</a></li>
<li><a href="https://github.com/couchbase/couchbase-lite-android" target="_blank" rel="noopener">couchbase-lite-android</a></li>
<li><a href="https://github.com/Jearil/SimpleNoSQL" target="_blank" rel="noopener">SimpleNoSQL</a></li>
<li><a href="https://github.com/nhachicha/SnappyDB/" target="_blank" rel="noopener">SnappyDB</a></li>
</ul>
<h3 id="设计网站，可以寻找一些酷炫的设计稿"><a href="#设计网站，可以寻找一些酷炫的设计稿" class="headerlink" title="设计网站，可以寻找一些酷炫的设计稿"></a>设计网站，可以寻找一些酷炫的设计稿</h3><ul>
<li><a href="https://dribbble.com/" target="_blank" rel="noopener">https://dribbble.com/</a></li>
<li><a href="http://pttrns.com/" target="_blank" rel="noopener">http://pttrns.com/</a></li>
<li><a href="http://capptivate.co/" target="_blank" rel="noopener">http://capptivate.co/</a></li>
</ul>
<h3 id="国外个人博客"><a href="#国外个人博客" class="headerlink" title="国外个人博客"></a>国外个人博客</h3><ul>
<li><a href="http://jakewharton.com/blog" target="_blank" rel="noopener">Jakewharton</a></li>
<li><a href="http://www.curious-creature.com/" target="_blank" rel="noopener">Romain Guy</a></li>
<li><a href="http://cyrilmottier.com/" target="_blank" rel="noopener">Cyril Mottier</a></li>
<li><a href="http://blog.stylingandroid.com/" target="_blank" rel="noopener">Mark Allison</a></li>
<li><a href="http://blog.danlew.net/" target="_blank" rel="noopener">Daniel Lew</a></li>
<li><a href="http://www.androidhive.info/" target="_blank" rel="noopener">Ravi Tamada</a></li>
<li><a href="http://loseyourmarbles.co/about-me/" target="_blank" rel="noopener">Chris Nash</a></li>
<li><a href="http://www.androiduipatterns.com/" target="_blank" rel="noopener">juhani@fatrobot.io</a></li>
<li><a href="http://www.grokkingandroid.com/" target="_blank" rel="noopener">Wolfram Rittmeyer</a></li>
<li><a href="http://geekyouup.blogspot.com/" target="_blank" rel="noopener">Rich Hyndman</a></li>
</ul>
<h3 id="国外的一些优秀网站"><a href="#国外的一些优秀网站" class="headerlink" title="国外的一些优秀网站"></a>国外的一些优秀网站</h3><ul>
<li><a href="http://androidweekly.net/" target="_blank" rel="noopener">androidweekly.net</a></li>
<li><a href="http://android-developers.blogspot.ca/" target="_blank" rel="noopener">Android Developers Blog</a></li>
<li><a href="http://www.vogella.com/tutorials/android.html" target="_blank" rel="noopener">vogella</a></li>
<li><a href="http://www.tutorialspoint.com/android/" target="_blank" rel="noopener">tutorialspoint</a></li>
<li><a href="http://code.tutsplus.com/categories/android-sdk" target="_blank" rel="noopener">tutsplus</a></li>
<li><a href="http://www.coderzheaven.com/android-tutorials/" target="_blank" rel="noopener">oderzheaven</a></li>
<li><a href="https://thenewcircle.com/training/android/" target="_blank" rel="noopener">thenewcircle</a></li>
<li><a href="http://www.coreservlets.com/android-tutorial/" target="_blank" rel="noopener">coreservlets</a></li>
<li><a href="http://droid-blog.net/" target="_blank" rel="noopener">Droid-Blog</a></li>
<li><a href="https://www.coursera.org/" target="_blank" rel="noopener">coursera.org</a></li>
<li><a href="http://commonsware.com/blog/archive.html" target="_blank" rel="noopener">commonsware.com</a></li>
<li><a href="http://android.amberfog.com/" target="_blank" rel="noopener">http://android.amberfog.com/</a></li>
<li><a href="http://www.anddev.org/" target="_blank" rel="noopener">anddev</a></li>
</ul>
<h3 id="Ibeacon与蓝牙4-0相关"><a href="#Ibeacon与蓝牙4-0相关" class="headerlink" title="Ibeacon与蓝牙4.0相关"></a>Ibeacon与蓝牙4.0相关</h3><ul>
<li><a href="https://github.com/AltBeacon/android-beacon-library" target="_blank" rel="noopener">一个ibeacon交互库</a></li>
<li><a href="https://github.com/AprilBrother/AprilBeacon-Android-SDK" target="_blank" rel="noopener">AprilBeacon-Android-sdk</a></li>
<li><a href="https://github.com/Estimote/Android-SDK" target="_blank" rel="noopener">Estimote SDK</a></li>
<li><a href="https://github.com/devunwired/accessory-samples" target="_blank" rel="noopener">蓝牙4.0相关</a></li>
</ul>
<h3 id="WEB与前端相关"><a href="#WEB与前端相关" class="headerlink" title="WEB与前端相关"></a>WEB与前端相关</h3><ul>
<li><a href="http://www.yiichina.com/" target="_blank" rel="noopener">yii</a></li>
<li><a href="http://yiibooster.clevertech.biz/" target="_blank" rel="noopener">yiibooster</a></li>
<li><a href="https://github.com/dodgepudding/wechat-php-sdk" target="_blank" rel="noopener">wechat-php-sdk</a></li>
<li><a href="https://github.com/acczefly/php_sae_storage" target="_blank" rel="noopener">php_sae_storage</a></li>
<li><a href="http://www.bootcss.com/" target="_blank" rel="noopener">Bootstrap</a></li>
<li><a href="https://github.com/FortAwesome/Font-Awesome" target="_blank" rel="noopener">Font-Awesome字体图标</a></li>
<li><a href="https://github.com/sindresorhus/sublime-autoprefixer" target="_blank" rel="noopener">sublime浏览器前缀插件</a></li>
<li><a href="https://github.com/mattbryson/TouchSwipe-Jquery-Plugin" target="_blank" rel="noopener">一个手势库</a></li>
<li><a href="https://github.com/markusslima/bootstrap-filestyle" target="_blank" rel="noopener">bootstrap-filestyle</a></li>
<li><a href="https://github.com/znddzxx112/bitcms" target="_blank" rel="noopener">基于Codeigniter的CMS系统</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/05/06/env-unix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/05/06/env-unix/" itemprop="url">
                  env-unix
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-06T17:47:28+08:00">
                2019-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>POSIX表示可移植操作系统接口（Portable Operating System Interface of UNIX，缩写为 POSIX ），POSIX标准定义了操作系统应该为应用程序提供的接口标准，是IEEE为要在各种UNIX操作系统上运行的软件而定义的一系列API标准的总称，其正式称呼为IEEE 1003，而国际标准名称为ISO/IEC 9945。
POSIX标准意在期望获得源代码级别的软件可移植性。换句话说，为一个POSIX兼容的操作系统编写的程序，应该可以在任何其它的POSIX操作系统（即使是来自另一个厂商）上编译执行。
POSIX 并不局限于 UNIX。许多其它的操作系统，例如 DEC OpenVMS 支持 POSIX 标准，尤其是 IEEE Std. 1003.1-1990（1995 年修订）或 POSIX.1，POSIX.1 提供了源代码级别的 C 语言应用编程接口（API）给操作系统的服务程序，例如读写文件。POSIX.1 已经被国际标准化组织（International Standards Organization，ISO）所接受，被命名为 ISO/IEC 9945-1:1990 标准。</p>
<p>UNIX和类Unix操作系统
UNIX System V家族    </p>
<ul>
<li>A/UX    </li>
<li>AIX    </li>
<li>HP-UX    </li>
<li>IRIX</li>
<li>LynxOS    </li>
<li>SCO OpenServer    </li>
<li>Tru64    </li>
<li>Xenix</li>
<li>Solaris    </li>
<li>OS/2<br>BSD UNIX-386BSD家族    </li>
<li>BSD/OS    </li>
<li>FreeBSD    </li>
<li>NetBSD    </li>
<li>NEXTSTEP</li>
<li>Mac OS X    </li>
<li>iOS    </li>
<li>OpenBSD    </li>
<li>SUN OS</li>
<li>OpenSolaris<br>UNIX-Like    </li>
<li>GNU    </li>
<li>Linux    </li>
<li>Android    </li>
<li>Debian</li>
<li>Ubuntu    </li>
<li>Red Hat    </li>
<li>Linux Mint    </li>
<li>Minix</li>
<li>QNX    </li>
<li>GNU/Linux    </li>
<li>GNU/Hurd    </li>
<li>Debian GNU/Hurd</li>
<li>GNU/kFreeBSD    </li>
<li>StartOS<br>其他    </li>
<li>DOS    </li>
<li>MS-DOS    </li>
<li>Windows    </li>
<li>React OS</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/05/03/tips-linux-sed/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/05/03/tips-linux-sed/" itemprop="url">
                  Linux sed命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-03T22:27:10+08:00">
                2019-05-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux管理/" itemprop="url" rel="index">
                    <span itemprop="name">linux管理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Linux sed命令是利用script来处理文本文件。
sed可依照script的指令，来处理、编辑文本文件。
Sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [-hnV][-e&lt;script&gt;][-f&lt;script文件&gt;][文本文件]</span><br></pre></td></tr></table></figure>

<h4 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a>参数说明：</h4><ul>
<li><code>-e&lt;script&gt;或--expression=&lt;script&gt;</code> 以选项中指定的script来处理输入的文本文件。</li>
<li><code>-f&lt;script文件&gt;或--file=&lt;script文件&gt;</code> 以选项中指定的script文件来处理输入的文本文件。</li>
<li>-h或–help 显示帮助。</li>
<li>-n或–quiet或–silent 仅显示script处理后的结果。</li>
<li>-V或–version 显示版本信息。</li>
</ul>
<h4 id="动作说明："><a href="#动作说明：" class="headerlink" title="动作说明："></a>动作说明：</h4><ul>
<li>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～</li>
<li>c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</li>
<li>d ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；</li>
<li>i ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</li>
<li>p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～</li>
<li>s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3>在testfile文件的第四行后添加一行，并将结果输出到标准输出，在命令行提示符下输入如下命令：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e 4a\newLine testfile</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>首先查看testfile中的内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cat testfile #查看testfile 中的内容  </span><br><span class="line">HELLO LINUX!  </span><br><span class="line">Linux is a free unix-type opterating system.  </span><br><span class="line">This is a linux testfile!  </span><br><span class="line">Linux test</span><br></pre></td></tr></table></figure>

<p>使用sed命令后，输出结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sed -e 4a\newline testfile #使用sed 在第四行后添加新字符串  </span><br><span class="line">HELLO LINUX! #testfile文件原有的内容  </span><br><span class="line">Linux is a free unix-type opterating system.  </span><br><span class="line">This is a linux testfile!  </span><br><span class="line">Linux test  </span><br><span class="line">newline</span><br></pre></td></tr></table></figure>

<h4 id="以行为单位的新增-删除"><a href="#以行为单位的新增-删除" class="headerlink" title="以行为单位的新增/删除"></a>以行为单位的新增/删除</h4><p>将 <code>/etc/passwd</code> 的内容列出并且列印行号，同时，请将第 2~5 行删除！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# nl /etc/passwd | sed &apos;2,5d&apos;</span><br><span class="line">1 root:x:0:0:root:/root:/bin/bash</span><br><span class="line">6 sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">.....(后面省略).....</span><br></pre></td></tr></table></figure>

<p>sed 的动作为 ‘2,5d’ ，那个 d 就是删除！因为 2-5 行给他删除了，所以显示的数据就没有 2-5 行罗～ 另外，注意一下，原本应该是要下达 sed -e 才对，没有 -e 也行啦！同时也要注意的是， sed 后面接的动作，请务必以 ‘’ 两个单引号括住喔！</p>
<p>只要删除第 2 行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed &apos;2d&apos;</span><br></pre></td></tr></table></figure>

<p>要删除第 3 到最后一行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed &apos;3,$d&apos;</span><br></pre></td></tr></table></figure>

<p>在第二行后(亦即是加在第三行)加上『drink tea?』字样！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# nl /etc/passwd | sed &apos;2a drink tea&apos;</span><br><span class="line">1 root:x:0:0:root:/root:/bin/bash</span><br><span class="line">2 bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">drink tea</span><br><span class="line">3 daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">.....(后面省略).....</span><br></pre></td></tr></table></figure>

<p>那如果是要在第二行前</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed &apos;2i drink tea&apos;</span><br></pre></td></tr></table></figure>

<p>如果是要增加两行以上，在第二行后面加入两行字，例如 Drink tea or ….. 与 drink beer?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# nl /etc/passwd | sed &apos;2a Drink tea or ......\</span><br><span class="line">&gt; drink beer ?&apos;</span><br><span class="line">1 root:x:0:0:root:/root:/bin/bash</span><br><span class="line">2 bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">Drink tea or ......</span><br><span class="line">drink beer ?</span><br><span class="line">3 daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">.....(后面省略).....</span><br></pre></td></tr></table></figure>

<p>每一行之间都必须要以反斜杠『 \ 』来进行新行的添加喔！所以，上面的例子中，我们可以发现在第一行的最后面就有 \ 存在。</p>
<h4 id="以行为单位的替换与显示"><a href="#以行为单位的替换与显示" class="headerlink" title="以行为单位的替换与显示"></a>以行为单位的替换与显示</h4><p>将第2-5行的内容取代成为『No 2-5 number』呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# nl /etc/passwd | sed &apos;2,5c No 2-5 number&apos;</span><br><span class="line">1 root:x:0:0:root:/root:/bin/bash</span><br><span class="line">No 2-5 number</span><br><span class="line">6 sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">.....(后面省略).....</span><br></pre></td></tr></table></figure>

<p>透过这个方法我们就能够将数据整行取代了！
仅列出 <code>/etc/passwd</code> 文件内的第 5-7 行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# nl /etc/passwd | sed -n &apos;5,7p&apos;</span><br><span class="line">5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">6 sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br></pre></td></tr></table></figure>

<p>可以透过这个 sed 的以行为单位的显示功能， 就能够将某一个文件内的某些行号选择出来显示。</p>
<h4 id="数据的搜寻并显示"><a href="#数据的搜寻并显示" class="headerlink" title="数据的搜寻并显示"></a>数据的搜寻并显示</h4><p>搜索 <code>/etc/passwd</code>有root关键字的行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed &apos;/root/p&apos;</span><br><span class="line">1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">3  bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">4  sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">5  sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">....下面忽略</span><br></pre></td></tr></table></figure>

<p>如果root找到，除了输出所有行，还会输出匹配行。</p>
<p>使用-n的时候将只打印包含模板的行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed -n &apos;/root/p&apos;</span><br><span class="line">1  root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<h4 id="数据的搜寻并删除"><a href="#数据的搜寻并删除" class="headerlink" title="数据的搜寻并删除"></a>数据的搜寻并删除</h4><p>删除/etc/passwd所有包含root的行，其他行输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed  &apos;/root/d&apos;</span><br><span class="line">2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">3  bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">....下面忽略</span><br><span class="line">#第一行的匹配root已经删除了</span><br></pre></td></tr></table></figure>

<h4 id="数据的搜寻并执行命令"><a href="#数据的搜寻并执行命令" class="headerlink" title="数据的搜寻并执行命令"></a>数据的搜寻并执行命令</h4><p>搜索/etc/passwd,找到root对应的行，执行后面花括号中的一组命令，每个命令之间用分号分隔，这里把bash替换为blueshell，再输出这行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed -n &apos;/root/&#123;s/bash/blueshell/;p;q&#125;&apos;    </span><br><span class="line">1  root:x:0:0:root:/root:/bin/blueshell</span><br></pre></td></tr></table></figure>

<p>最后的q是退出。</p>
<h4 id="数据的搜寻并替换"><a href="#数据的搜寻并替换" class="headerlink" title="数据的搜寻并替换"></a>数据的搜寻并替换</h4><p>除了整行的处理模式之外， sed 还可以用行为单位进行部分数据的搜寻并取代。基本上 sed 的搜寻与替代的与 vi 相当的类似！他有点像这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed &apos;s/要被取代的字串/新的字串/g&apos;</span><br></pre></td></tr></table></figure>

<p>先观察原始信息，利用 /sbin/ifconfig 查询 IP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# /sbin/ifconfig eth0</span><br><span class="line">eth0 Link encap:Ethernet HWaddr 00:90:CC:A6:34:84</span><br><span class="line">inet addr:192.168.1.100 Bcast:192.168.1.255 Mask:255.255.255.0</span><br><span class="line">inet6 addr: fe80::290:ccff:fea6:3484/64 Scope:Link</span><br><span class="line">UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1</span><br><span class="line">.....(以下省略).....</span><br></pre></td></tr></table></figure>

<p>本机的ip是192.168.1.100。将 IP 前面的部分予以删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# /sbin/ifconfig eth0 | grep &apos;inet addr&apos; | sed &apos;s/^.*addr://g&apos;</span><br><span class="line">192.168.1.100 Bcast:192.168.1.255 Mask:255.255.255.0</span><br></pre></td></tr></table></figure>

<p>接下来则是删除后续的部分，亦即： 192.168.1.100 Bcast:192.168.1.255 Mask:255.255.255.0
将 IP 后面的部分予以删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# /sbin/ifconfig eth0 | grep &apos;inet addr&apos; | sed &apos;s/^.*addr://g&apos; | sed &apos;s/Bcast.*$//g&apos;</span><br><span class="line">192.168.1.100</span><br></pre></td></tr></table></figure>

<h4 id="多点编辑"><a href="#多点编辑" class="headerlink" title="多点编辑"></a>多点编辑</h4><p>一条sed命令，删除<code>/etc/passwd</code>第三行到末尾的数据，并把bash替换为blueshell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nl /etc/passwd | sed -e &apos;3,$d&apos; -e &apos;s/bash/blueshell/&apos;</span><br><span class="line">1  root:x:0:0:root:/root:/bin/blueshell</span><br><span class="line">2  daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br></pre></td></tr></table></figure>

<p>-e表示多点编辑，第一个编辑命令删除/etc/passwd第三行到末尾的数据，第二条命令搜索bash替换为blueshell。</p>
<h4 id="直接修改文件内容-危险动作"><a href="#直接修改文件内容-危险动作" class="headerlink" title="直接修改文件内容(危险动作)"></a>直接修改文件内容(危险动作)</h4><p>sed 可以直接修改文件的内容，不必使用管道命令或数据流重导向！ 不过，由於这个动作会直接修改到原始的文件，所以请你千万不要随便拿系统配置来测试！ 我们还是使用文件 regular_express.txt 文件来测试看看吧！</p>
<p>regular_express.txt 文件内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# cat regular_express.txt </span><br><span class="line">runoob.</span><br><span class="line">google.</span><br><span class="line">taobao.</span><br><span class="line">facebook.</span><br><span class="line">zhihu-</span><br><span class="line">weibo-</span><br></pre></td></tr></table></figure>

<p>利用 sed 将 regular_express.txt 内每一行结尾若为 . 则换成 !</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# sed -i &apos;s/\.$/\!/g&apos; regular_express.txt</span><br><span class="line">[root@www ~]# cat regular_express.txt </span><br><span class="line">runoob!</span><br><span class="line">google!</span><br><span class="line">taobao!</span><br><span class="line">facebook!</span><br><span class="line">zhihu-</span><br><span class="line">weibo-</span><br></pre></td></tr></table></figure>

<p>:q:q
利用 sed 直接在 regular_express.txt 最后一行加入 # This is a test:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# sed -i &apos;$a # This is a test&apos; regular_express.txt</span><br><span class="line">[root@www ~]# cat regular_express.txt </span><br><span class="line">runoob!</span><br><span class="line">google!</span><br><span class="line">taobao!</span><br><span class="line">facebook!</span><br><span class="line">zhihu-</span><br><span class="line">weibo-</span><br><span class="line"># This is a test</span><br></pre></td></tr></table></figure>

<p>由于 $ 代表的是最后一行，而 a 的动作是新增，因此该文件最后新增 # This is a test！
sed 的 -i 选项可以直接修改文件内容，这功能非常有帮助！举例来说，如果你有一个 100 万行的文件，你要在第 100 行加某些文字，此时使用 vim 可能会疯掉！因为文件太大了！那怎办？就利用 sed 啊！透过 sed 直接修改/取代的功能，你甚至不需要使用 vim 去修订！</p>
<p>mac中sed -i 需要带一个字符串，用来备份源文件，这个字符串加在源文件名后面组成备份文件名。
如果这个字符串长度为0，就是说是个空串，那么不备份。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;bs&quot; &apos;s/Atl/Dog/g&apos; example.txt</span><br></pre></td></tr></table></figure>

<p>这样会生成一个example.txtbs的备份文件。
如果不备份，直接给个空</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;&quot; &apos;s/Atl/Dog/g&apos; example.txt</span><br></pre></td></tr></table></figure>

<h3 id="使用正则表达式提取子串"><a href="#使用正则表达式提取子串" class="headerlink" title="使用正则表达式提取子串"></a>使用正则表达式提取子串</h3><p>现在有如下一串字符串：”asdfkjasldjkf”shiner”df
需求：需要提取出shiner子字符串。
命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost /]$  echo &quot;asdfkjasldjkf\&quot;shiner\&quot;df&quot; | sed &apos;s/\(.*\)&quot;\(.*\)&quot;\(.*\)/\2/g&apos;</span><br><span class="line">shiner</span><br></pre></td></tr></table></figure>

<p>命令解释</p>
<ul>
<li>s： 表示替换命令</li>
<li><code>\(.*\)&quot;</code> : 表示第一个引号前的内容</li>
<li><code>&quot;\(.*\)&quot;</code>：表示两引号之间的内容</li>
<li><code>)&quot;\(.*\)</code>：表示引号后的内容</li>
<li><code>\2</code>: 表示第二对括号里面的内容
括号里的表达式匹配的内容，可以用\1，\2等进行引用，第n个括号对内的内容，就用\n引用。</li>
</ul>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>sed正则中的空格就用空格表示，而不是\s，补充：可以用\s</li>
<li>sed正则中的数字只能用[0-9]，而不能用\d表示</li>
<li>sed正则中的1或者多个，只能用+，而不能用+，区别就是加了转义字符</li>
<li>sed正则中的()前要加转义字符，变成<code>\(\)</code></li>
<li>number=xxx这条赋值语句的等号两边不能有空格，如果赋值语句有空格，linux系统会认为number是一个命令</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/04/30/tips-android-mmap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/30/tips-android-mmap/" itemprop="url">
                  mmap分析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-30T17:36:20+08:00">
                2019-04-30
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tips/" itemprop="url" rel="index">
                    <span itemprop="name">tips</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="mmap基础概念"><a href="#mmap基础概念" class="headerlink" title="mmap基础概念"></a>mmap基础概念</h3><p>mmap是一种内存映射文件的方法，即将一个文件或者其它对象映射到进程的地址空间，实现文件磁盘地址和进程虚拟地址空间中一段虚拟地址的一一对映关系。实现这样的映射关系后，进程就可以采用指针的方式读写操作这一段内存，而系统会自动回写脏页面到对应的文件磁盘上，即完成了对文件的操作而不必再调用read,write等系统调用函数。相反，内核空间对这段区域的修改也直接反映用户空间，从而可以实现不同进程间的文件共享。如下图所示</p>
<p><img src="http://images.wodekouwei.com/tips-android-mmap-201943018165.png" alt="tips-android-mmap-201943018165"></p>
<p>由上图可以看出，进程的虚拟地址空间，由多个虚拟内存区域构成。虚拟内存区域是进程的虚拟地址空间中的一个同质区间，即具有同样特性的连续地址范围。上图中所示的text数据段（代码段）、初始数据段、BSS数据段、堆、栈和内存映射，都是一个独立的虚拟内存区域。而为内存映射服务的地址空间处在堆栈之间的空余部分。</p>
<p>linux内核使用vm_area_struct结构来表示一个独立的虚拟内存区域，由于每个不同质的虚拟内存区域功能和内部机制都不同，因此一个进程使用多个vm_area_struct结构来分别表示不同类型的虚拟内存区域。各个vm_area_struct结构使用链表或者树形结构链接，方便进程快速访问，如下图所示：</p>
<p><img src="http://images.wodekouwei.com/tips-android-mmap-2019430181614.png" alt="tips-android-mmap-2019430181614"></p>
<p>vm_area_struct结构中包含区域起始和终止地址以及其他相关信息，同时也包含一个vm_ops指针，其内部可引出所有针对这个区域可以使用的系统调用函数。这样，进程对某一虚拟内存区域的任何操作需要用要的信息，都可以从vm_area_struct中获得。mmap函数就是要创建一个新的vm_area_struct结构，并将其与文件的物理磁盘地址相连。具体步骤请看下一节。</p>
<h3 id="mmap内存映射原理"><a href="#mmap内存映射原理" class="headerlink" title="mmap内存映射原理"></a>mmap内存映射原理</h3><p>mmap内存映射的实现过程，总的来说可以分为三个阶段：</p>
<h4 id="一-进程启动映射过程，并在虚拟地址空间中为映射创建虚拟映射区域"><a href="#一-进程启动映射过程，并在虚拟地址空间中为映射创建虚拟映射区域" class="headerlink" title="一.进程启动映射过程，并在虚拟地址空间中为映射创建虚拟映射区域"></a>一.进程启动映射过程，并在虚拟地址空间中为映射创建虚拟映射区域</h4><ol>
<li>进程在用户空间调用库函数mmap，原型：void *mmap(void *start, size_t length, int prot, int flags, int fd, off_t offset);</li>
<li>在当前进程的虚拟地址空间中，寻找一段空闲的满足要求的连续的虚拟地址</li>
<li>为此虚拟区分配一个vm_area_struct结构，接着对这个结构的各个域进行了初始化</li>
<li>将新建的虚拟区结构（vm_area_struct）插入进程的虚拟地址区域链表或树中<h4 id="二-调用内核空间的系统调用函数mmap（不同于用户空间函数），实现文件物理地址和进程虚拟地址的一一映射关系"><a href="#二-调用内核空间的系统调用函数mmap（不同于用户空间函数），实现文件物理地址和进程虚拟地址的一一映射关系" class="headerlink" title="二.调用内核空间的系统调用函数mmap（不同于用户空间函数），实现文件物理地址和进程虚拟地址的一一映射关系"></a>二.调用内核空间的系统调用函数mmap（不同于用户空间函数），实现文件物理地址和进程虚拟地址的一一映射关系</h4></li>
<li>为映射分配了新的虚拟地址区域后，通过待映射的文件指针，在文件描述符表中找到对应的文件描述符，通过文件描述符，链接到内核“已打开文件集”中该文件的文件结构体（struct file），每个文件结构体维护着和这个已打开文件相关各项信息。</li>
<li>通过该文件的文件结构体，链接到file_operations模块，调用内核函数mmap，其原型为：int mmap(struct file *filp, struct vm_area_struct *vma)，不同于用户空间库函数。</li>
<li>内核mmap函数通过虚拟文件系统inode模块定位到文件磁盘物理地址。</li>
<li>通过remap_pfn_range函数建立页表，即实现了文件地址和虚拟地址区域的映射关系。此时，这片虚拟地址并没有任何数据关联到主存中。</li>
</ol>
<h4 id="三-进程发起对这片映射空间的访问，引发缺页异常，实现文件内容到物理内存（主存）的拷贝"><a href="#三-进程发起对这片映射空间的访问，引发缺页异常，实现文件内容到物理内存（主存）的拷贝" class="headerlink" title="三.进程发起对这片映射空间的访问，引发缺页异常，实现文件内容到物理内存（主存）的拷贝"></a>三.进程发起对这片映射空间的访问，引发缺页异常，实现文件内容到物理内存（主存）的拷贝</h4><p>注：前两个阶段仅在于创建虚拟区间并完成地址映射，但是并没有将任何文件数据的拷贝至主存。真正的文件读取是当进程发起读或写操作时。</p>
<ol start="9">
<li>进程的读或写操作访问虚拟地址空间这一段映射地址，通过查询页表，发现这一段地址并不在物理页面上。因为目前只建立了地址映射，真正的硬盘数据还没有拷贝到内存中，因此引发缺页异常。</li>
<li>缺页异常进行一系列判断，确定无非法操作后，内核发起请求调页过程。</li>
<li>调页过程先在交换缓存空间（swap cache）中寻找需要访问的内存页，如果没有则调用nopage函数把所缺的页从磁盘装入到主存中。</li>
<li>之后进程即可对这片主存进行读或者写的操作，如果写操作改变了其内容，一定时间后系统会自动回写脏页面到对应磁盘地址，也即完成了写入到文件的过程。</li>
</ol>
<p>注：修改过的脏页面并不会立即更新回文件中，而是有一段时间的延迟，可以调用msync()来强制同步, 这样所写的内容就能立即保存到文件里了。</p>
<h3 id="mmap和常规文件操作的区别"><a href="#mmap和常规文件操作的区别" class="headerlink" title="mmap和常规文件操作的区别"></a>mmap和常规文件操作的区别</h3><p>对linux文件系统不了解的朋友，请参阅我之前写的博文<a href="http://www.cnblogs.com/huxiao-tee/p/4657851.html" target="_blank" rel="noopener">《从内核文件系统看文件读写过程》</a>，我们首先简单的回顾一下常规文件系统操作（调用read/fread等类函数）中，函数的调用过程：</p>
<ol>
<li>进程发起读文件请求。</li>
<li>内核通过查找进程文件符表，定位到内核已打开文件集上的文件信息，从而找到此文件的inode。</li>
<li>inode在address_space上查找要请求的文件页是否已经缓存在页缓存中。如果存在，则直接返回这片文件页的内容。</li>
<li>如果不存在，则通过inode定位到文件磁盘地址，将数据从磁盘复制到页缓存。之后再次发起读页面过程，进而将页缓存中的数据发给用户进程。</li>
</ol>
<p>总结来说，常规文件操作为了提高读写效率和保护磁盘，使用了页缓存机制。这样造成读文件时需要先将文件页从磁盘拷贝到页缓存中，由于页缓存处在内核空间，不能被用户进程直接寻址，所以还需要将页缓存中数据页再次拷贝到内存对应的用户空间中。这样，通过了两次数据拷贝过程，才能完成进程对文件内容的获取任务。写操作也是一样，待写入的buffer在内核空间不能直接访问，必须要先拷贝至内核空间对应的主存，再写回磁盘中（延迟写回），也是需要两次数据拷贝。</p>
<p>而使用mmap操作文件中，创建新的虚拟内存区域和建立文件磁盘地址和虚拟内存区域映射这两步，没有任何文件拷贝操作。而之后访问数据时发现内存中并无数据而发起的缺页异常过程，可以通过已经建立好的映射关系，只使用一次数据拷贝，就从磁盘中将数据传入内存的用户空间中，供进程使用。</p>
<p>总而言之，常规文件操作需要从磁盘到页缓存再到用户主存的两次数据拷贝。而mmap操控文件，只需要从磁盘到用户主存的一次数据拷贝过程。说白了，mmap的关键点是实现了用户空间和内核空间的数据直接交互而省去了空间不同数据不通的繁琐过程。因此mmap效率更高。</p>
<h3 id="mmap优点总结"><a href="#mmap优点总结" class="headerlink" title="mmap优点总结"></a>mmap优点总结</h3><p>由上文讨论可知，mmap优点共有一下几点：</p>
<ol>
<li>对文件的读取操作跨过了页缓存，减少了数据的拷贝次数，用内存读写取代I/O读写，提高了文件读取效率。</li>
<li>实现了用户空间和内核空间的高效交互方式。两空间的各自修改操作可以直接反映在映射的区域内，从而被对方空间及时捕捉。</li>
<li>提供进程间共享内存及相互通信的方式。不管是父子进程还是无亲缘关系的进程，都可以将自身用户空间映射到同一个文件或匿名映射到同一片区域。从而通过各自对映射区域的改动，达到进程间通信和进程间共享的目的。同时，如果进程A和进程B都映射了区域C，当A第一次读取C时通过缺页从磁盘复制文件页到内存中；但当B再读C的相同页面时，虽然也会产生缺页异常，但是不再需要从磁盘中复制文件过来，而可直接使用已经保存在内存中的文件数据。</li>
<li>可用于实现高效的大规模数据传输。内存空间不足，是制约大数据操作的一个方面，解决方案往往是借助硬盘空间协助操作，补充内存的不足。但是进一步会造成大量的文件I/O操作，极大影响效率。这个问题可以通过mmap映射很好的解决。换句话说，但凡是需要用磁盘空间代替内存的时候，mmap都可以发挥其功效。</li>
</ol>
<h3 id="mmap相关函数"><a href="#mmap相关函数" class="headerlink" title="mmap相关函数"></a>mmap相关函数</h3><h4 id="函数原型"><a href="#函数原型" class="headerlink" title="函数原型"></a>函数原型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void *mmap(void *start, size_t length, int prot, int flags, int fd, off_t offset);</span><br></pre></td></tr></table></figure>

<h4 id="返回说明"><a href="#返回说明" class="headerlink" title="返回说明"></a>返回说明</h4><p>成功执行时，mmap()返回被映射区的指针。失败时，mmap()返回MAP_FAILED[其值为(void *)-1]， error被设为以下的某个值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">EACCES：访问出错</span><br><span class="line">EAGAIN：文件已被锁定，或者太多的内存已被锁定</span><br><span class="line">EBADF：fd不是有效的文件描述词</span><br><span class="line">EINVAL：一个或者多个参数无效</span><br><span class="line">ENFILE：已达到系统对打开文件的限制</span><br><span class="line">ENODEV：指定文件所在的文件系统不支持内存映射</span><br><span class="line">ENOMEM：内存不足，或者进程已超出最大内存映射数量</span><br><span class="line">EPERM：权能不足，操作不允许</span><br><span class="line">ETXTBSY：已写的方式打开文件，同时指定MAP_DENYWRITE标志</span><br><span class="line">SIGSEGV：试着向只读区写入</span><br><span class="line">SIGBUS：试着访问不属于进程的内存区</span><br><span class="line"></span><br><span class="line">返回错误类型</span><br></pre></td></tr></table></figure>

<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><ul>
<li><p>start：映射区的开始地址</p>
</li>
<li><p>length：映射区的长度</p>
</li>
<li><p>prot：期望的内存保护标志，不能与文件的打开模式冲突。是以下的某个值，可以通过or运算合理地组合在一起</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> PROT_EXEC ：页内容可以被执行</span><br><span class="line">2 PROT_READ ：页内容可以被读取</span><br><span class="line">3 PROT_WRITE ：页可以被写入</span><br><span class="line">4 PROT_NONE ：页不可访问</span><br></pre></td></tr></table></figure>
</li>
<li><p>flags：指定映射对象的类型，映射选项和映射页是否可以共享。它的值可以是一个或者多个以下位的组合体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MAP_FIXED //使用指定的映射起始地址，如果由start和len参数指定的内存区重叠于现存的映射空间，重叠部分将会被丢弃。如果指定的起始地址不可用，操作将会失败。并且起始地址必须落在页的边界上。</span><br><span class="line">MAP_SHARED //与其它所有映射这个对象的进程共享映射空间。对共享区的写入，相当于输出到文件。直到msync()或者munmap()被调用，文件实际上不会被更新。</span><br><span class="line">MAP_PRIVATE //建立一个写入时拷贝的私有映射。内存区域的写入不会影响到原文件。这个标志和以上标志是互斥的，只能使用其中一个。</span><br><span class="line">MAP_DENYWRITE //这个标志被忽略。</span><br><span class="line">MAP_EXECUTABLE //同上</span><br><span class="line">MAP_NORESERVE //不要为这个映射保留交换空间。当交换空间被保留，对映射区修改的可能会得到保证。当交换空间不被保留，同时内存不足，对映射区的修改会引起段违例信号。</span><br><span class="line">MAP_LOCKED //锁定映射区的页面，从而防止页面被交换出内存。</span><br><span class="line">MAP_GROWSDOWN //用于堆栈，告诉内核VM系统，映射区可以向下扩展。</span><br><span class="line">MAP_ANONYMOUS //匿名映射，映射区不与任何文件关联。</span><br><span class="line">MAP_ANON //MAP_ANONYMOUS的别称，不再被使用。</span><br><span class="line">MAP_FILE //兼容标志，被忽略。</span><br><span class="line">MAP_32BIT //将映射区放在进程地址空间的低2GB，MAP_FIXED指定时会被忽略。当前这个标志只在x86-64平台上得到支持。</span><br><span class="line">MAP_POPULATE //为文件映射通过预读的方式准备好页表。随后对映射区的访问不会被页违例阻塞。</span><br><span class="line">MAP_NONBLOCK //仅和MAP_POPULATE一起使用时才有意义。不执行预读，只为已存在于内存中的页面建立页表入口。</span><br><span class="line"></span><br><span class="line">&gt; http://manpages.ubuntu.com/manpages/xenial/man2/mmap.2freebsd.html</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>MAP_NOSYNC         Causes data dirtied via this VM map to be flushed to physical media only
                        when necessary (usually by the pager) rather than gratuitously.
                        Typically this prevents the update daemons from flushing pages dirtied
                        through such maps and thus allows efficient sharing of memory across
                        unassociated processes using a file-backed shared memory map.  Without
                        this option any VM pages you dirty may be flushed to disk every so often
                        (every 30-60 seconds usually) which can create performance problems if
                        you do not need that to occur (such as when you are using shared file-
                        backed mmap regions for IPC purposes).  Note that VM/file system
                        coherency is maintained whether you use MAP_NOSYNC or not.  This option
                        is not portable across UNIX platforms (yet), though some may implement
                        the same behavior by default.</p>
<pre><code>WARNING!  Extending a file with ftruncate(2), thus creating a big hole,
and then filling the hole by modifying a shared mmap() can lead to severe
file fragmentation.  In order to avoid such fragmentation you should
always pre-allocate the file&apos;s backing store by write()ing zero&apos;s into
the newly extended area prior to modifying the area via your mmap().  The
fragmentation problem is especially sensitive to MAP_NOSYNC pages,
because pages may be flushed to disk in a totally random order.

The same applies when using MAP_NOSYNC to implement a file-based shared
memory store.  It is recommended that you create the backing store by
write()ing zero&apos;s to the backing file rather than ftruncate()ing it.  You
can test file fragmentation by observing the KB/t (kilobytes per
transfer) results from an “iostat 1” while reading a large file
sequentially, e.g. using “dd if=filename of=/dev/null bs=32k”.

The fsync(2) system call will flush all dirty data and metadata
associated with a file, including dirty NOSYNC VM data, to physical
media.  The sync(8) command and sync(2) system call generally do not
flush dirty NOSYNC VM data.  The msync(2) system call is usually not
needed since BSD implements a coherent file system buffer cache.
However, it may be used to associate dirty VM pages with file system
buffers and thus cause them to be flushed to physical media sooner rather
than later.</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">flag</span><br></pre></td></tr></table></figure>

<ul>
<li>fd：有效的文件描述词。如果MAP_ANONYMOUS被设定，为了兼容问题，其值应为-1</li>
<li>offset：被映射对象内容的起点</li>
</ul>
<h4 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h4><p>int munmap( void * addr, size_t len ) </p>
<p>成功执行时，munmap()返回0。失败时，munmap返回-1，error返回标志和mmap一致；</p>
<p>该调用在进程地址空间中解除一个映射关系，addr是调用mmap()时返回的地址，len是映射区的大小；</p>
<p>当映射关系解除后，对原来映射地址的访问将导致段错误发生。 </p>
<p>int msync( void *addr, size_t len, int flags )</p>
<p>一般说来，进程在映射空间的对共享内容的改变并不直接写回到磁盘文件中，往往在调用munmap（）后才执行该操作。</p>
<p>可以通过调用msync()实现磁盘上文件内容与共享内存区的内容一致。</p>
<h3 id="mmap使用细节"><a href="#mmap使用细节" class="headerlink" title="mmap使用细节"></a>mmap使用细节</h3><ol>
<li>使用mmap需要注意的一个关键点是，mmap映射区域大小必须是物理页大小(page_size)的整倍数（32位系统中通常是4k字节）。原因是，内存的最小粒度是页，而进程虚拟地址空间和内存的映射也是以页为单位。为了匹配内存的操作，mmap从磁盘到虚拟地址空间的映射也必须是页。</li>
<li>内核可以跟踪被内存映射的底层对象（文件）的大小，进程可以合法的访问在当前文件大小以内又在内存映射区以内的那些字节。也就是说，如果文件的大小一直在扩张，只要在映射区域范围内的数据，进程都可以合法得到，这和映射建立时文件的大小无关。具体情形参见“情形三”。</li>
<li>映射建立之后，即使文件关闭，映射依然存在。因为映射的是磁盘的地址，不是文件本身，和文件句柄无关。同时可用于进程间通信的有效地址空间不完全受限于被映射文件的大小，因为是按页映射。</li>
</ol>
<p>在上面的知识前提下，我们下面看看如果大小不是页的整倍数的具体情况：</p>
<h4 id="情形一：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射5000字节到虚拟内存中。"><a href="#情形一：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射5000字节到虚拟内存中。" class="headerlink" title="情形一：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射5000字节到虚拟内存中。"></a>情形一：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射5000字节到虚拟内存中。</h4><p>分析：因为单位物理页面的大小是4096字节，虽然被映射的文件只有5000字节，但是对应到进程虚拟地址区域的大小需要满足整页大小，因此mmap函数执行后，实际映射到虚拟内存区域8192个 字节，5000~8191的字节部分用零填充。映射后的对应关系如下图所示：
<img src="http://images.wodekouwei.com/tips-android-mmap-2019430182326.png" alt="tips-android-mmap-2019430182326"></p>
<p>此时：</p>
<ol>
<li>读/写前5000个字节（0~4999），会返回操作文件内容。</li>
<li>读字节5000<del>8191时，结果全为0。写5000</del>8191时，进程不会报错，但是所写的内容不会写入原文件中 。</li>
<li>读/写8192以外的磁盘部分，会返回一个SIGSECV错误。</li>
</ol>
<h4 id="情形二：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射15000字节到虚拟内存中，即映射大小超过了原始文件的大小。"><a href="#情形二：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射15000字节到虚拟内存中，即映射大小超过了原始文件的大小。" class="headerlink" title="情形二：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射15000字节到虚拟内存中，即映射大小超过了原始文件的大小。"></a>情形二：一个文件的大小是5000字节，mmap函数从一个文件的起始位置开始，映射15000字节到虚拟内存中，即映射大小超过了原始文件的大小。</h4><p>分析：由于文件的大小是5000字节，和情形一一样，其对应的两个物理页。那么这两个物理页都是合法可以读写的，只是超出5000的部分不会体现在原文件中。由于程序要求映射15000字节，而文件只占两个物理页，因此8192字节~15000字节都不能读写，操作时会返回异常。如下图所示：
<img src="http://images.wodekouwei.com/tips-android-mmap-201943018260.png" alt="tips-android-mmap-201943018260"></p>
<p>此时：</p>
<ol>
<li>进程可以正常读/写被映射的前5000字节(0~4999)，写操作的改动会在一定时间后反映在原文件中。</li>
<li>对于5000~8191字节，进程可以进行读写过程，不会报错。但是内容在写入前均为0，另外，写入后不会反映在文件中。</li>
<li>对于8192~14999字节，进程不能对其进行读写，会报SIGBUS错误。</li>
<li>对于15000以外的字节，进程不能对其读写，会引发SIGSEGV错误。</li>
</ol>
<h4 id="情形三：一个文件初始大小为0，使用mmap操作映射了1000-4K的大小，即1000个物理页大约4M字节空间，mmap返回指针ptr。"><a href="#情形三：一个文件初始大小为0，使用mmap操作映射了1000-4K的大小，即1000个物理页大约4M字节空间，mmap返回指针ptr。" class="headerlink" title="情形三：一个文件初始大小为0，使用mmap操作映射了1000*4K的大小，即1000个物理页大约4M字节空间，mmap返回指针ptr。"></a>情形三：一个文件初始大小为0，使用mmap操作映射了1000*4K的大小，即1000个物理页大约4M字节空间，mmap返回指针ptr。</h4><p>分析：如果在映射建立之初，就对文件进行读写操作，由于文件大小为0，并没有合法的物理页对应，如同情形二一样，会返回SIGBUS错误。</p>
<p>但是如果，每次操作ptr读写前，先增加文件的大小，那么ptr在文件大小内部的操作就是合法的。例如，文件扩充4096字节，ptr就能操作ptr ~ [ (char)ptr + 4095]的空间。只要文件扩充的范围在1000个物理页（映射范围）内，ptr都可以对应操作相同的大小。</p>
<p>这样，方便随时扩充文件空间，随时写入文件，不造成空间浪费。</p>
<h3 id="mmap-的回写时机："><a href="#mmap-的回写时机：" class="headerlink" title="mmap 的回写时机："></a>mmap 的回写时机：</h3><ul>
<li>内存不足</li>
<li>进程 crash</li>
<li>调用 msync 或者 munmap</li>
<li>不设置 MAP_NOSYNC 情况下 30s-60s(仅限FreeBSD)</li>
</ul>
<h3 id="Android下mmap"><a href="#Android下mmap" class="headerlink" title="Android下mmap"></a>Android下mmap</h3><p>Linux的内存分用户空间跟内核空间，同时页表有也分两类，用户空间页表跟内核空间页表，每个进程有一个用户空间页表，但是系统只有一个内核空间页表。而Binder mmap的关键是：更新用户空间对应的页表的同时也同步映射内核页表，让两个页表都指向同一块地址，这样一来，数据只需要从A进程的用户空间，直接拷贝拷贝到B所对应的内核空间，而B多对应的内核空间在B进程的用户空间也有相应的映射，这样就无需从内核拷贝到用户空间了。</p>
<p>普通文件mmap原理
普通文件的访问方式有两种：第一种是通过read/write系统调访问，先在用户空间分配一段buffer，然后，进入内核，将内容从磁盘读取到内核缓冲，最后，拷贝到用户进程空间，至少牵扯到两次数据拷贝；同时，多个进程同时访问一个文件，每个进程都有一个副本，存在资源浪费的问题。
另一种是通过mmap来访问文件，mmap()将文件直接映射到用户空间，文件在mmap的时候，内存并未真正分配，只有在第一次读取/写入的时候才会触发，这个时候，会引发缺页中断，在处理缺页中断的时候，完成内存也分配，同时也完成文件数据的拷贝。并且，修改用户空间对应的页表，完成到物理内存到用户空间的映射，这种方式只存在一次数据拷贝，效率更高。同时多进程间通过mmap共享文件数据的时候，仅需要一块物理内存就够了。
共享内存中mmap的使用
共享内存是在普通文件mmap的基础上实现的，其实就是基于tmpfs文件系统的普通mmap，</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2019/04/25/tips-android-ndk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="轻口味">
      <meta itemprop="description" content>
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="老司机种菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/25/tips-android-ndk/" itemprop="url">
                  Android NDK备忘
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-25T10:41:45+08:00">
                2019-04-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tips/" itemprop="url" rel="index">
                    <span itemprop="name">tips</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Android-NDK-Crash-日志抓取及定位"><a href="#Android-NDK-Crash-日志抓取及定位" class="headerlink" title="Android NDK Crash 日志抓取及定位"></a>Android NDK Crash 日志抓取及定位</h3><h4 id="NDK-STACK-定位-NDK-Crash-位置"><a href="#NDK-STACK-定位-NDK-Crash-位置" class="headerlink" title="NDK-STACK 定位 NDK Crash 位置"></a>NDK-STACK 定位 NDK Crash 位置</h4><p>只要执行如下代码就行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb logcat | ndk-stack -sym /yourProjectPath/obj/local/armeabi-v7a</span><br></pre></td></tr></table></figure>

<p>PS: 必须是带symbols的so，也就是在’\app\src\main\obj\local\下面的so’, 否则行号打印出来降是??.?? </p>
<h4 id="使用-arm-linux-androideabi-addr2line-定位-NDK-Crash"><a href="#使用-arm-linux-androideabi-addr2line-定位-NDK-Crash" class="headerlink" title="使用 arm-linux-androideabi-addr2line 定位 NDK Crash"></a>使用 arm-linux-androideabi-addr2line 定位 NDK Crash</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#11 pc 00032493  /data/app/com.pic.livefilters-1/lib/arm/libhairUtils.so (detectHairByOpenCV+1930)</span><br></pre></td></tr></table></figure>

<p>执行 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arm-linux-androideabi-addr2line -e /yourProjectPath/src/main/obj/local/armeabi-v7a/libhairUtils.so 00032493</span><br></pre></td></tr></table></figure>

<p>将pc地址转换为行号
aarch64-linux-android-addr2line工具地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndk-bundle/toolchains/aarch64-linux-android-4.9/prebuilt/darwin-x86_64/bin/aarch64-linux-android-addr2line</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg" alt="轻口味">
          <p class="site-author-name" itemprop="name">轻口味</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">190</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">63</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/qingkouwei" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/LightTaste" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/turnpp/" target="_blank" title="豆瓣">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  豆瓣
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/shen-jun-wei-9/" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/ossrs/srs" title="SRS" target="_blank">SRS</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">轻口味</span>
</div>

<div>
<a href="http://www.miitbeian.gov.cn/">京ICP备17018543号</a>

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      本站访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </div></footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "bb46b146831e4e34808d09cd94c85f50",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

</body>
</html>
