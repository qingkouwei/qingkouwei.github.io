<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="è€å¸æœºç§èœ" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="è€å¸æœºç§èœ">
<meta property="og:url" content="http://wodekouwei.com/page/5/index.html">
<meta property="og:site_name" content="è€å¸æœºç§èœ">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è€å¸æœºç§èœ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://wodekouwei.com/page/5/"/>





  <title> è€å¸æœºç§èœ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2021aa5f03a4203621d42ef374e0d5f7";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è€å¸æœºç§èœ</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            å…¬ç›Š404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="æœç´¢..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/30/tips-shell-language/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/30/tips-shell-language/" itemprop="url">
                  shellå¼€å‘ä½¿ç”¨å°æŠ€å·§
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-30T11:54:47+08:00">
                2017-09-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/language/" itemprop="url" rel="index">
                    <span itemprop="name">language</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="å†™è„šæœ¬ä¿®æ”¹æ•°æ®åº“ä¸­è¡¨çš„æŸä¸€å­—æ®µå€¼"><a href="#å†™è„šæœ¬ä¿®æ”¹æ•°æ®åº“ä¸­è¡¨çš„æŸä¸€å­—æ®µå€¼" class="headerlink" title="å†™è„šæœ¬ä¿®æ”¹æ•°æ®åº“ä¸­è¡¨çš„æŸä¸€å­—æ®µå€¼"></a>å†™è„šæœ¬ä¿®æ”¹æ•°æ®åº“ä¸­è¡¨çš„æŸä¸€å­—æ®µå€¼</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">##########################################################</div><div class="line">#ä¿®æ”¹è¡¨TBL_BAT_TASK_CTLçš„USE_FLAGå­—æ®µï¼Œå¯åŠ¨æˆ–åœæ­¢è´·è®°å¡é”€å¡çš„æ‰¹å¤„ç†</div><div class="line">#useageï¼šæ‰§è¡Œè„šæœ¬æ—¶åŠ -nå‚æ•°å°±æ˜¯å…³é—­æ‰¹å¤„ç†</div><div class="line">#    æ‰§è¡Œè„šæœ¬æ—¶åŠ -yå‚æ•°å°±æ˜¯æ‰“å¼€æ‰¹å¤„ç†</div><div class="line">##########################################################</div><div class="line"></div><div class="line">#!/bin/bash</div><div class="line"></div><div class="line">if test &quot;$1&quot; = &quot;-n&quot;</div><div class="line">then</div><div class="line">    db2 connect to $DBLINK</div><div class="line">    db2 &quot;update TBL_BAT_TASK_CTL set USE_FLAG=&apos;N&apos; where BAT_ID=&apos;0024&apos; or BAT_ID=&apos;0025&apos;&quot;</div><div class="line">    db2 terminate</div><div class="line">#   exit 0</div><div class="line">fi</div><div class="line"></div><div class="line">if test &quot;$1&quot; = &quot;-y&quot;</div><div class="line">then</div><div class="line">    db2 connect to $DBLINK</div><div class="line">    db2 &quot;update TBL_BAT_TASK_CTL set USE_FLAG=&apos;Y&apos; where BAT_ID=&apos;0024&apos; or BAT_ID=&apos;0025&apos;&quot;</div><div class="line">    db2 terminate</div><div class="line">fi</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/29/opencv-core/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/29/opencv-core/" itemprop="url">
                  opencvæ ¸å¿ƒç±»å‹
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-29T18:09:42+08:00">
                2017-09-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/opencv/" itemprop="url" rel="index">
                    <span itemprop="name">opencv</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="mat"><a href="#mat" class="headerlink" title="mat"></a>mat</h3><p>Matæ›¿ä»£lplImage</p>
<h4 id="åˆ›å»ºå’Œæ¸…ç†matç©ºé—´"><a href="#åˆ›å»ºå’Œæ¸…ç†matç©ºé—´" class="headerlink" title="åˆ›å»ºå’Œæ¸…ç†matç©ºé—´"></a>åˆ›å»ºå’Œæ¸…ç†matç©ºé—´</h4><ul>
<li>Mat mat(3000, 4000, CV_8UC3);//3000è¡Œ,4000åˆ—æ•°ç»„,æ•°ç»„é‡Œå­˜æ”¾3ä¸ªunsigned charç±»å‹çš„æ•°æ®</li>
<li>mat.create(rows, cols, CV_8UC1);//è¡Œæ•°,åˆ—æ•°,å¦‚æœmatå·²ç»æœ‰ç©ºé—´,createæ—¶ä¼šè‡ªåŠ¨æ¸…ç†å·²æœ‰ç©ºé—´</li>
<li>releaseæˆ–è€…ææ„:å¼•ç”¨è®¡æ•°ä¸º1æ—¶é‡Šæ”¾</li>
</ul>
<blockquote>
<p>å¤„ç†ç±»å‹ä¸€å®šè¦ç”¨unsigned charè€Œä¸æ˜¯char</p>
</blockquote>
<h4 id="3-3RGBå›¾åƒå­˜æ”¾æ–¹å¼-è¿ç»­"><a href="#3-3RGBå›¾åƒå­˜æ”¾æ–¹å¼-è¿ç»­" class="headerlink" title="3*3RGBå›¾åƒå­˜æ”¾æ–¹å¼(è¿ç»­)"></a>3*3RGBå›¾åƒå­˜æ”¾æ–¹å¼(è¿ç»­)</h4><p><img src="http://" alt="image"></p>
<h5 id="isContinuous"><a href="#isContinuous" class="headerlink" title="isContinuous"></a>isContinuous</h5><ul>
<li>åˆ¤æ–­å­˜å‚¨ç©ºé—´æ˜¯å¦è¿ç»­</li>
<li>é€šè¿‡stepè®°å½•</li>
</ul>
<h4 id="ç›´æ¥åœ°å€è®¿é—®è¿ç»­ç©ºé—´"><a href="#ç›´æ¥åœ°å€è®¿é—®è¿ç»­ç©ºé—´" class="headerlink" title="ç›´æ¥åœ°å€è®¿é—®è¿ç»­ç©ºé—´"></a>ç›´æ¥åœ°å€è®¿é—®è¿ç»­ç©ºé—´</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">int size = mat.rows*mat.cols*mat.elemSize();</div><div class="line">for(int i = 0; i&lt; size; i+3)//3æ˜¯å› ä¸ºRGB</div><div class="line">&#123;</div><div class="line">  mat.data[i] = 0; //B</div><div class="line">  mat.data[i+1] = 0; //G</div><div class="line">  mat.data[i+2] = 0; //R</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>//ä¼˜åŒ–ç¼–ç åæ•ˆç‡é«˜13ms (4000*3000)</p>
<h4 id="ç›´æ¥åœ°å€è®¿é—®ä¸è¿ç»­ç©ºé—´"><a href="#ç›´æ¥åœ°å€è®¿é—®ä¸è¿ç»­ç©ºé—´" class="headerlink" title="ç›´æ¥åœ°å€è®¿é—®ä¸è¿ç»­ç©ºé—´"></a>ç›´æ¥åœ°å€è®¿é—®ä¸è¿ç»­ç©ºé—´</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">for(int i = 0; i &lt; mat.row; i++)</div><div class="line">&#123;</div><div class="line">  for(int j = 0; j &lt; mat.cols; j++)</div><div class="line">  &#123;</div><div class="line">    (&amp;mat.data[i*mat.step])[j*3] = 255;//B</div><div class="line">    (&amp;mat.data[i*mat.step])[j*3 + 1] = 255;//G</div><div class="line">    (&amp;mat.data[i*mat.step])[j*3 + 2] = 1;//R</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="é€šè¿‡ptræ¥å£éå†Mat-æ¨¡æ¿å‡½æ•°"><a href="#é€šè¿‡ptræ¥å£éå†Mat-æ¨¡æ¿å‡½æ•°" class="headerlink" title="é€šè¿‡ptræ¥å£éå†Mat(æ¨¡æ¿å‡½æ•°)"></a>é€šè¿‡ptræ¥å£éå†Mat(æ¨¡æ¿å‡½æ•°)</h4><ul>
<li>æ€§èƒ½åŸºæœ¬ç­‰åŒä¸åœ°å€è®¿é—®</li>
<li>mat.ptr<vec3b>(row);//è¿”å›çš„æŒ‡é’ˆ</vec3b></li>
<li>mat.ptr<vec3b>(row, col);</vec3b></li>
</ul>
<h4 id="é€šè¿‡atæ¥å£éå†Mat-æ¨¡æ¿å‡½æ•°"><a href="#é€šè¿‡atæ¥å£éå†Mat-æ¨¡æ¿å‡½æ•°" class="headerlink" title="é€šè¿‡atæ¥å£éå†Mat(æ¨¡æ¿å‡½æ•°)"></a>é€šè¿‡atæ¥å£éå†Mat(æ¨¡æ¿å‡½æ•°)</h4><ul>
<li>æ¥å£æœ€ç®€å•çš„éå†æ–¹æ³•<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mat.at&lt;Vec3b&gt;(row, col)[0] = 255;</div><div class="line">mat.at&lt;Vec3b&gt;(row, col)[1] = 0;</div><div class="line">mat.at&lt;Vec3b&gt;(row, col)[2] = 0;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>atå¯ä»¥ä½¿ç”¨try{} catch(â€¦/cv::Exception &amp;ex){}æ•è·å¼‚å¸¸</p>
<h4 id="é€šè¿‡è¿­ä»£å™¨éå†Mat"><a href="#é€šè¿‡è¿­ä»£å™¨éå†Mat" class="headerlink" title="é€šè¿‡è¿­ä»£å™¨éå†Mat"></a>é€šè¿‡è¿­ä»£å™¨éå†Mat</h4><ul>
<li>å¯ä»¥ä¸ç”¨ç®¡matçš„è¡Œåˆ—
auto it = mr.begin<vec3b>();
auto it_end = mr.end<vec3b>();</vec3b></vec3b></li>
</ul>
<h3 id="ROIæ„Ÿå…´è¶£åŒºåŸŸ"><a href="#ROIæ„Ÿå…´è¶£åŒºåŸŸ" class="headerlink" title="ROIæ„Ÿå…´è¶£åŒºåŸŸ"></a>ROIæ„Ÿå…´è¶£åŒºåŸŸ</h3><p>cv::Rect rect(100, 100, 300, 300);</p>
<h3 id="åƒç´ æ ¼å¼å’Œç°åº¦å›¾"><a href="#åƒç´ æ ¼å¼å’Œç°åº¦å›¾" class="headerlink" title="åƒç´ æ ¼å¼å’Œç°åº¦å›¾"></a>åƒç´ æ ¼å¼å’Œç°åº¦å›¾</h3><p>RGB, YUV, GRAY</p>
<p>cvtColor(src, img, COLOR_BGR2GRAY);//æºå›¾åƒ,ç›®æ ‡å‡¸æ˜¾,è½¬æ¢æ–¹å¼,åˆ©ç”¨å¤šçº¿ç¨‹ç­‰æ–¹å¼æé«˜æ•ˆç‡</p>
<p>è‡ªå·±å®ç°è½¬æ¢:
Gray = (R<em>30 + G</em>59 + B*11 + 50)/100</p>
<h3 id="äºŒå€¼åŒ–å’Œé˜ˆå€¼"><a href="#äºŒå€¼åŒ–å’Œé˜ˆå€¼" class="headerlink" title="äºŒå€¼åŒ–å’Œé˜ˆå€¼"></a>äºŒå€¼åŒ–å’Œé˜ˆå€¼</h3><ul>
<li>THRESH_BINARY äºŒè¿›åˆ¶é˜ˆå€¼åŒ–</li>
<li>THRESH_BINARY_INV åäºŒè¿›åˆ¶é˜ˆå€¼åŒ–</li>
</ul>
<h3 id="æ”¹å˜å›¾ç‰‡çš„å¯¹æ¯”åº¦å’Œäº®åº¦"><a href="#æ”¹å˜å›¾ç‰‡çš„å¯¹æ¯”åº¦å’Œäº®åº¦" class="headerlink" title="æ”¹å˜å›¾ç‰‡çš„å¯¹æ¯”åº¦å’Œäº®åº¦"></a>æ”¹å˜å›¾ç‰‡çš„å¯¹æ¯”åº¦å’Œäº®åº¦</h3><p>g(i,j) = a*f(i,j) + b
a 1.0~3.0(å¯¹æ¯”) b 0~100(äº®åº¦)
saturate_cast<uchar>é˜²æ­¢ç§»é™¤å‡½æ•°</uchar></p>
<h3 id="å›¾åƒå°ºå¯¸è°ƒæ•´"><a href="#å›¾åƒå°ºå¯¸è°ƒæ•´" class="headerlink" title="å›¾åƒå°ºå¯¸è°ƒæ•´"></a>å›¾åƒå°ºå¯¸è°ƒæ•´</h3><ul>
<li><p>INTER_NEAREST è¿‘é‚»ç®—æ³•(æœ€å¿«)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">int sx, sy = 0;//åŸå›¾å¯¹åº”çš„åæ ‡</div><div class="line">float fy = float(src.rows)/out.rows;</div><div class="line">float fx = float(src.cols)/out.cols;</div><div class="line">for(int y = 0; y&lt; out.rows;y++)&#123;</div><div class="line">  sy = fy*y + 0.5;//+0.5å››èˆäº”å…¥</div><div class="line">  for(int x = 0; x &lt; out.cols;x++)&#123;</div><div class="line">    sx = fx*x + 0.5;</div><div class="line">    out.at&lt;Vec3b&gt;(y,x) = src.at&lt;Vec3b&gt;(sy, sx);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>CV_INTER_LINEAR åŒçº¿ç¨‹å·®å€¼(ç¼ºçœä½¿ç”¨)</p>
</li>
</ul>
<p>æ»¤æ³¢:
è¾“å…¥å›¾åƒä¸­åƒç´ çš„å°é¢†åŸŸæ¥äº§ç”Ÿè¾“å‡ºå›¾åƒçš„æ–¹æ³•,åœ¨ä¿¡å·å¤„ç†ä¸­,è¿™ç§æ–¹æ³•ç§°ä¸ºæ»¤æ³¢(filtering).å…¶ä¸­,æœ€å¸¸ç”¨çš„æ˜¯çº¿æ€§æ»¤æ³¢:è¾“å‡ºåƒç´ æ˜¯è¾“å…¥é¢†åŸŸåƒç´ çš„åŠ æƒå’Œ.</p>
<p>åŒçº¿æ€§å†…æ’å€¼:
æ˜¯ç”±æºå›¾åƒä½ç½®åœ¨å®ƒé™„è¿‘çš„2*2åŒºåŸŸ4ä¸ªé‚»è¿‘åƒç´ çš„å€¼é€šè¿‡åŠ æƒå¹³å‡è®¡ç®—å¾—å‡ºçš„.
ä½é€šæ»¤æ³¢æ€§è´¨,ä½¿é«˜é¢‘åˆ†é‡å—æŸ,å›¾åƒè½®å»“å¯èƒ½ä¼šæœ‰ä¸€ç‚¹æ¨¡ç³Š.</p>
<h3 id="å›¾åƒé‡‘å­—å¡”"><a href="#å›¾åƒé‡‘å­—å¡”" class="headerlink" title="å›¾åƒé‡‘å­—å¡”"></a>å›¾åƒé‡‘å­—å¡”</h3><p>é«˜æ–¯é‡‘å­—å¡”(Gaussian pyramid):ç”¨æ¥å‘ä¸‹é‡‡æ ·</p>
<ul>
<li>è·å–G(i+1)å°†G(i)ä¸é«˜æ–¯å†…æ ¸å·ç§¯</li>
<li>å°†æ‰€æœ‰å¶æ•°è¡Œå’Œåˆ—å»é™¤
-</li>
</ul>
<p>æ‹‰æ™®æ‹‰æ–¯é‡‘å­—å¡”(Laplacian pyramid):ç”¨æ¥ä»é‡‘å­—å¡”åº•å±‚å›¾åƒé‡å»ºä¸Šå±‚æœªé‡‡æ ·å›¾åƒ</p>
<ul>
<li>ç”¨æ¥ä»é‡‘å­—å¡”åº•å±‚å›¾åƒé‡å»ºä¸Šå±‚æœªé‡‡æ ·å›¾åƒ</li>
<li>é¦–å…ˆ,å°†å›¾åƒæ‰©å¤§ä¸¤æ¯,æ–°å¢ä»¥0å¡«å……</li>
<li>é«˜æ–¯å†…æ ¸(ä¹˜ä»¥4)ä¸æ”¾å¤§åçš„å›¾åƒå·ç§¯</li>
</ul>
<h3 id="ä¸¤å¹…å›¾åƒæ··åˆ-blending"><a href="#ä¸¤å¹…å›¾åƒæ··åˆ-blending" class="headerlink" title="ä¸¤å¹…å›¾åƒæ··åˆ(blending)"></a>ä¸¤å¹…å›¾åƒæ··åˆ(blending)</h3><ul>
<li><code>dst = src1*a + src2*(1-a) + gamma</code>//gammaå¢ç›Š</li>
<li>a=[0~1]</li>
<li>ç”»é¢å åŒ–(cross-dissolve)æ•ˆæœ</li>
<li><code>addWeighted(src1, a, src2, 1-a, 0.0, dst);</code>//ä¸¤å¹…å›¾åƒå¤§å°éœ€ä¸€è‡´</li>
</ul>
<h3 id="å›¾åƒæ—‹è½¬å’Œé•œåƒ"><a href="#å›¾åƒæ—‹è½¬å’Œé•œåƒ" class="headerlink" title="å›¾åƒæ—‹è½¬å’Œé•œåƒ"></a>å›¾åƒæ—‹è½¬å’Œé•œåƒ</h3><ul>
<li><p>cv::rotate(src, dst, type);</p>
<ul>
<li>ROTATE_180</li>
<li>ROTATE_90_CLOCKWISE</li>
<li>ROTATE_90_COUNTERCLOCKWISE</li>
</ul>
</li>
<li><p>cv::flip(src,dst, type);//é•œåƒtype 0(x), 1(y), -1</p>
</li>
</ul>
<p>###é€šè¿‡ROIå›¾åƒåˆå¹¶</p>
<h3 id="æ‰“å¼€æ‘„åƒå¤´æ¥å£è¯´æ˜å’Œæºç åˆ†æ"><a href="#æ‰“å¼€æ‘„åƒå¤´æ¥å£è¯´æ˜å’Œæºç åˆ†æ" class="headerlink" title="æ‰“å¼€æ‘„åƒå¤´æ¥å£è¯´æ˜å’Œæºç åˆ†æ"></a>æ‰“å¼€æ‘„åƒå¤´æ¥å£è¯´æ˜å’Œæºç åˆ†æ</h3><ul>
<li>VideoCapture</li>
<li>bool open(int index)</li>
<li>VideoCapture cap(index)</li>
<li>open(int cameraNum, int apiPrefrence)</li>
</ul>
<h3 id="æ‰“å¼€è§†é¢‘æµæ–‡ä»¶"><a href="#æ‰“å¼€è§†é¢‘æµæ–‡ä»¶" class="headerlink" title="æ‰“å¼€è§†é¢‘æµæ–‡ä»¶"></a>æ‰“å¼€è§†é¢‘æµæ–‡ä»¶</h3><ul>
<li>bool open(const String &amp;filename)</li>
<li>VideoCapture cap(const String &amp;file)</li>
<li>bool open(const String &amp;filename, int apiPrefrence)</li>
</ul>
<ul>
<li>å…³é—­å’Œç©ºé—´é‡Šæ”¾</li>
<li>~VideoCapture</li>
<li>release</li>
</ul>
<h3 id="è¯»å–ä¸€å¸§è§†é¢‘"><a href="#è¯»å–ä¸€å¸§è§†é¢‘" class="headerlink" title="è¯»å–ä¸€å¸§è§†é¢‘"></a>è¯»å–ä¸€å¸§è§†é¢‘</h3><p>read(OutputArray image);</p>
<ul>
<li>bool grab() è¯»å–å¹¶è§£ç </li>
<li>virtual bool retrieve(OUtputArray , intflag= 0):å›¾åƒè‰²å½©è½¬æ¢</li>
<li>vc&gt;&gt;mat</li>
</ul>
<h3 id="è·å–è§†é¢‘-ç›¸æœºå±æ€§"><a href="#è·å–è§†é¢‘-ç›¸æœºå±æ€§" class="headerlink" title="è·å–è§†é¢‘,ç›¸æœºå±æ€§"></a>è·å–è§†é¢‘,ç›¸æœºå±æ€§</h3><ul>
<li>CAP_PROP_FPSå¸§ç‡</li>
<li>CAP_PROP_FRAME_COUNT æ€»å¸§æ•°</li>
<li>CAP_PROP_POS_FRAMES æ’­æ”¾å¸§çš„ä½ç½®</li>
<li>CAP_PROP_FRAME_WIDTH HEIGHT</li>
</ul>
<h3 id="VideoWriter"><a href="#VideoWriter" class="headerlink" title="VideoWriter"></a>VideoWriter</h3><ul>
<li><p>open(const String &amp;filename, int fourcc, //VideoWrite::fourcc(â€˜Hâ€™, â€˜2â€™, â€˜6â€™, â€˜4â€™)
double fps, Size frameSize,bool isColor=true)</p>
<p>release</p>
<ul>
<li>void write(const Mat&amp;)</li>
<li>cvVideoWriter_FFMPEG::writeFrame</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/29/opencv-env/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/29/opencv-env/" itemprop="url">
                  opencvå¼€å‘ç¯å¢ƒæ­å»º
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-29T17:50:52+08:00">
                2017-09-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/opencv/" itemprop="url" rel="index">
                    <span itemprop="name">opencv</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä»githubä¸‹è½½opencvæœ€æ–°æºç <a href="https://github.com/opencv/opencv,ç›®å‰æœ€æ–°æ˜¯`5e93c8202363a13fc72df30f8c14069c5ab66e42`" target="_blank" rel="external">https://github.com/opencv/opencv,ç›®å‰æœ€æ–°æ˜¯`5e93c8202363a13fc72df30f8c14069c5ab66e42`</a>.</p>
<h3 id="Ubuntuç¯å¢ƒä¸‹ç¼–è¯‘"><a href="#Ubuntuç¯å¢ƒä¸‹ç¼–è¯‘" class="headerlink" title="Ubuntuç¯å¢ƒä¸‹ç¼–è¯‘"></a>Ubuntuç¯å¢ƒä¸‹ç¼–è¯‘</h3><p>å®‰è£…ä¾èµ–åº“:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install build-essential</div><div class="line"></div><div class="line">sudo apt-get install cmake git libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev</div><div class="line"></div><div class="line">sudo apt-get install python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev</div><div class="line"></div><div class="line">git clone https://github.com/opencv/opencv.git</div><div class="line"></div><div class="line">sudo apt-get install cmake-gui</div></pre></td></tr></table></figure></p>
<h3 id="Macç¯å¢ƒä¸‹ç¼–è¯‘"><a href="#Macç¯å¢ƒä¸‹ç¼–è¯‘" class="headerlink" title="Macç¯å¢ƒä¸‹ç¼–è¯‘"></a>Macç¯å¢ƒä¸‹ç¼–è¯‘</h3><p>è¿›å…¥æºç è·¯å¾„,æ–°å»ºä¸€ä¸ªreleaseçš„æ–‡ä»¶å¤¹,å¹¶è¿›å…¥,æ‰§è¡Œ:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cmake -G &quot;Unix Makefiles&quot; ..</div><div class="line">make</div><div class="line">sudo make install</div></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘å®Œæˆåä¼šåœ¨releaseç”Ÿæˆlibç›®å½•,libä¸‹å­˜æ”¾æ‰€æœ‰ç¼–è¯‘æˆçš„åŠ¨æ€åº“,å¯èƒ½ä¸ubuntuä¸‹ç¼–è¯‘ç»“æœä¸åŒ,ubuntuä¸‹ç¼–è¯‘åªç”Ÿæˆ<code>libopencv_world.so</code>ä¸€ä¸ªåŠ¨æ€åº“,è€Œmacä¸‹ä¼šç”Ÿæˆ<code>opencv_core opencv_highgui opencv_imgproc opencv_ml opencv_objdetect opencv_photo opencv_video opencv_dnn opencv_imgcodecs opencv_shape</code>ç­‰å¤šä¸ªåŠ¨æ€åº“.æ‰§è¡Œ<code>make install</code>åä¼šå°†å¤´æ–‡ä»¶æ‹·è´åˆ°<code>/usr/local/include/</code>ä¸‹,å°†åŠ¨æ€åº“æ‹·è´åˆ°<code>/usr/local/lib/</code>ä¸‹,å°†jaråŒ…ç­‰å…¶ä»–æ–‡ä»¶æ‹·è´åˆ°<code>/usr/local/share/OpenCV/</code>ä¸‹,makefileè„šæœ¬åŠ å…¥åŠ¨æ€é“¾æ¥åº“:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">testopencv:main.cpp</div><div class="line">	g++ $+ -o $@ -lopencv_core -lopencv_highgui -lopencv_imgproc -lopencv_ml -lopencv_objdetect -lopencv_photo -lopencv_video -lopencv_dnn -lopencv_imgcodecs -lopencv_shape</div></pre></td></tr></table></figure></p>
<p><code>main.cpp</code>ä¸‹è¾“å…¥ä¸‹é¢æµ‹è¯•ä»£ç :
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#include &lt;opencv2/core.hpp&gt;</div><div class="line">#include &lt;opencv2/imgcodecs.hpp&gt;</div><div class="line">#include &lt;opencv2/highgui.hpp&gt;</div><div class="line">using namespace cv;</div><div class="line">int main(int argc, char *argv[])</div><div class="line">&#123;</div><div class="line">	Mat image = imread(&quot;1.png&quot;);</div><div class="line">	namedWindow(&quot;img&quot;);</div><div class="line">	imshow(&quot;img&quot;, image);</div><div class="line">	waitKey(0);</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨ç”Ÿæˆçš„æ‰§è¡Œæ–‡ä»¶åŒç›®å½•ä¸‹æ”¾å…¥åå­—ä¸º<code>1.png</code>çš„å›¾ç‰‡.</p>
<h4 id="é…ç½®QTç¯å¢ƒ"><a href="#é…ç½®QTç¯å¢ƒ" class="headerlink" title="é…ç½®QTç¯å¢ƒ"></a>é…ç½®QTç¯å¢ƒ</h4><p>åœ¨æ–°å»ºçš„QTå·¥ç¨‹ä¸­çš„.proæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ä»£ç :
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">INCLUDEPATH += /usr/local/include</div><div class="line">INCLUDEPATH += /usr/local/include/opencv</div><div class="line">INCLUDEPATH += /usr/local/include/opencv2</div><div class="line">LIBS += -L/usr/local/lib \</div><div class="line"> -lopencv_core \</div><div class="line"> -lopencv_highgui \</div><div class="line"> -lopencv_imgproc \</div></pre></td></tr></table></figure></p>
<p>å®Œæˆä»¥ä¸Šæ­¥éª¤åæŒ‰ç†åº”è¯¥æ˜¯èƒ½æˆåŠŸçš„ï¼Œä½†æ˜¯è¿è¡Œæ—¶å‘ç°ä¼šå‡ºç°å¦‚ä¸‹çš„é”™è¯¯ã€‚
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dyld: Symbol not found: __cg_jpeg_resync_to_restart</div><div class="line">Referenced from: /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO</div><div class="line">Expected in: /usr/local/lib/libjpeg.8.dylib</div><div class="line">in /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO</div></pre></td></tr></table></figure></p>
<p>é’ˆå¯¹ä»¥ä¸Šé—®é¢˜,åœ¨é¡¹ç›®-è¿è¡Œé…ç½®ä¸­,å¢åŠ å˜é‡<code>DYLD_LIBRARY_PATH</code>å€¼ä¸º<code>/Application/QT5.7.0/5.7/clang_64/lib:/usr/local/lib</code></p>
<h3 id="qt-opencvå¸¸è§é—®é¢˜"><a href="#qt-opencvå¸¸è§é—®é¢˜" class="headerlink" title="qt+opencvå¸¸è§é—®é¢˜"></a>qt+opencvå¸¸è§é—®é¢˜</h3><p>åœ¨Macä¸Šè¿è¡Œä»¥ä¸Šä»£ç æ—¶ï¼Œæç¤ºä»¥ä¸‹é”™è¯¯ï¼š
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dyld: Symbol not found: __cg_jpeg_resync_to_restart</div><div class="line">  Referenced from: /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO</div><div class="line">  Expected in: /usr/local/lib/libJPEG.dylib</div><div class="line"> in /System/Library/Frameworks/ImageIO.framework/Versions/A/ImageIO</div></pre></td></tr></table></figure></p>
<p>è§£å†³åŠæ³•æ˜¯å°†â€œâ€ç›®å½•ä¸‹çš„å¯¹åº”åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶åˆ›å»ºè½¯è¿æ¥åˆ°â€œ/usr/local/libâ€ç›®å½•ä¸‹ï¼š
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ pwd</div><div class="line">/System/Library/Frameworks/ImageIO.framework/Versions/A/Resources</div><div class="line">$ sudo ln -sf libJPEG.dylib /usr/local/lib/libJPEG.dylib</div><div class="line">$ sudo ln -sf libPng.dylib /usr/local/lib/libPng.dylib</div><div class="line">$ sudo ln -sf libTIFF.dylib /usr/local/lib/libTIFF.dylib</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/27/tips-android/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/27/tips-android/" itemprop="url">
                  tips-android
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-27T10:41:33+08:00">
                2017-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h6 id="1-ä½¿ç”¨Glideåº“æå–è§†é¢‘å¸§"><a href="#1-ä½¿ç”¨Glideåº“æå–è§†é¢‘å¸§" class="headerlink" title="1.ä½¿ç”¨Glideåº“æå–è§†é¢‘å¸§"></a>1.ä½¿ç”¨Glideåº“æå–è§†é¢‘å¸§</h6><p>å›¾ç‰‡åŠ è½½æ¡†æ¶Glideå°±å¯ä»¥åšåˆ°è·å–æœ¬åœ°è§†é¢‘çš„ç¼©ç•¥å›¾(ä¸èƒ½è·å–ç½‘ç»œè§†é¢‘æ–‡ä»¶):
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">String filePath = &quot;/storage/emulated/0/Pictures/example_video.mp4&quot;;</div><div class="line">Glide  </div><div class="line">    .with( context )</div><div class="line">    .load( Uri.fromFile( new File( filePath ) ) )</div><div class="line">    .into( imageViewGifAsBitmap );</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/13/tips-qt-audiooutput/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/13/tips-qt-audiooutput/" itemprop="url">
                  å…³äºQT QAudioOutput pushæ¨¡å¼é—®é¢˜
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-13T11:52:14+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/QT/" itemprop="url" rel="index">
                    <span itemprop="name">QT</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>åœ¨MACä¸ŠåŸºäºQTå’Œffmpegå®ç°æœ€ç®€å•æ’­æ”¾å™¨,åœ¨å®Œæˆå£°éŸ³æ’­æ”¾æ¨¡å—åå¯¼è‡´æ— æ³•æ­£å¸¸æ’­æ”¾,QAudioOutput startåstateä»æ˜¯idel,å°†QAudioOutput bufferå†™æ»¡åå°±ä¸èƒ½ç»§ç»­å†™æ•°æ®äº†,å¯¼è‡´æ’­æ”¾è¢«å¡æ­».</p>
<p>QAudioOutputåˆ›å»ºä»£ç :
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">QAudioFormat fmt;</div><div class="line">fmt.setSampleRate(this-&gt;sampleRate);</div><div class="line">fmt.setSampleSize(this-&gt;sampleSize);</div><div class="line">fmt.setChannelCount(this-&gt;channel);</div><div class="line">fmt.setCodec(&quot;audio/pcm&quot;);</div><div class="line">fmt.setByteOrder(QAudioFormat::LittleEndian);</div><div class="line">fmt.setSampleType(QAudioFormat::UnSignedInt);</div><div class="line">QAudioDeviceInfo info = QAudioDeviceInfo::defaultOutputDevice();</div><div class="line">printf(&quot;deviceName:%s\n&quot;,qPrintable(info.deviceName()));</div><div class="line">if (!info.isFormatSupported(fmt)) &#123;</div><div class="line">    printf(&quot;default format not supported try to use nearest\n&quot;);</div><div class="line">    fmt = info.nearestFormat(fmt);</div><div class="line">&#125;</div><div class="line">output = new QAudioOutput(fmt);</div><div class="line">//connect(output, SIGNAL(stateChanged(QAudio::State)), this, SLOT(handleStateChanged(QAudio::State)));</div><div class="line">io = output-&gt;start();</div><div class="line">printf(&quot;io:%p\n&quot;, io);</div><div class="line">//printf(&quot;state:%s&quot;,output-&gt;state());</div><div class="line">QAudio::State stat = output-&gt;state();</div></pre></td></tr></table></figure></p>
<p>åœ¨stackoverflow <a href="https://stackoverflow.com/questions/15651407/qt-qaudiooutput-push-mode" target="_blank" rel="external">Qt QAudioOutput push mode</a>çœ‹åˆ°åˆ«äººçš„é—®é¢˜å’Œè§£é‡Š,å‘ç°æ˜¯setSampleTypeå¼•èµ·çš„,ä»£ç åœ¨windowä¸Šå¯ä»¥æ­£å¸¸è·‘,åªæ˜¯åœ¨macä¸Šå¤±è´¥.</p>
<h5 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h5><p>Iâ€™ve got a question about using QAudioOutput to directly write samples at a specific sample rate to the sound output device. Iâ€™m writing an emulator that emualates sound chips on a per-frame basis, and then gets a buffer containing a frameâ€™s worth of audio samples, which I would like to write to the audio output. Currently, to test my audio output routine, I allocate a huge (5 minute) buffer to put random numbers into, like so:</p>
<p>Header:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">uint16_t *audio_outputBuffer;</div><div class="line">uint32_t audio_bytesRemainingToRead;</div><div class="line">QAudioOutput *audio_outputStream;</div><div class="line">QIODevice *audio_outputDevice;</div></pre></td></tr></table></figure></p>
<p>Implementation:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">audio_outputBuffer = (uint16_t *) malloc((96000 * 4) * 300);</div><div class="line">int i = 0;</div><div class="line"></div><div class="line">uint16_t *tempAudioBuffer = audio_outputBuffer;</div><div class="line">for(i = 0; i &lt; ((96000 * 4) * 150); i++) &#123;</div><div class="line">    *tempAudioBuffer = (uint16_t) rand() &amp; 0xFFFF;</div><div class="line">    tempAudioBuffer++;</div><div class="line">&#125;</div><div class="line"></div><div class="line">audio_bytesRemainingToRead = (96000 * 4) * 300;</div></pre></td></tr></table></figure></p>
<p>Next, I set up my audio device with some basic parameters:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// Set up the format</div><div class="line">QAudioFormat format;</div><div class="line">format.setFrequency(96000); // Usually this is specified through an UI option</div><div class="line">format.setChannels(2);</div><div class="line">format.setSampleSize(16);</div><div class="line">format.setCodec(&quot;audio/pcm&quot;);</div><div class="line">format.setByteOrder(QAudioFormat::LittleEndian);</div><div class="line">format.setSampleType(QAudioFormat::UnSignedInt);</div><div class="line"></div><div class="line">// There&apos;s code here to notify the user of inability to match the format and choose an action, which is omitted for clarity</div><div class="line"></div><div class="line">// Create audio output stream, set up signals</div><div class="line">audio_outputStream = new QAudioOutput(format, this);</div><div class="line"></div><div class="line">connect(audio_outputStream, SIGNAL(stateChanged(QAudio::State)), this, SLOT(audio_stateChanged(QAudio::State)));</div><div class="line"></div><div class="line">audio_outputDevice = audio_outputStream-&gt;start();</div></pre></td></tr></table></figure></p>
<p>Then, in my timer tick routine, which is called by a QTimer at 60 FPS, I do the following code to write a â€˜chunkâ€™ of audio data to the QAudioOutputâ€™s buffer:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">if(audio_outputDevice-&gt;isOpen() &amp;&amp; audio_outputStream-&gt;state() != QAudio::StoppedState) &#123;</div><div class="line">    qint64 bytesOfAudioWrittenToDevice = audio_outputDevice-&gt;write((char *) audio_outputBuffer, audio_outputStream-&gt;periodSize());</div><div class="line">    audio_bytesRemainingToRead -= bytesOfAudioWrittenToDevice;</div><div class="line">    qDebug() &lt;&lt; &quot;Wrote&quot; &lt;&lt; bytesOfAudioWrittenToDevice &lt;&lt; &quot;bytes of audio to output device. Remaining bytes to read:&quot; &lt;&lt; audio_bytesRemainingToRead;</div><div class="line">    qDebug() &lt;&lt; &quot;Free bytes in audio output:&quot; &lt;&lt; audio_outputStream-&gt;bytesFree();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Once I start the audio output process, I get the following output on the console:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Current audio state: 3 Error: 0</div><div class="line">Wrote 2048 bytes of audio to output device. Remaining bytes to read: 115197952</div><div class="line">Free bytes in audio output: 6144</div><div class="line">Current audio state: 0 Error: 0</div><div class="line">Wrote 2048 bytes of audio to output device. Remaining bytes to read: 115195904</div><div class="line">Free bytes in audio output: 4096</div><div class="line">Wrote 2048 bytes of audio to output device. Remaining bytes to read: 115193856</div><div class="line">Free bytes in audio output: 2048</div><div class="line">Wrote 2048 bytes of audio to output device. Remaining bytes to read: 115191808</div><div class="line">Free bytes in audio output: 0 (This and the above line is repeated forever)</div></pre></td></tr></table></figure></p>
<p>To me, it looks like QAudioOutput isnâ€™t flushing itâ€™s internal buffer to the sound card, which goes along with the entire â€œno sound coming out of my computerâ€ thing.</p>
<p>What would cause this issue, and how could I fix it?</p>
<p>(By the way, Iâ€™m compiling my code against Qt 4.8.1, on Mac OS X 10.7.4.)</p>
<p>Thanks for any answers.</p>
<h5 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h5><p>Upfront just wanna point out: This is not a Qt bug. Why? The answer is that in the WAV specâ€™, 8-bit samples are always unsigned, whereas 16-bit samples are always signed. Any other combination does not work. This is device related, the framework can not do anything about it.</p>
<p>So this will not work because you have set 16 bit sample size and unsigned integer format. And yes, the solution is: you have to set the sample type to signed for 16-bit resolution:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">format.setSampleType(QAudioFormat::SignedInt);</div></pre></td></tr></table></figure></p>
<p>Inversely for 8-bit samples you would have to put:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">format.setSampleType(QAudioFormat:UnsignedInt);</div></pre></td></tr></table></figure></p>
<p>Also this very similar question (same problem but with 8-bit) shows you that it is not a particular problem of using signed or unsigned samples in Qt, but that it is the combination of samples size and type that matters (for the audio device, not for Qt ;) QAudioOutput in Qt5 is not producing any sound</p>
<p>IMHO the fact that Qt does not take care of handling these cases by forcing the correct format is a flaw but not a lack in functionnality.</p>
<p>You can learn more about this in the notes section of this page: <a href="https://ccrma.stanford.edu/courses/422/projects/WaveFormat/" target="_blank" rel="external">https://ccrma.stanford.edu/courses/422/projects/WaveFormat/</a></p>
<p>Iâ€™ve figured this out â€” apparently Qt has issues with UNSIGNED samples. If you set the sample type to signed, everything works fine, regardless of platform.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/13/ffmpeg-arch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/13/ffmpeg-arch/" itemprop="url">
                  FFMPEG apiä½¿ç”¨æµç¨‹
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-13T10:04:15+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/FFMPEG/" itemprop="url" rel="index">
                    <span itemprop="name">FFMPEG</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ffmpegæ¥å£ä½¿ç”¨æµç¨‹æ¯”è¾ƒå›ºå®š:</p>
<ol>
<li><code>av_register_all()</code>:æ³¨å†Œæ‰€æœ‰æ¨¡å—</li>
<li><code>int ret = avformat_open_input(&amp;ic, ofn, 0, 0);</code>:è·å–AVFormatContext ic(ofnä¸ºè¾“å…¥æ–‡ä»¶åœ°å€)</li>
<li><code>for(i = 0; i &lt; ic-&gt;nb_streams; i++)</code>:éå†AVFormatContextä¸­æ‰€æœ‰stream,åˆ†åˆ«æ‰¾åˆ°Audioä¸Videoå¯¹åº”çš„AVCodecContext;</li>
<li><code>AVCodec *codec = avcodec_find_decoder(enc-&gt;codec_id);</code>:æ ¹æ®AVCodecContextä¸­codec_idè·å–åˆ°AVCodec;</li>
<li><code>avcodec_open2(enc, codec,NULL)</code>:æ‰“å¼€AVCodec;</li>
<li>æ¥ä¸‹æ¥åˆ†é…AVPacketä¸AVFrame</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/13/ffmpeg-codec/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/13/ffmpeg-codec/" itemprop="url">
                  FFMPEGç¼–è§£ç 
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-13T10:03:37+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/FFMPEG/" itemprop="url" rel="index">
                    <span itemprop="name">FFMPEG</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="è§£ç "><a href="#è§£ç " class="headerlink" title="è§£ç "></a>è§£ç </h3><p>ffmpeg3ç‰ˆæœ¬çš„è§£ç æ¥å£åšäº†è°ƒæ•´,ä¹‹å‰çš„è§†é¢‘è§£ç æ¥å£<code>avcodec_decode_video2</code>å’ŒéŸ³é¢‘è§£ç æ¥å£<code>avcodec_decode_audio4</code>è¢«è®¾ç½®ä¸ºdeprecated,å¯¹è¿™ä¸¤ä¸ªæ¥å£åšäº†åˆå¹¶,ä½¿ç”¨åŒä¸€çš„æ¥å£.å¹¶ä¸”å°†éŸ³è§†é¢‘è§£ç æ­¥éª¤åˆ†æˆäº†ä¸¤æ­¥,ç¬¬ä¸€æ­¥<code>avcodec_send_packet</code>,ç¬¬äºŒæ­¥<code>avcodec_receive_frame</code>,</p>
<h4 id="æ—§ç‰ˆæœ¬avcodec-decode-video2"><a href="#æ—§ç‰ˆæœ¬avcodec-decode-video2" class="headerlink" title="æ—§ç‰ˆæœ¬avcodec_decode_video2"></a>æ—§ç‰ˆæœ¬<code>avcodec_decode_video2</code></h4><h4 id="æ—§ç‰ˆæœ¬avcodec-decode-audio4"><a href="#æ—§ç‰ˆæœ¬avcodec-decode-audio4" class="headerlink" title="æ—§ç‰ˆæœ¬avcodec_decode_audio4"></a>æ—§ç‰ˆæœ¬<code>avcodec_decode_audio4</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">int got_picture;</div><div class="line">            ret = avcodec_decode_audio4(enc, pcm,&amp;got_picture, pkt);</div><div class="line">            if ( ret &lt; 0 ) &#123;</div><div class="line">                char buf[1024] = &#123;0&#125;;</div><div class="line">                av_strerror(err, buf, sizeof(buf));</div><div class="line">                printf(buf);</div><div class="line">                printf(&quot;avcodec_decode_audio4 failed:%d&quot; ,got_picture);</div><div class="line">                av_packet_unref(pkt);</div><div class="line">                av_frame_free(&amp;pcm);</div><div class="line">                if(ic) avformat_close_input(&amp;ic);</div><div class="line">                return -1;</div><div class="line">            &#125;</div></pre></td></tr></table></figure>
<p>å°†AVPacketçš„pktè§£ç æˆAVFrameçš„pcm</p>
<h4 id="æ–°ç‰ˆæœ¬avcodec-send-packet"><a href="#æ–°ç‰ˆæœ¬avcodec-send-packet" class="headerlink" title="æ–°ç‰ˆæœ¬avcodec_send_packet"></a>æ–°ç‰ˆæœ¬<code>avcodec_send_packet</code></h4><h5 id="æ¥å£æºç "><a href="#æ¥å£æºç " class="headerlink" title="æ¥å£æºç :"></a>æ¥å£æºç :</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Supply raw packet data as input to a decoder.</div><div class="line"> *</div><div class="line"> * Internally, this call will copy relevant AVCodecContext fields, which can</div><div class="line"> * influence decoding per-packet, and apply them when the packet is actually</div><div class="line"> * decoded. (For example AVCodecContext.skip_frame, which might direct the</div><div class="line"> * decoder to drop the frame contained by the packet sent with this function.)</div><div class="line"> *</div><div class="line"> * @warning The input buffer, avpkt-&gt;data must be AV_INPUT_BUFFER_PADDING_SIZE</div><div class="line"> *          larger than the actual read bytes because some optimized bitstream</div><div class="line"> *          readers read 32 or 64 bits at once and could read over the end.</div><div class="line"> *</div><div class="line"> * @warning Do not mix this API with the legacy API (like avcodec_decode_video2())</div><div class="line"> *          on the same AVCodecContext. It will return unexpected results now</div><div class="line"> *          or in future libavcodec versions.</div><div class="line"> *</div><div class="line"> * @note The AVCodecContext MUST have been opened with @ref avcodec_open2()</div><div class="line"> *       before packets may be fed to the decoder.</div><div class="line"> *</div><div class="line"> * @param avctx codec context</div><div class="line"> * @param[in] avpkt The input AVPacket. Usually, this will be a single video</div><div class="line"> *                  frame, or several complete audio frames.</div><div class="line"> *                  Ownership of the packet remains with the caller, and the</div><div class="line"> *                  decoder will not write to the packet. The decoder may create</div><div class="line"> *                  a reference to the packet data (or copy it if the packet is</div><div class="line"> *                  not reference-counted).</div><div class="line"> *                  Unlike with older APIs, the packet is always fully consumed,</div><div class="line"> *                  and if it contains multiple frames (e.g. some audio codecs),</div><div class="line"> *                  will require you to call avcodec_receive_frame() multiple</div><div class="line"> *                  times afterwards before you can send a new packet.</div><div class="line"> *                  It can be NULL (or an AVPacket with data set to NULL and</div><div class="line"> *                  size set to 0); in this case, it is considered a flush</div><div class="line"> *                  packet, which signals the end of the stream. Sending the</div><div class="line"> *                  first flush packet will return success. Subsequent ones are</div><div class="line"> *                  unnecessary and will return AVERROR_EOF. If the decoder</div><div class="line"> *                  still has frames buffered, it will return them after sending</div><div class="line"> *                  a flush packet.</div><div class="line"> *</div><div class="line"> * @return 0 on success, otherwise negative error code:</div><div class="line"> *      AVERROR(EAGAIN):   input is not accepted right now - the packet must be</div><div class="line"> *                         resent after trying to read output</div><div class="line"> *      AVERROR_EOF:       the decoder has been flushed, and no new packets can</div><div class="line"> *                         be sent to it (also returned if more than 1 flush</div><div class="line"> *                         packet is sent)</div><div class="line"> *      AVERROR(EINVAL):   codec not opened, it is an encoder, or requires flush</div><div class="line"> *      AVERROR(ENOMEM):   failed to add packet to internal queue, or similar</div><div class="line"> *      other errors: legitimate decoding errors</div><div class="line"> */</div><div class="line">int avcodec_send_packet(AVCodecContext *avctx, const AVPacket *avpkt);</div></pre></td></tr></table></figure>
<h5 id="å‚æ•°åˆ†æ"><a href="#å‚æ•°åˆ†æ" class="headerlink" title="å‚æ•°åˆ†æ"></a>å‚æ•°åˆ†æ</h5><ul>
<li><code>AVCodecContext *avctx</code>ï¼šç¬¬ä¸€ä¸ªå‚æ•°ä¸æ—§çš„æ¥å£ä¸€è‡´ï¼Œæ˜¯è§†é¢‘è§£ç çš„ä¸Šä¸‹æ–‡ï¼ŒåŒ…å«è§£ç å™¨ã€‚</li>
<li><code>const AVPacket *avpkt</code>ï¼š ç¼–ç çš„éŸ³è§†é¢‘å¸§æ•°æ®</li>
</ul>
<p>ä¸ºä»€ä¹ˆè¦ä¼ é€’ç©ºçš„avpkt
è¿™é‡Œæœ‰ä¸€ä¸ªè¯´æ˜æ˜¯å¯ä»¥ä¼ é€’NULLï¼Œä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ä¼ é€’NULLï¼Œä½ å¹³æ—¶çœ‹ä¸€äº›è§†é¢‘æ’­æ”¾å™¨ï¼Œæ’­æ”¾ç»å¸¸ä¼šå°‘æœ€åå‡ å¸§ï¼Œå¾ˆå¤šæƒ…å†µå°±æ˜¯å› ä¸ºæ²¡æœ‰å¤„ç†å¥½ç¼“å†²å¸§çš„é—®é¢˜ï¼Œffmpegå†…éƒ¨ä¼šç¼“å†²å‡ å¸§ï¼Œè¦æƒ³å–å‡ºæ¥å°±éœ€è¦ä¼ é€’ç©ºçš„AVPacketè¿›å»ã€‚</p>
<h4 id="æ–°ç‰ˆæœ¬avcodec-receive-frame"><a href="#æ–°ç‰ˆæœ¬avcodec-receive-frame" class="headerlink" title="æ–°ç‰ˆæœ¬avcodec_receive_frame"></a>æ–°ç‰ˆæœ¬<code>avcodec_receive_frame</code></h4><h5 id="æ¥å£æºç -1"><a href="#æ¥å£æºç -1" class="headerlink" title="æ¥å£æºç "></a>æ¥å£æºç </h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Return decoded output data from a decoder.</div><div class="line"> *</div><div class="line"> * @param avctx codec context</div><div class="line"> * @param frame This will be set to a reference-counted video or audio</div><div class="line"> *              frame (depending on the decoder type) allocated by the</div><div class="line"> *              decoder. Note that the function will always call</div><div class="line"> *              av_frame_unref(frame) before doing anything else.</div><div class="line"> *</div><div class="line"> * @return</div><div class="line"> *      0:                 success, a frame was returned</div><div class="line"> *      AVERROR(EAGAIN):   output is not available right now - user must try</div><div class="line"> *                         to send new input</div><div class="line"> *      AVERROR_EOF:       the decoder has been fully flushed, and there will be</div><div class="line"> *                         no more output frames</div><div class="line"> *      AVERROR(EINVAL):   codec not opened, or it is an encoder</div><div class="line"> *      other negative values: legitimate decoding errors</div><div class="line"> */</div><div class="line">int avcodec_receive_frame(AVCodecContext *avctx, AVFrame *frame);</div></pre></td></tr></table></figure>
<h5 id="å‚æ•°åˆ†æ-1"><a href="#å‚æ•°åˆ†æ-1" class="headerlink" title="å‚æ•°åˆ†æ"></a>å‚æ•°åˆ†æ</h5><ul>
<li><code>AVCodecContext *avctx</code>ï¼šç¬¬ä¸€ä¸ªå‚æ•°è§†é¢‘è§£ç çš„ä¸Šä¸‹æ–‡ï¼Œä¸ä¸Šé¢æ¥å£ä¸€è‡´ã€‚</li>
<li><code>AVFrame *frame</code>ï¼šè§£ç åçš„è§†é¢‘å¸§æ•°æ®ã€‚</li>
</ul>
<h5 id="ç©ºé—´ç”³è¯·å’Œé‡Šæ”¾é—®é¢˜"><a href="#ç©ºé—´ç”³è¯·å’Œé‡Šæ”¾é—®é¢˜" class="headerlink" title="ç©ºé—´ç”³è¯·å’Œé‡Šæ”¾é—®é¢˜"></a>ç©ºé—´ç”³è¯·å’Œé‡Šæ”¾é—®é¢˜</h5><p>è§£ç åå›¾åƒç©ºé—´ç”±å‡½æ•°å†…éƒ¨ç”³è¯·ï¼Œä½ æ‰€åšçš„åªéœ€è¦åˆ†é… AVFrame å¯¹è±¡ç©ºé—´ï¼Œå¦‚æœä½ æ¯æ¬¡è°ƒç”¨avcodec_receive_frameä¼ é€’åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ¥å£å†…éƒ¨ä¼šåˆ¤æ–­ç©ºé—´æ˜¯å¦å·²ç»åˆ†é…ï¼Œå¦‚æœæ²¡æœ‰åˆ†é…ä¼šåœ¨å‡½æ•°å†…éƒ¨åˆ†é…ã€‚
avcodec_send_packetå’Œavcodec_receive_frameè°ƒç”¨å…³ç³»å¹¶ä¸ä¸€å®šæ˜¯ä¸€å¯¹ä¸€çš„ï¼Œæ¯”å¦‚ä¸€äº›éŸ³é¢‘æ•°æ®ä¸€ä¸ªAVPacketä¸­åŒ…å«äº†1ç§’é’Ÿçš„éŸ³é¢‘ï¼Œè°ƒç”¨ä¸€æ¬¡avcodec_send_packetä¹‹åï¼Œå¯èƒ½éœ€è¦è°ƒç”¨25æ¬¡ avcodec_receive_frameæ‰èƒ½è·å–å…¨éƒ¨çš„è§£ç éŸ³é¢‘æ•°æ®ï¼Œæ‰€ä»¥è¦åšå¦‚ä¸‹å¤„ç†ï¼š
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">int re = avcodec_send_packet(codec, pkt);</div><div class="line">if (re != 0)</div><div class="line">&#123;</div><div class="line">    return;</div><div class="line">&#125;</div><div class="line">while( avcodec_receive_frame(codec, frame) == 0)</div><div class="line">&#123;</div><div class="line">    //è¯»å–åˆ°ä¸€å¸§éŸ³é¢‘æˆ–è€…è§†é¢‘</div><div class="line">    //å¤„ç†è§£ç åéŸ³è§†é¢‘ frame</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>å‚è€ƒ
<a href="http://ffmpeg.org/doxygen/trunk/group__lavc__encdec.html" target="_blank" rel="external">send/receive encoding and decoding API overview</a></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/13/ffmpeg-util/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/13/ffmpeg-util/" itemprop="url">
                  FFMPEGå·¥å…·æ–¹æ³•
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-13T10:03:27+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/FFMPEG/" itemprop="url" rel="index">
                    <span itemprop="name">FFMPEG</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="av-strerror"><a href="#av-strerror" class="headerlink" title="av_strerror"></a>av_strerror</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int av_strerror	(	int 	errnum,</div><div class="line">char * 	errbuf,</div><div class="line">size_t 	errbuf_size</div><div class="line">)</div></pre></td></tr></table></figure>
<h4 id="ffmpegè·å–ä¸è®¾ç½®mp4æ–‡ä»¶æ—‹è½¬æ–¹å‘æ–¹æ³•"><a href="#ffmpegè·å–ä¸è®¾ç½®mp4æ–‡ä»¶æ—‹è½¬æ–¹å‘æ–¹æ³•" class="headerlink" title="ffmpegè·å–ä¸è®¾ç½®mp4æ–‡ä»¶æ—‹è½¬æ–¹å‘æ–¹æ³•"></a>ffmpegè·å–ä¸è®¾ç½®mp4æ–‡ä»¶æ—‹è½¬æ–¹å‘æ–¹æ³•</h4><p>è®¾ç½®ä¸è·å–éƒ½æ˜¯å¯¹AVStreamçš„dictæ“ä½œ.
<strong>è®¾ç½®</strong>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">for (i = 0; i &lt; ifmt_ctx_v-&gt;nb_streams; i++) &#123;  </div><div class="line">        //Create output AVStream according to input AVStream  </div><div class="line">        if(ifmt_ctx_v-&gt;streams[i]-&gt;codec-&gt;codec_type==AVMEDIA_TYPE_VIDEO)&#123;  </div><div class="line">            AVStream *in_stream = ifmt_ctx_v-&gt;streams[i];  </div><div class="line">            AVStream *out_stream = avformat_new_stream(ofmt_ctx, in_stream-&gt;codec-&gt;codec);  </div><div class="line">            videoindex_v=i;  </div><div class="line">            if (!out_stream) &#123;  </div><div class="line">                printf( &quot;Failed allocating output stream\n&quot;);  </div><div class="line">                ret = AVERROR_UNKNOWN;  </div><div class="line">                goto end;  </div><div class="line">            &#125;  </div><div class="line">            videoindex_out=out_stream-&gt;index;  </div><div class="line">            //Copy the settings of AVCodecContext  </div><div class="line">            ret = av_dict_set(&amp;out_stream-&gt;metadata,&quot;rotate&quot;,&quot;90&quot;,0); //è®¾ç½®æ—‹è½¬è§’åº¦  </div><div class="line">            if(ret&gt;=0)  </div><div class="line">            &#123;  </div><div class="line">                printf(&quot;=========yes=====set rotate success!===\n&quot;);  </div><div class="line">            &#125;  </div><div class="line"></div><div class="line">            if (avcodec_copy_context(out_stream-&gt;codec, in_stream-&gt;codec) &lt; 0) &#123;  </div><div class="line">                printf( &quot;Failed to copy context from input to output stream codec context\n&quot;);  </div><div class="line">                goto end;  </div><div class="line">            &#125;  </div><div class="line">            out_stream-&gt;codec-&gt;codec_tag = 0;  </div><div class="line">            if (ofmt_ctx-&gt;oformat-&gt;flags &amp; AVFMT_GLOBALHEADER)  </div><div class="line">                out_stream-&gt;codec-&gt;flags |= CODEC_FLAG_GLOBAL_HEADER;  </div><div class="line">            break;  </div><div class="line">        &#125;  </div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<p><strong>è¯»å–</strong>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">for (i = 0; i &lt; ifmt_ctx_v-&gt;nb_streams; i++) &#123;  </div><div class="line">        //Create output AVStream according to input AVStream  </div><div class="line">        if(ifmt_ctx_v-&gt;streams[i]-&gt;codec-&gt;codec_type==AVMEDIA_TYPE_VIDEO)&#123;  </div><div class="line">            AVStream *in_stream = ifmt_ctx_v-&gt;streams[i];  </div><div class="line">            AVStream *out_stream = avformat_new_stream(ofmt_ctx, in_stream-&gt;codec-&gt;codec);  </div><div class="line">            videoindex_v=i;  </div><div class="line">            if (!out_stream) &#123;  </div><div class="line">                printf( &quot;Failed allocating output stream\n&quot;);  </div><div class="line">                ret = AVERROR_UNKNOWN;  </div><div class="line">                goto end;  </div><div class="line">            &#125;  </div><div class="line">            videoindex_out=out_stream-&gt;index;  </div><div class="line">            //Copy the settings of AVCodecContext  </div><div class="line">            ret = av_dict_set(&amp;out_stream-&gt;metadata,&quot;rotate&quot;,&quot;90&quot;,0); //è®¾ç½®æ—‹è½¬è§’åº¦  </div><div class="line">            if(ret&gt;=0)  </div><div class="line">            &#123;  </div><div class="line">                printf(&quot;=========yes=====set rotate success!===\n&quot;);  </div><div class="line">            &#125;  </div><div class="line"></div><div class="line">            if (avcodec_copy_context(out_stream-&gt;codec, in_stream-&gt;codec) &lt; 0) &#123;  </div><div class="line">                printf( &quot;Failed to copy context from input to output stream codec context\n&quot;);  </div><div class="line">                goto end;  </div><div class="line">            &#125;  </div><div class="line">            out_stream-&gt;codec-&gt;codec_tag = 0;  </div><div class="line">            if (ofmt_ctx-&gt;oformat-&gt;flags &amp; AVFMT_GLOBALHEADER)  </div><div class="line">                out_stream-&gt;codec-&gt;flags |= CODEC_FLAG_GLOBAL_HEADER;  </div><div class="line">            break;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line"></div><div class="line"></div><div class="line">double g_rotate_theta = get_rotation(decoder-&gt;is_video);//is_videoæ˜¯videoçš„AVStream</div><div class="line">        int rotate = 0;</div><div class="line">        if (fabs(g_rotate_theta - 90) &lt; 1.0)</div><div class="line">        &#123;</div><div class="line">            rotate = 90;</div><div class="line">        &#125;</div><div class="line">        else if(fabs(g_rotate_theta - 180) &lt; 1.0||fabs(g_rotate_theta + 180) &lt; 1.0)</div><div class="line">        &#123;</div><div class="line">            rotate = 180;</div><div class="line">        &#125;</div><div class="line">        else if(fabs(g_rotate_theta - 270) &lt; 1.0||fabs(g_rotate_theta + 90) &lt; 1.0)</div><div class="line">        &#123;</div><div class="line">            rotate = 270;</div><div class="line">        &#125;</div><div class="line">        LOGI(&quot;get rotate is : %d&quot; , rotate);</div><div class="line">        metadata-&gt;rotate = rotate;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/09/12/tips-media-profile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/12/tips-media-profile/" itemprop="url">
                  éŸ³è§†é¢‘å‚æ•°ä¹‹Profile
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-09-12T12:12:19+08:00">
                2017-09-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/media/" itemprop="url" rel="index">
                    <span itemprop="name">media</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å‰ä¸¤å¤©å‘ç°å…¬å¸äº§å“ <strong>è§¦å‘</strong> æœ‰å¯¼å…¥ä»å¾®ä¿¡ç­‰ä¸‹è½½çš„å¤–éƒ¨å°è§†é¢‘æ—¶å¤±è´¥çš„æƒ…å†µ, <strong>è§¦å‘</strong> å¯¼å…¥è§†é¢‘æ—¶ä½¿ç”¨å¼€æºåº“<a href="https://github.com/INDExOS/media-for-mobile" target="_blank" rel="external">media-for-mobile</a>å¯¹è§†é¢‘è¿›è¡Œé‡æ–°ç¼–ç .media-for-mobileä½¿ç”¨androidç³»ç»Ÿæ¥å£<code>android.media.MediaExtractor</code>å¯¹mp4æ–‡ä»¶è§£å¤ç”¨,ä½¿ç”¨androidç¡¬ä»¶ç¼–è§£ç æ¥å£<code>android.media.MediaCodec</code>å¯¹è§†é¢‘è§£ç -å¤„ç†-ç¼–ç æ“ä½œ,æœ€åé€šè¿‡Androidç³»ç»ŸAPI<code>android.media.MediaMuxer</code>å°†è§†é¢‘å†™æˆæ–‡ä»¶.</p>
<p>åé¦ˆçš„ä¸¤ä¸ªæœ‰é—®é¢˜è§†é¢‘,ä¸€ä¸ªè§†é¢‘å¯¼å…¥æ—¶æŠ¥<code>BufferOverFlowException</code>é”™è¯¯,å¦ä¸€ä¸ªè§†é¢‘ä¸æŠ¥é”™ä½†æ˜¯å¯¼å…¥æ—¶è¿›åº¦ä¸€ç›´ä¸º0%.</p>
<p>ç»åˆ†æå‡ºé—®é¢˜çš„ä¸¤ä¸ªè§†é¢‘çš„Video profileä¸ºHigh,æ™®é€šè§†é¢‘ä¸º<code>Baseline</code>,æŠ¥<code>BufferOverFlowException</code>é”™è¯¯çš„è§†é¢‘çš„Audio profileä¸º<code>HE-AAC</code>,æ™®é€šè§†é¢‘çš„Audio profileä¸º<code>LC</code>.
è¯¦ç»†äº†è§£äº†ä¸€ä¸‹H264 ä¸AAC profile:</p>
<h4 id="H264å„ç§profile"><a href="#H264å„ç§profile" class="headerlink" title="H264å„ç§profile"></a>H264å„ç§profile</h4><p>ä½œä¸ºè¡Œä¸šæ ‡å‡†ï¼ŒH.264ç¼–ç ä½“ç³»å®šä¹‰äº†4ç§ä¸åŒçš„Profile(ç±»)ï¼šBaseline(åŸºçº¿ç±»),Main(ä¸»è¦ç±»), Extended(æ‰©å±•ç±»)å’ŒHigh Profile(é«˜ç«¯ç±»)ï¼ˆå®ƒä»¬å„è‡ªä¸‹åˆ†æˆè®¸å¤šä¸ªå±‚ï¼‰ï¼š</p>
<ol>
<li><code>Baseline Profile</code>: æä¾›I/På¸§ï¼Œä»…æ”¯æŒprogressive(é€è¡Œæ‰«æ)å’ŒCAVLCï¼›</li>
<li><code>Extended Profile</code>: æä¾›I/P/B/SP/SIå¸§ï¼Œä»…æ”¯æŒprogressive(é€è¡Œæ‰«æ)å’ŒCAVLCï¼›</li>
<li><code>Main Profile:</code> æä¾›I/P/Bå¸§ï¼Œæ”¯æŒprogressive(é€è¡Œæ‰«æ)å’Œinterlaced(éš”è¡Œæ‰«æ)ï¼Œæä¾›CAVLCæˆ–CABACï¼›</li>
<li><code>High Profile</code>: ï¼ˆä¹Ÿå°±æ˜¯FRExtï¼‰åœ¨Main ProfileåŸºç¡€ä¸Šæ–°å¢ï¼š8x8 intra prediction(8x8 å¸§å†…é¢„æµ‹), custom quant(è‡ªå®šä¹‰é‡åŒ–), lossless video coding(æ— æŸè§†é¢‘ç¼–ç ), æ›´å¤šçš„yuvæ ¼å¼ï¼ˆ4:4:4â€¦ï¼‰ï¼›</li>
</ol>
<p>H.264åœ¨é«˜æ¸…ä¸­å…·æœ‰æœ€å°ä½“ç§¯ã€‚åœ¨åŒç­‰å›¾åƒè´¨é‡ä¸‹ï¼Œé‡‡ç”¨H.264æŠ€æœ¯å‹ç¼©åçš„æ•°æ®é‡åªæœ‰MPEG2çš„1/8ï¼ŒMPEG4çš„1/3ï¼Œç›¸å¯¹Xvidã€Divxç­‰å±äºMPEG4ç¼–ç è€Œè¨€ï¼Œå…¶ä½“ç§¯ä¼˜åŠ¿æ˜æ˜¾ï¼Œåœ¨äº’è”ç½‘ä¸Šï¼ŒH.264èµ„æºå¤„åœ¨çˆ†å‘è¶‹åŠ¿ã€‚è€ŒHigh Profileæ˜¯H.264è§£ç ä¸­çš„é«˜ç«¯ç±»å‹ï¼Œæ‹¥æœ‰æœ€å®Œå–„çš„æ”¯æŒç¨‹åº¦ã€æœ€ä¼˜ç§€çš„ç‰¹æ€§ï¼Œå¯ä»¥è¯´æ˜¯é«˜æ¸…è§†é¢‘ç¼–ç ä¸­çš„åŠ³æ–¯è±æ–¯ï¼Œåªæœ‰å¾æœäº†è¿™ä¸ªä¼˜ç§€çš„ç¼–ç ï¼ŒMP4æ‰èƒ½å°†H.264å®Œå…¨æŒæ§ï¼Œä¹Ÿæ‰èƒ½å……åˆ†äº«å—åˆ°é«˜æ¸…è§†é¢‘å¸¦æ¥çš„è§†è§‰éœ‡æ’¼ï¼Œæ„ä¹‰éå‡¡ã€‚</p>
<p>é’ˆå¯¹å½“å‰é«˜æ¸…æ˜¯è§†é¢‘ä¼šè®®è¡Œä¸šçš„ä¸»æµå‘å±•è¶‹åŠ¿ï¼Œè€Œç›®å‰é«˜æ¸…æ™®åŠçš„ä¸»è¦é˜»åŠ›ä¹‹ä¸€å°±æ˜¯å¸¦å®½çš„é™åˆ¶ã€‚è€ŒHigh Profile H.264æŠ€æœ¯åœ¨åŒç­‰è§†é¢‘è´¨é‡çš„æƒ…å†µä¸‹å¯èŠ‚çœ50%çš„å¸¦å®½ï¼Œä¸ºå®¢æˆ·èŠ‚çœå¤§é‡çš„ç½‘ç»œå¸¦å®½æˆæœ¬ã€‚æ®ä¸šå†…ä¸“å®¶ä»‹ç»ï¼Œæ­¤æ¬¡H.264 High Profileçš„æ¨å‡ºæ˜¯è§†é¢‘æŠ€æœ¯çš„ä¸€ä¸ªå·¨å¤§è¿›æ­¥ï¼Œå…¶æ„ä¹‰ä¸äºšäº2003å¹´ä»H.263å‘H.264è¿‡æ¸¡çš„ä»·å€¼ã€‚å®ƒå°†ä¸ºç›®å‰æ­£åœ¨æ¨å¹¿çš„é«˜æ¸…è§†é¢‘é€šä¿¡åº”ç”¨æ‰«æ¸…äº†ä»¤äººå¤´ç–¼çš„ç½‘ç»œå¸¦å®½éšœç¢ï¼Œä¸ä»…å¦‚æ­¤ï¼Œè¿™äº›å˜åŒ–å¯¹äºåŒ…æ‹¬CIFã€æ ‡æ¸…ç­‰å“è´¨çš„è§†é¢‘é€šä¿¡åº”ç”¨ä¹ŸåŒæ ·é€‚ç”¨ã€‚</p>
<p>é‰´äºHigh Profile H.264å¯¹äºè§†é¢‘ä¼šè®®è¡Œä¸šçš„éå‡¡å½±å“ï¼Œç›®å‰å·²æœ‰å›½å†…å¤–å‚å•†å°é²œï¼Œå®£å¸ƒå…¶æ——ä¸‹äº§å“å…¨é¢æ”¯æŒè¯¥é¡¹æŠ€æœ¯ï¼ŒåŒ…æ‹¬å®åˆ©é€šã€åå¹³ã€åè…¾ç½‘è®¯ã€‚ä»è¿™ä¸€è¶‹åŠ¿æ¥çœ‹ï¼Œæœªæ¥è§†é¢‘ä¼šè®®äº§å“å…¨é¢æ”¯æŒHigh Profile H.264ä¹Ÿç»æˆä¸ºä¸å¯é€†è½¬çš„æ½®æµï¼Œè€Œé«˜æ¸…æ™®åŠä¹Ÿåœ¨æŠ€æœ¯å±‚é¢æ›´è¿‘äº†ä¸€æ­¥ã€‚</p>
<blockquote>
<p>å‚è€ƒ:
<a href="http://blog.csdn.net/qiaoliang328/article/details/10153313" target="_blank" rel="external">H264 å„ç§profile</a></p>
</blockquote>
<h4 id="AACå„ç§profile"><a href="#AACå„ç§profile" class="headerlink" title="AACå„ç§profile"></a>AACå„ç§profile</h4><h5 id="AACå†å²"><a href="#AACå†å²" class="headerlink" title="AACå†å²"></a>AACå†å²</h5><p>å¦‚æœè¯´ç›®å‰H.264æ˜¯è§†é¢‘CODECçš„å®é™…éœ¸ä¸»ï¼Œé‚£ä¹ˆAACå°±æ˜¯éŸ³é¢‘CODECçš„å¥³ç‹ã€‚ä¸»æµçš„éŸ³è§†é¢‘æ ¼å¼éƒ½æ˜¯H.264æ­é…AACï¼Œæ— è®ºæ˜¯éå®æ—¶çš„åª’ä½“æ–‡ä»¶è¿˜æ˜¯å®æ—¶çš„åª’ä½“æµã€‚
Advanced Audio Coding (AAC) æ˜¯ä¸€ä¸ªæœ‰æŸå‹ç¼©çš„éŸ³é¢‘ç¼–ç é›†ï¼ˆå…¶å®æ–°çš„ç¼–ç å·¥å…·ä¹Ÿæ”¯æŒæ— æŸï¼‰ã€‚å…¶è®¾è®¡ç›®æ ‡æ˜¯æ›¿ä»£åŸæœ‰MP3ç¼–ç æ ‡å‡†ï¼Œåœ¨ä¸MP3åœ¨ç›¸ä¼¼çš„ç ç‡ä¸‹å¸Œæœ›è´¨é‡ä¼˜äºMP3ã€‚è¿™ä¸€ç›®æ ‡å·²è¾¾åˆ°å¹¶ä¸”ç”±ISOå’ŒIECæ ‡å‡†ç»„ç»‡æ ‡å‡†åŒ–åœ¨MPEG-2å’ŒMPEG-4ä¸­ã€‚</p>
<p>AACå·²è¢«å¹¿æ³›æ”¯æŒå¹¶åº”ç”¨åˆ°å„ç§è®¾å¤‡å’Œç³»ç»Ÿä¸­ YouTube, iPhone, iPod, iPad, Nintendo DSi, Nintendo 3DS, iTunes,DivX Plus Web Player and PlayStation 3. It is supported on PlayStation Vita,Wii (with the Photo Channel 1.1 update installed), Sony Walkman MP3 series andlater, Android and BlackBerryç­‰ç­‰ã€‚</p>
<ol>
<li>1997å¹´ï¼ŒAACç¬¬ä¸€æ¬¡å‡ºç°åœ¨æ ‡å‡†MPEG-2 Part 7,ï¼ˆISO/IEC 13818-7:1997ï¼‰ã€‚å’Œè§†é¢‘CODECæ ‡å‡†ç±»ä¼¼ï¼ŒAACåœ¨MPEG-2 Part 7å°±æœ‰ä¸‰ä¸ªprofilesä»–ä»¬åˆ†åˆ«æ˜¯ã€‚<ul>
<li>Low-Complexity profile(AAC-LC / LC-AAC)</li>
<li>Main profile (AAC Main)</li>
<li>Scalable Sampling Rateprofile (AAC-SSR)
ä»æ­¤å¯çŸ¥AAC-LCå‡ºç°æœ€æ—©ï¼Œæ‰€ä»¥AAC-LCçš„åº”ç”¨æœ€å¹¿æ³›ï¼Œå…¼å®¹æ€§æœ€å¥½ã€‚</li>
</ul>
</li>
<li>1999å¹´, AACä»åŸæœ‰æ ‡å‡†å‡çº§å¹¶ä¸”åˆå…¥æ ‡å‡†MPEG-4Part 3ï¼ˆISO/IEC14496-3:1999ï¼‰
è¿™æ¬¡å‡çº§ä¸€ä¸ªé‡è¦å˜åŒ–æ˜¯å¼•å…¥ <strong>Audio Object Types(AOT)</strong> å¹¶ä¸”æŠŠAOTæ¦‚å¿µåˆå¹¶åˆ°profilesä¸­ã€‚è¿™æ—¶profileä¹Ÿå˜æˆ4ä¸ªã€‚<ul>
<li>Main (which includes most of the MPEG-4 Audio Object Types)</li>
<li>Scalable (AAC LC, AAC LTP, CELP, HVXC, TwinVQ, Wavetable Synthesis,TTSI),</li>
<li>Speech (CELP, HVXC, TTSI)</li>
<li>Low Rate Synthesis (Wavetable Synthesis, TTSI)åˆæˆè¯­éŸ³ã€‚</li>
</ul>
</li>
<li>2000å¹´ï¼Œç‰ˆæœ¬æ›´æ–°åˆ°2ï¼ŒMPEG-4 AudioVersion 2 (ISO/IEC 14496-3:1999/Amd 1:2000)ï¼Œæ ‡å‡†å®šä¹‰äº†ä¸€ç§æ–°çš„AOT, ä½æ—¶å»¶AACï¼Œthe low delay AAC(AAC-LD)ã€‚</li>
<li>2001å¹´ï¼Œæ ‡å‡†åŒ–High-Efficiency Advanced Audio Coding (HE-AAC) ISO/IEC 14496-3:2001ã€‚</li>
<li>2003å¹´ï¼Œæ ‡å‡†åŒ–HE-AAC v2 Profile (AAC LC with SBR and Parametric Stereo) ISO/IEC14496-3:2005</li>
<li>ç›®å‰AACçš„æ ‡å‡†åŒ–çš„ç‰ˆæœ¬æ˜¯ ISO/IEC 14496-3:2009ã€‚</li>
</ol>
<p>ä»ä¸Šé¢æ ‡å‡†åŒ–å†å²å¯çŸ¥ï¼ŒAACä¸åœ¨ä¸€å•çº¯çš„ä¸€ä¸ªç¼–ç å™¨äº†ï¼Œè€Œæ˜¯ä¸€ä¸ªåºå¤§çš„éŸ³é¢‘ç¼–ç å·¥å…·é›†åˆã€‚</p>
<h5 id="AOT-Audio-Object-Types"><a href="#AOT-Audio-Object-Types" class="headerlink" title="AOT(Audio Object Types)"></a>AOT(Audio Object Types)</h5><p>AOTå°±æ˜¯MPEG-4 Audio Object Typesçš„ç¼©å†™ã€‚èƒ½åŠ›é›†åå•†æ—¶ç”¨çš„æ˜¯AOT IDã€‚
ä¹Ÿæ­£æ˜¯ç”±äºAACçš„AOTç¹å¤šï¼Œå¯¼è‡´è¯†åˆ«ä½¿ç”¨AACçš„ç”¨æˆ·å¾ˆå›°æ‰°ã€‚
AAC-LC å¯è®¤ä¸ºæ˜¯AOTä¸º2çš„AACã€‚
ä¸‹è¡¨æ˜¯AOTçš„å¯¹åº”è¡¨ã€‚</p>
<table>
<thead>
<tr>
<th>object type ID</th>
<th>Audio Object Type</th>
<th>z</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Null</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>AAC Main</td>
<td>1999</td>
<td>contains AACLC</td>
</tr>
<tr>
<td>2</td>
<td>AAC LC (Low Complexity)</td>
<td>1999</td>
<td>used in the â€œAAC Profileâ€.MPEG-4 AAC LC Audio Object Type is based on the MPEG-2 Part7 Low Complexity profile(LC)combined with Perceptual Noise Subsitution(PNS)(define in MPEG-4 part 3 Subpart 4)</td>
</tr>
<tr>
<td>3</td>
<td>AAC SSR (Scalable Sample Rate)</td>
<td>1999</td>
<td>Mpeg4 AAC SSR Audio Object Type is based on the MPEG-2 Parg 7 Scalable Sampling Rate profile(SSR)combined with Perceptual Noise Subsitution(PNS)(defined in MPEG-4 Parg 3 Subpart 4)</td>
</tr>
<tr>
<td>4</td>
<td>AAC LTP (Long Term Prediction)</td>
<td>1999</td>
<td>contains AAC LC</td>
</tr>
<tr>
<td>5</td>
<td>SBR (Spectral Band Replication)</td>
<td>2003</td>
<td>used with AAC LC in the â€œHigh Efficiency AAC Profileâ€(HE-AAC v1)</td>
</tr>
<tr>
<td>6</td>
<td>AAC Scalable</td>
<td>1999</td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>TwinVQ</td>
<td>1999</td>
<td>audio coding at very low bitrates</td>
</tr>
<tr>
<td>8</td>
<td>CELP (Code Excited Linear Prediction)</td>
<td>1999</td>
<td>speech coding</td>
</tr>
<tr>
<td>9</td>
<td>HXVC (Harmonic Vector eXcitation Coding)</td>
<td>speech coding</td>
</tr>
<tr>
<td>10</td>
<td>Reserved</td>
<td></td>
<td></td>
</tr>
<tr>
<td>11</td>
<td>Reserved</td>
<td></td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>TTSI (Text-To-Speech Interface)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>13</td>
<td>Main Synthesis</td>
<td></td>
<td></td>
</tr>
<tr>
<td>14</td>
<td>Wavetable Synthesis</td>
<td></td>
<td></td>
</tr>
<tr>
<td>15</td>
<td>General MIDI</td>
<td></td>
<td></td>
</tr>
<tr>
<td>16</td>
<td>Algorithmic Synthesis and Audio Effects</td>
<td></td>
<td></td>
</tr>
<tr>
<td>17</td>
<td>ER (Error Resilient) AAC LC</td>
<td></td>
<td></td>
</tr>
<tr>
<td>18</td>
<td>Reserved</td>
<td></td>
<td></td>
</tr>
<tr>
<td>19</td>
<td>ER AAC LTP</td>
<td></td>
<td></td>
</tr>
<tr>
<td>20</td>
<td>ER AAC Scalable</td>
<td></td>
<td></td>
</tr>
<tr>
<td>21</td>
<td>ER TwinVQ</td>
<td></td>
<td></td>
</tr>
<tr>
<td>22</td>
<td>ER BSAC (Bit-Sliced Arithmetic Coding)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>23</td>
<td>ER AAC LD (Low Delay)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>24</td>
<td>ER CELP</td>
<td></td>
<td></td>
</tr>
<tr>
<td>25</td>
<td>ER HVXC</td>
<td></td>
<td></td>
</tr>
<tr>
<td>26</td>
<td>ER HILN (Harmonic and Individual Lines plus Noise)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>27</td>
<td>ER Parametric</td>
<td></td>
<td></td>
</tr>
<tr>
<td>28</td>
<td>SSC (SinuSoidal Coding)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>29</td>
<td>PS (Parametric Stereo)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>30</td>
<td>MPEG Surround</td>
<td></td>
<td></td>
</tr>
<tr>
<td>31</td>
<td>(Escape value)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>32</td>
<td>Layer-1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>33</td>
<td>Layer-2</td>
<td></td>
<td></td>
</tr>
<tr>
<td>34</td>
<td>Layer-3</td>
<td></td>
<td></td>
</tr>
<tr>
<td>35</td>
<td>DST (Direct Stream Transfer)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>36</td>
<td>ALS (Audio Lossless)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>37</td>
<td>SLS (Scalable LosslesS)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>38</td>
<td>SLS non-core</td>
<td></td>
<td></td>
</tr>
<tr>
<td>39</td>
<td>ER AAC ELD (Enhanced Low Delay)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>40</td>
<td>SMR (Symbolic Music Representation) Simple</td>
<td></td>
<td></td>
</tr>
<tr>
<td>41</td>
<td>SMR Main</td>
<td></td>
<td></td>
</tr>
<tr>
<td>42</td>
<td>USAC (Unified Speech and Audio Coding) (no SBR)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>43</td>
<td>SAOC (Spatial Audio Object Coding)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>44</td>
<td>LD MPEG Surround</td>
<td></td>
<td></td>
</tr>
<tr>
<td>45</td>
<td>USAC</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="MPEG-4-Audio-Profile"><a href="#MPEG-4-Audio-Profile" class="headerlink" title="MPEG-4 Audio Profile"></a>MPEG-4 Audio Profile</h5><p>  MPEG-4åœ¨éŸ³é¢‘ç¼–ç æ–¹å‘å¯¹éŸ³é¢‘èƒ½åŠ›é›†åˆçš„æè¿°ç§°ä¸ºAudio Profilesï¼ŒéŸ³é¢‘èƒ½åŠ›æè¿°åŸºäºAOT
  <img src="http://images.wodekouwei.com/media/mpeg_audio_profile.jpg" alt="image"></p>
<ol>
<li><code>MPEG-2 AAC LC</code>: Advanced Audio Coding Low-Complexityï¼Œ(AAC-LC / LC-AAC)æ ¼å¼æ˜¯MPEG-2æ ¼å¼ï¼Œè®¾è®¡ç”¨äºæ•°å­—ç”µè§†ã€‚AAC-LCç”¨äºå­˜å‚¨ç©ºé—´å’Œè®¡ç®—èƒ½åŠ›æœ‰é™çš„æƒ…å†µã€‚è¿™ç§ç±»å‹æ²¡æœ‰ä½¿ç”¨é¢„æµ‹å’Œå¢ç›Šæ§åˆ¶è¿™ä¸¤ç§å·¥å…·ï¼Œç¬æ—¶å™ªå£°æ•´å½¢çš„é˜¶æ•°ä¹Ÿæ¯”è¾ƒä½ã€‚
AAC-LCæ˜¯å……åˆ†åˆ©ç”¨å¿ƒç†å£°å­¦åŸç†ï¼Œå¯¹äººç±»å¯¹éŸ³é¢‘ä¿¡å·çš„æ„ŸçŸ¥å­˜åœ¨ä¸ç›¸å¹²æ€§å’Œç»Ÿè®¡å†—ä½™çš„ç‰¹æ€§ï¼Œæœ€å¤§ç¨‹åº¦çš„å‡å°‘ç”¨äºè¡¨è¾¾ä¿¡å·çš„æ¯”ç‰¹æ•°æ® ï¼Œå®ç°éŸ³é¢‘ä¿¡å·å¿«é€Ÿæœ‰æ•ˆåœ°å‹ç¼©ï¼Œè€Œä¸å†è¿½æ±‚è¾“å‡ºä¿¡å·å’ŒåŸå§‹ä¿¡å·ç›¸ä¼¼åº¦ã€‚
AAC-LCçš„é‡è¦æŠ€æœ¯ç‚¹æœ‰å¦‚ä¸‹ä¸€äº›ã€‚</li>
</ol>
<ul>
<li>Temporal Noise Shapingï¼šç¬æ—¶å™ªå£°æ•´å½¢æ˜¯ç”¨æ¥æ§åˆ¶é‡åŒ–å™ªå£°çš„ç¬æ—¶å½¢æ€ï¼Œè§£å†³æ©è”½é˜ˆå€¼å’Œé‡åŒ–å™ªå£°çš„é”™è¯¯åŒ¹é…çš„é—®é¢˜ã€‚TNSåˆ©ç”¨æ—¶é¢‘å¯¹å¶æ€§ï¼Œå³æ—¶åŸŸå¹³ç¨³çš„ä¿¡å·ä¼šåœ¨é¢‘åŸŸä¸Šå˜æ¯”å‰§çƒˆï¼Œè€Œé¢‘åŸŸå¹³ç¨³çš„ä¿¡å·ä¼šåœ¨æ—¶åŸŸä¸Šå˜åŒ–å‰§çƒˆã€‚å¯¹æ—¶åŸŸçš„ç¬æ€ä¿¡å·å¯ä»¥å¯¹é¢‘è°±ç³»æ•°è¿›è¡Œé¢„æµ‹ç¼–ç ã€‚å¯¹é¢‘è°±ç³»æ•°è¿›è¡Œé¢„æµ‹ï¼Œå¯ä»¥åŠæ—¶è°ƒèŠ‚é‡åŒ–å™¨ä»¥é€‚åº”è¾“å…¥ä¿¡å·çš„æ—¶åŸŸçŠ¶æ€ï¼Œå¯ä»¥æœ‰æ•ˆçš„æ§åˆ¶é‡åŒ–å™ªå£°ï¼Œ</li>
<li>Intensity Stereoï¼šåˆ©ç”¨å¿ƒç†å£°å­¦åŸç†æé«˜ç¼–ç æ•ˆç‡çš„ä¸€ç§æ–¹æ³•ã€‚ç”±äºäººè€³å¯¹é«˜é¢‘ä¿¡å·çš„ç›¸ä½ä¸æ•æ„Ÿï¼Œåªè¦ä¿¡å·çš„èƒ½é‡å’Œé¢‘è°±ç›¸ä¼¼ï¼Œåœ¨æ„ŸçŸ¥ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæ‰€ä»¥å½“ä¸€å¯¹å£°é“çš„ä¿¡å·ç›¸å…³æ€§è¾ƒé«˜æ—¶ï¼Œå¯ä»¥å¯¹é«˜é¢‘éƒ¨åˆ†è¿›è¡Œä¸€å®šçš„å¤„ç†ï¼Œåªåœ¨ä¸€ä¸ªå£°é“ä¸­ç¼–ç ä¼ è¾“æ•°æ®ï¼Œè€Œä¸ä¼šå½±å“è§£ç åçš„é‡å»ºéŸ³è´¨ã€‚
AAC-LCæŠŠ6kHzä½œä¸ºå£°å¼ºç«‹ä½“å£°å¤„ç†çš„èµ·å§‹é¢‘ç‡ï¼Œåœ¨è¿™ä¸ªé¢‘ç‡ä¸Šçš„éƒ½è¿›è¡Œå£°å¼ºç«‹ä½“å£°å¤„ç†ã€‚è®¡ç®—å‡ºå·¦å³å£°é“å„ä¸ªå­å¸¦çš„èƒ½é‡å’Œæ€»èƒ½é‡ï¼Œç„¶åè®¡ç®—å·¦å£°é“èƒ½é‡å’Œæ€»èƒ½é‡çš„æ¯”å€¼å¹¶æ¢ç®—æˆä¸€ä¸ªå¼ºåº¦å› å­ï¼ŒæŒ‰ç…§è¿™ä¸ªå¼ºåº¦å› å­å¯¹äº†å¸¦å†…çš„æ‰€æœ‰é¢‘è°±è¿›è¡Œå·¦å³å£°é“æ±‚å’Œå¹¶å½’ä¸€åŒ–ï¼Œå³å£°é“çš„æ•°æ®åˆ™å…¨éƒ¨ç½®é›¶ï¼Œè¿™æ ·åªéœ€è¦å¯¹å·¦å£°é“æ•°æ®è¿›è¡Œé‡åŒ–ç¼–ç ã€‚</li>
<li>Perceptual Noise Substitutionï¼šæ„ŸçŸ¥å™ªå£°æ›¿ä»£ç”¨äºé¢‘è°±æˆåˆ†åˆ†ç±»ä¼¼å™ªå£°ï¼ˆåŠŸç‡è°±å¯†åº¦æ˜¯å‡åŒ€çš„ï¼‰æ—¶ï¼Œç”¨äººé€ å™ªå£°ä»£æ›¿ã€‚å½“åˆ¤æ–­æŸä¸ªé¢‘å¸¦éœ€è¦è¿›è¡Œæ„ŸçŸ¥å™ªå£°æ›¿ä»£åï¼Œåªç”¨æŠŠè¯¥é¢‘å¸¦çš„èƒ½é‡ä½œä¸ºå‚æ•°ç¼–ç ä¼ è¾“ï¼Œè€Œä¸éœ€è¦å¯¹å­å¸¦å†…çš„é¢‘è°±å€¼è¿›è¡Œç¼–ç ï¼Œè§£ç æ—¶è§£å‡ºå­å¸¦èƒ½é‡å’ŒéšæœºçŸ¢é‡ç”Ÿæˆå‡½æ•°äº§ç”Ÿçš„ç±»ä¼¼å™ªå£°ã€‚
Middle/Sideï¼šç«‹ä½“å£°ç¼–ç ï¼Œæ˜¯åˆ©ç”¨ä¸€å¯¹å£°é“çš„ä¿¡å·ä¹‹é—´çš„ç›¸å…³æ€§å»å†—ä½™ï¼Œé™ä½ç¼–ç æ¯”ç‰¹ç‡çš„æ–¹æ³•ã€‚AAC-LDç¼–ç å™¨ä¸­å¯¹å·¦å³å£°é“çš„æ•°æ®ç›¸å…³æ€§è¾ƒå¤§æ—¶ï¼Œå¯ä»¥ç”¨Middle=ï¼ˆL+Rï¼‰/ 2ï¼ŒSide = (L-R)/2æ¥ä»£æ›¿å·¦å³å£°é“çš„æ•°æ®è¿›è¡Œç¼–ç ã€‚è¿™æ ·èƒ½é‡é›†ä¸­åœ¨ä¸€ä¸ªå£°é“æ•°æ®ä¸­ï¼Œè€Œå¦å¤–ä¸€ä¸ªå£°é“åªè¦å°‘é‡æ¯”ç‰¹æ•°æ®ï¼Œè¿™æ ·å®ç°äº†æ•°æ®å‹ç¼©ã€‚</li>
</ul>
<ol>
<li><code>MPEG-2 AAC Main</code>: ä¸»è§„æ ¼    </li>
<li><code>MPEG-2 AAC SSR</code>: å¯å˜é‡‡æ ·ç‡è§„æ ¼ï¼ˆScaleable Sample Rateï¼‰</li>
<li><code>MPEG-4 AAC LC</code>: ä½å¤æ‚åº¦è§„æ ¼ï¼ˆLow Complexityï¼‰â€”â€”ç°åœ¨çš„æ‰‹æœºæ¯”è¾ƒå¸¸è§çš„MP4æ–‡ä»¶ä¸­çš„éŸ³é¢‘éƒ¨ä»½å°±åŒ…æ‹¬äº†è¯¥è§„æ ¼éŸ³é¢‘æ–‡ä»¶</li>
<li><code>MPEG-4 AAC Main</code>: ä¸»è§„æ ¼   â€”â€”åŒ…å«äº†é™¤å¢ç›Šæ§åˆ¶ä¹‹å¤–çš„å…¨éƒ¨åŠŸèƒ½ï¼Œå…¶éŸ³è´¨æœ€å¥½</li>
<li><code>MPEG-4 AAC SSR</code>: å¯å˜é‡‡æ ·ç‡è§„æ ¼ï¼ˆScaleable Sample Rateï¼‰</li>
<li><code>MPEG-4 AAC LTP</code>: é•¿æ—¶æœŸé¢„æµ‹è§„æ ¼ï¼ˆLong Term Predicitionï¼‰</li>
<li><code>MPEG-4 AAC LD</code>: AACæ˜¯æ„ŸçŸ¥å‹éŸ³é¢‘ç¼–è§£ç å™¨ï¼Œå¯ä»¥åœ¨è¾ƒä½çš„æ¯”ç‰¹ç‡ä¸‹æä¾›å¾ˆé«˜è´¨é‡çš„ä¸»è§‚éŸ³è´¨ã€‚ä½†æ˜¯è¿™æ ·çš„ç¼–è§£ç å™¨åœ¨ä½æ¯”ç‰¹ç‡ä¸‹çš„ç®—æ³•å»¶æ—¶å¾€å¾€è¶…è¿‡100msï¼Œæ‰€ä»¥å¹¶ä¸é€‚åˆå®æ—¶çš„åŒå‘é€šä¿¡ã€‚è€ŒåŸºäºG.722çš„è¯­éŸ³ç¼–è§£ç æ–¹æ¡ˆå› ä¸ºå…¶è¾ƒå°çš„ç®—æ³•å»¶æ—¶è€Œé€‚åˆäºåŒå‘é€šä¿¡ã€‚ä½†æ˜¯è¿™ç§åŸºäºè¯­éŸ³çš„ç¼–è§£ç æ–¹æ¡ˆåªèƒ½é’ˆå¯¹è¯­éŸ³ä¿¡å·æä¾›è¾ƒå¥½çš„ä¸»è§‚è´¨é‡ï¼Œå¹¶ä¸é€‚åˆæ›´ä¸ºå¤æ‚çš„éŸ³é¢‘ä¿¡å·ï¼Œè€Œä¸”å³ä½¿åœ¨å¾ˆé«˜çš„æ¯”ç‰¹ç‡ä¸‹ï¼Œè¯¥ç¼–è§£ç æ–¹æ¡ˆç»™å‡ºçš„ç»“æœä¹Ÿå¾ˆéš¾è¾¾åˆ°è‰¯å¥½çš„éŸ³è´¨ã€‚
å¸¸ç”¨çš„æ„ŸçŸ¥éŸ³é¢‘ç¼–ç å™¨çš„å»¶æ—¶åŒ…æ‹¬ï¼š</li>
</ol>
<ul>
<li>Framing delayï¼šè¿›è¡Œå—å˜æ¢éœ€è¦çš„å—é•¿ï¼›</li>
<li>Filterbank delayï¼šåˆ†æ-ç»¼åˆæ»¤æ³¢å™¨æ‰€éœ€è¦çš„å»¶æ—¶ï¼›</li>
<li>Look-ahead delay for block switchingï¼šå—åˆ‡æ¢ä¸ºæ£€æµ‹ç¬æ€è€Œéœ€è¦çš„å»¶æ—¶ï¼›</li>
<li>Use of bit reservoirï¼šæ¯”ç‰¹æ± å¤§å°ç›¸å¯¹äºå¹³å‡æ¯”ç‰¹ç‡æ‰€éœ€è¦çš„å»¶æ—¶ã€‚
æ€»å»¶æ—¶è®¡ç®—å…¬å¼ï¼š
<img src="http://images.wodekouwei.com/media/aac_ld1.jpg" alt="image">
å¦‚ä¸‹é¢çš„AAC-LCä¸ºä¾‹ï¼š
<img src="http://images.wodekouwei.com/media/aac_ld2.jpg" alt="iamge">
åœ¨AAC-LDä¸­ï¼Œä¸ºäº†å‡å°‘å»¶æ—¶ï¼Œå°†åŸæ¥çš„1024çš„å¸§é•¿æ”¹ä¸º512ï¼›æ²¡æœ‰äº†çª—åˆ‡æ¢åŠŸèƒ½ï¼Œå‡å°‘äº†ä¸ºè¿›è¡Œçª—åˆ‡æ¢æ‰€éœ€è¦çš„å‰ç»å»¶æ—¶ï¼›åŒæ—¶ä¸ºäº†å¢å¼ºå¯¹ç¬æ€ä¿¡å·çš„ç¼–ç è´¨é‡ï¼Œå¼•å…¥äº†çª—å‹åˆ‡æ¢æœºåˆ¶ï¼Œçª—å‹åŒ…æ‹¬ä¸€èˆ¬çš„SINEçª—å’Œä¸€ä¸ªå°‘é‡å çš„çª—ï¼Œè¯¥çª—ä¸åé¢çš„çª—æœ‰å¾ˆå°‘çš„é‡å ï¼Œè¿™æ ·é€šè¿‡å¯¹TNSå·¥å…·çš„ä¼˜åŒ–æ¥æ¶ˆé™¤ç¬æ€ä¿¡å·äº§ç”Ÿçš„é¢„å›å£°æ•ˆåº”ã€‚
MPEG-4 Low Delay Audio Coder (AAC-LD)æ˜¯ç›´æ¥æºäºMPEG-2 AACï¼Œå¹¶ä¸”ç»“åˆäº†æ„ŸçŸ¥éŸ³é¢‘ç¼–ç å’ŒåŒå‘é€šä¿¡å¿…é¡»çš„ä½å»¶æ—¶è¦æ±‚ã€‚å®ƒå¯ä»¥ä¿è¯æœ€å¤§çš„20msçš„ç®—æ³•å»¶æ—¶å’ŒåŒ…æ‹¬è¯­éŸ³å’ŒéŸ³ä¹çš„ä¿¡å·çš„å¾ˆå¥½çš„éŸ³è´¨ã€‚ç°åœ¨çš„MPEG-4 AAC LDæ”¯æŒæœ€å¤§é‡‡æ ·ç‡48kHzï¼Œæœ€å¤§å£°é“æ•°ç›®æ˜¯2ï¼ˆå¯ä»¥æ‰©å±•ä¸ºå¤šå£°é“ï¼‰ã€‚</li>
</ul>
<ol>
<li><code>MPEG-4 AAC HE</code>: é«˜æ•ˆç‡è§„æ ¼ï¼ˆHigh Efficiencyï¼‰â€”â€“è¿™ç§è§„æ ¼é€‚åˆç”¨äºä½ç ç‡ç¼–ç ï¼Œæœ‰Nero ACC ç¼–ç å™¨æ”¯æŒ</li>
</ol>
<p>14496-3æ ‡å‡†ï¼Œé‡Œé¢å®šä¹‰çš„profileé™¤äº†ä¸Šè¿°çš„ä¸€äº›è§„æ ¼ï¼Œè¿˜æœ‰å¦‚Scalable ã€ TwinVQã€  CELPã€  HVXCç­‰æ›´å¤šå…¶ä»–çš„profileã€‚</p>
<p>ç›®å‰å¬åˆ°ç”¨çš„æ¯”è¾ƒå¤šçš„åº”è¯¥æ˜¯LCå’ŒHE(é€‚åˆä½ç ç‡)ã€‚æµè¡Œçš„Nero AACçš„å‘½ä»¤è¡Œç¼–ç ç¨‹åºå°±æ”¯æŒLCï¼ŒHEï¼ŒHEv2è¿™ä¸‰ç§ï¼Œè¯•ç”¨åï¼Œç”¨MediaInfoåˆ†æäº†ç¼–ç åçš„AACéŸ³é¢‘ï¼Œå‘ç°è§„æ ¼æ˜¾ç¤ºéƒ½æ˜¯LCï¼Œå½“æ—¶å°±æ„Ÿåˆ°å¥‡æ€ªï¼Œä¸æ˜¯è¯´æ”¯æŒä¸‰ç§è§„æ ¼å—ï¼Ÿç„¶åæ‰åˆæŸ¥èµ„æ–™å‘ç°ï¼ŒåŸæ¥HEå…¶å®å°±æ˜¯AACï¼ˆLCï¼‰+SBRæŠ€æœ¯ï¼ŒHEv2å°±æ˜¯AACï¼ˆLCï¼‰+SBR+PSæŠ€æœ¯ï¼Œéš¾æ€ªç”¨MediaInfoåˆ†æåï¼ŒHEè§„æ ¼çš„æ–‡ä»¶å³æ˜¾ç¤º:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">æ ¼å¼ç®€ä»‹:LC</div><div class="line">æ ¼å¼è®¾ç½®,SBR:æ˜¯</div><div class="line">æ ¼å¼è®¾ç½®,PS:å¦</div></pre></td></tr></table></figure></p>
<h6 id="å…³äºHEä¸HEv2"><a href="#å…³äºHEä¸HEv2" class="headerlink" title="å…³äºHEä¸HEv2"></a>å…³äºHEä¸HEv2</h6><ul>
<li><p>HEï¼šâ€œhigh efficiencyâ€ï¼ˆé«˜æ•ˆæ€§ï¼‰ã€‚HE-AAC v1ï¼ˆåˆç§°AACPlusV1ï¼ŒSBR)ç”¨å®¹å™¨çš„æ–¹æ³•åŠ äº†åŸAACï¼ˆLCï¼‰+SBRæŠ€æœ¯ã€‚SBRå…¶å®ä»£è¡¨çš„æ˜¯Spectral Band Replication(é¢‘æ®µå¤åˆ¶)ã€‚ç®€å•æ¦‚æ‹¬ä¸€ä¸‹ï¼ŒéŸ³ä¹çš„ä¸»è¦é¢‘è°±é›†ä¸­åœ¨ä½é¢‘æ®µï¼Œé«˜é¢‘æ®µå¹…åº¦å¾ˆå°ï¼ˆä½†å¾ˆé‡è¦ï¼Œå†³å®šäº†éŸ³è´¨ï¼‰ï¼Œå¦‚æœå¯¹æ•´ä¸ªé¢‘æ®µç¼–ç ï¼Œè¦ä¹ˆä¸ºäº†ä¿æŠ¤é«˜é¢‘é€ æˆä½é¢‘æ®µç¼–ç è¿‡ç»†ä»¥è‡´æ–‡ä»¶å·¨å¤§ï¼Œè¦ä¹ˆä¸ºäº†ä¿å­˜äº†ä½é¢‘çš„ä¸»è¦æˆåˆ†è€Œå¤±å»é«˜é¢‘æˆåˆ†ä»¥è‡´ä¸§å¤±éŸ³è´¨ã€‚SBRæŠŠé¢‘è°±åˆ‡å‰²å¼€æ¥ï¼Œä½é¢‘å•ç‹¬ç¼–ç ä¿å­˜ä¸»è¦æˆåˆ†ï¼Œé«˜é¢‘å•ç‹¬æ”¾å¤§ç¼–ç ä¿å­˜éŸ³è´¨ï¼Œâ€œç»Ÿç­¹å…¼é¡¾â€äº†ï¼Œåœ¨å‡å°‘æ–‡ä»¶å¤§å°çš„æƒ…å†µä¸‹è¿˜ä¿å­˜äº†éŸ³è´¨ï¼Œå®Œç¾çš„åŒ–è§£äº†ä¸€å¯¹çŸ›ç›¾</p>
</li>
<li><p>HEv2 å®ƒç”¨å®¹å™¨çš„æ–¹æ³•åŒ…å«äº†HE-AAC v1å’ŒPSæŠ€æœ¯ã€‚PSæŒ‡â€œparametric stereoâ€ï¼ˆå‚æ•°ç«‹ä½“å£°ï¼‰ã€‚è¿™ä¸ªå…¶å®å¥½ç†è§£ï¼ŒåŸæ¥çš„ç«‹ä½“å£°æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°æ˜¯ä¸€ä¸ªå£°é“çš„ä¸¤å€ã€‚ä½†æ˜¯ä¸¤ä¸ªå£°é“çš„å£°éŸ³å­˜åœ¨æŸç§ç›¸ä¼¼æ€§ï¼Œæ ¹æ®é¦™å†œä¿¡æ¯ç†µç¼–ç å®šç†ï¼Œç›¸å…³æ€§åº”è¯¥è¢«å»æ‰æ‰èƒ½å‡å°æ–‡ä»¶å¤§å°ã€‚æ‰€ä»¥PSæŠ€æœ¯å­˜å‚¨äº†ä¸€ä¸ªå£°é“çš„å…¨éƒ¨ä¿¡æ¯ï¼Œç„¶åï¼ŒèŠ±å¾ˆå°‘çš„å­—èŠ‚ç”¨å‚æ•°æè¿°å¦ä¸€ä¸ªå£°é“å’Œå®ƒä¸åŒçš„åœ°æ–¹
è¿™æ ·ï¼ŒHEv1å’ŒHEv2ç”¨ä¸ªå›¾ç®€å•è¡¨ç¤ºä¸‹å°±æ˜¯ï¼š(å›¾ä¸­çš„AACå³æŒ‡çš„æ˜¯åŸæ¥çš„AAC-LC)
<img src="http://images.wodekouwei.com/media/aac-he.jpg" alt="image">
ç”±äºNERO AACç¼–ç åäº§ç”Ÿçš„æ˜¯ç»è¿‡MP4å®¹å™¨å°è£…åçš„ï¼Œè€Œæˆ‘ä»¬çš„decoderéœ€è¦å¤„ç†çš„æ˜¯æœªç»å°è£…çš„AACæµï¼Œå› æ­¤è¿˜éœ€è¦å¤„ç†ä»MP4å°è£…æ ¼å¼ä¸­extractå‡ºAACæµçš„æ­¥éª¤ï¼›å“¦ï¼Œè¿™é‡Œæåˆ°äº†MP4å®¹å™¨å°è£…ï¼Œå°±å†æŠŠæˆ‘çœ‹åˆ°çš„ä¸€äº›å…³äºMP4å®¹å™¨çš„å¿ƒå¾—æ’å…¥åœ¨æ­¤ä¹Ÿè¯´ä¸‹ï¼š</p>
</li>
</ul>
<p>å…¶å®.mp4æ ¼å¼è§„èŒƒæ˜¯MPEG4 Part 1æ ‡å‡†å®šä¹‰çš„ã€‚ä½†æ˜¯è¿™ä¸ªæ ¼å¼æœ¬èº«ç›¸å½“é€šç”¨ï¼Œå¹¶ä¸æ˜¯åªèƒ½ç”¨æ¥å­˜è´®MPEG4è§†é¢‘æ ¼å¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ª.mp4æ–‡ä»¶ä¸­åŒ…å«çš„å¯èƒ½æ˜¯H.263çš„è§†é¢‘è½¨åŠAMRçš„éŸ³é¢‘è½¨ã€‚è¿™æ ·å®ƒå’ŒMPEG4è§†é¢‘å‹ç¼©ç®—æ³•å°±åŠç‚¹è¾¹éƒ½æ²¾ä¸ä¸Šã€‚ä½†å®ƒç»å¯¹æ˜¯ä¸€ä¸ªåˆæ³•çš„.mp4æ–‡ä»¶ã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼Œ.mp4æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å°åŒ…æ ¼å¼ã€‚ä¹Ÿè®¸å®ƒçš„åŸå§‹è®¾è®¡æ„å›¾æ˜¯ä»…ç”¨äºMPEG4ï¼Œä½†äº‹å®ä¸Šå¤§å®¶è§‰å¾—å®ƒå¾ˆå¥½ç”¨ï¼Œå·²ç»æŠŠå®ƒæ‰©å±•æˆå¯ä»¥åŒ…å®¹å…¶å®ƒæ ¼å¼äº†ã€‚ç°åœ¨å¸‚åœºä¸Šæ¯”å¦‚æŸäº§å“å·ç§°â€œæ”¯æŒMP4æ’­æ”¾â€ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¦‚æœå®ƒæ˜¯æŒ‡å¯ä»¥æ’­æ”¾<em>.mp4è¿™ç§æ–‡ä»¶ï¼Œé‚£é‡Œé¢çš„éŸ³é¢‘å’Œè§†é¢‘æ ¼å¼å®ƒèƒ½æ”¯æŒå¤šå°‘ç§ç»„åˆå‘¢ï¼Ÿæ²¡è¯´æ¸…æ¥šå§ã€‚ä¸¾ä¸ªæç«¯çš„ä¾‹å­ï¼Œå‡è®¾ä¸€å°è®¾å¤‡ä»…æ”¯æŒâ€œè§†é¢‘ä¸ºæœªå‹ç¼©YUVä»¥åŠä¸å¸¦éŸ³é¢‘è½¨çš„.mp4æ–‡ä»¶ï¼Œä½†å®ƒçš„æ–‡ä»¶åç¡®å®å¯ä»¥æ˜¯</em>.mp4ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥åœ¨ç›’å­ä¸Šå°ä¸Šâ€œæ”¯æŒMP4â€å‘¢ï¼Ÿé‚£ä¹ˆï¼Œä¹°å›å»ï¼Œå¤åˆ¶ä¸€ä¸ªç½‘ä¸Šä¸‹è½½çš„.mp4æ–‡ä»¶ï¼ˆMPEG4è§†é¢‘å’ŒAACéŸ³é¢‘åº”è¯¥æ˜¯ä¸ªæ¯”è¾ƒæµè¡Œçš„ç»„åˆï¼‰ï¼Œç»“æœå´å‘ç°æ ¹æœ¬ä¸èƒ½æ’­æ”¾ã€‚å°±ç®—ä¸ä¸¾è¿™ä¹ˆæç«¯çš„ä¾‹å­ï¼Œä¸€èˆ¬.mp4æ–‡ä»¶ä¸­å¸¸è§çš„è§†é¢‘éŸ³é¢‘æ ¼å¼ä¹Ÿæœ‰å¤šç§ï¼Œä¸€ä¸ªäº§å“è¦åšåˆ°æ”¯æŒæ‰€æœ‰çš„æ ¼å¼æ˜¯å¾ˆéš¾çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦å‡†ç¡®çš„æè¿°ï¼Œåº”è¯¥å†™æ¸…æ¥šç±»ä¼¼â€œæ”¯æŒè§†é¢‘æ ¼å¼ä¸ºMPEG4æˆ–H.264/AVCï¼ŒéŸ³é¢‘ä¸ºAMRæˆ–AACçš„*.mp4æ–‡ä»¶â€ã€‚å…¶å®æ›´ä¸¥æ ¼ä¸€äº›ï¼Œè¿˜åº”è¯¥å†™æ¸…æ¥šMPEG4æ”¯æŒåˆ°å“ªç§profile, AMRæ˜¯NBè¿˜æ˜¯WBï¼ŒAACæ˜¯LCè¿˜æ˜¯HEç­‰æ›´å¤šç»†èŠ‚ã€‚å½“ç„¶ï¼Œè¿™ç§è¯¯å¯¼å‹çš„è¯´æ˜åº”è¯¥åœ¨å‡å°‘ï¼Œä¸è¿‡å¦‚æœæœ‰æ¯”è¾ƒç¡®åˆ‡çš„æ ¼å¼éœ€æ±‚ï¼Œæœ€å¥½è¿˜æ˜¯å…ˆææ¸…æ¥šè¿™äº›ç»†èŠ‚ã€‚çœ‹åˆ°ç½‘ä¸Šè¿˜æœ‰äººè¯´åˆ°N73ï¼Œå…¶å®åªæ”¯æŒè§†é¢‘ä¸ºMPEG4 Simple Profile / Advanced Simple ProfileåŠH.263 Profile 0 &amp; 3ï¼ŒéŸ³é¢‘ä¸ºAMR-NB/WBæˆ–è€…AAC-LC, HE-AACçš„mp4æ–‡ä»¶ã€‚å¦‚æœä½ æ”¾ä¸€ä¸ªè§†é¢‘æ ¼å¼ä¸ºH.264/AVCçš„mp4ä¸Šå»ï¼Œæ˜¯æ— æ³•æ’­æ”¾å‡ºç”»é¢æ¥çš„ã€‚</p>
<p>åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€äº›å·¥å…·ï¼Œå¦‚MP4UI,MP4BOX,Yamb(mp4boxçš„GUIç¨‹åº),é‡‡ç”¨å®ƒä»¬è¿›è¡Œextractæ“ä½œåå‘ç°ï¼ŒåŸæ¥çš„SBRå’ŒPSç­‰ä¿¡æ¯å’‹æ²¡æœ‰äº†ï¼Œéƒ½å˜æˆLCè§„æ ¼çš„AACæ–‡ä»¶å•¦ã€‚å¥½å®¹æ˜“å‡†å¤‡çš„æµ‹è¯•æµï¼Œéš¾é“è¿˜æ˜¯ä¸èƒ½ç”¨ï¼Ÿäºæ˜¯ä¸€ç•ªè‹¦å¯»å‘ç°ï¼Œå¯èƒ½æ˜¯SBRå’ŒPSç­‰ä¿¡æ¯åœ¨ADTSå¤´ä¸­æ˜¯æ— æ³•ä½“ç°çš„ï¼Œæ‰€ä»¥åˆ†æADTSæ ¼å¼å¤´çš„AACï¼Œå°±æ— æ³•åˆ¤åˆ«æ˜¯å¦æ˜¯HEå’ŒHEv2å•¦ã€‚ä½†æ˜¯æˆ‘æ€»è§‰å¾—SBRå’ŒPSç­‰æŠ€æœ¯ä¿¡æ¯åœ¨AACæµä¸­åº”è¯¥è¿˜æ˜¯å­˜åœ¨çš„ã€‚å› ä¸ºæˆ‘è¿˜åœ¨ä¸€ä¸ªå›½å¤–çš„è®ºå›ä¸Šçœ‹åˆ°è¿™ä¹ˆå‡ å¥è¯ï¼šThereâ€™s no requirement for MP4 with AAC to have SBR indicated in the headers. Itâ€™s still correct not to have it marked and have SBR or PS data in the stream anyway. Likewise, decoding a frame and not seeing any SBR or PS info doesnâ€™t mean you canâ€™t find it further up in the stream anywayï¼ˆæˆ‘ç†è§£å°±æ˜¯è¯´SBR OR PSä¿¡æ¯ä¸ä¸€å®šåœ¨Headerä¸­æœ‰ï¼Œä½†æ˜¯å¹¶ä¸æ„å‘³ç€ä½ ä¸èƒ½è¿›ä¸€æ­¥åœ¨streamä¸­å‘ç°å®ƒï¼‰ã€‚</p>
<p><strong>HE-AACçš„.mp4ç æµï¼Œç»è¿‡extractå‡ºAAC(ADTS)åï¼Œ44.1KHZçš„å˜æˆäº†22.05KHZã€‚HEv2-AACçš„.mp4ç æµï¼Œç»è¿‡extractå‡ºAAC(ADTS)åï¼Œä¸ä½†44.1KHZçš„å˜æˆäº†22.05KHZ(ä¸€åŠ)ï¼Œè¿2channelsä¹Ÿå˜æˆäº†1channels</strong>ï¼Œè¿™ä¸ªé—®é¢˜æ›´å¥‡æ€ªäº†ï¼Œåœ¨è®ºå›ä¸Šæ‰¾ï¼Œå‘ç°ä¹Ÿæœ‰äººæœ‰æ­¤é—®é¢˜ï¼šâ€œI get 22050Hz, 1 channel for audio that is in fact 44100Hz, 2channels and having both SBR and PSâ€ã€‚</p>
<p>åæ¥çœ‹åˆ°MSDNä¸­çš„AAC Decoderçš„æè¿°ä¸­æœ‰è¿™ä¹ˆä¸€å°æ®µè¯ï¼š
The media type gives the sample rate and number of channels prior to the application of spectral band replication (SBR) and parametric stereo (PS) tools, if present. The effect of the SBR tool is to double the decoded sample rate relative to the core AAC-LC sample rate. The effect of the PS tool is to decode stereo from a mono-channel core AAC-LC stream.
æˆ‘çš„ç†è§£æ˜¯AACçš„decoderå¦‚æœæ”¯æŒSBRå’ŒPSï¼Œä¼šå°†AAC-HEV1(SBR)ä¸­çš„sample rateæé«˜ä¸€å€ï¼Œè€Œä¼šå°†AAC-HEV2(SBR+PS)ä¸­ä¸ä»…sample rateæé«˜ä¸€å€ï¼Œå•å£°é“ä¹Ÿæé«˜è‡³åŒå£°é“äº†ã€‚ç»“åˆå‰é¢æåˆ°çš„SBR(é¢‘æ®µå¤åˆ¶)å’ŒPS(å‚æ•°ç«‹ä½“å£°ï¼‰æŠ€æœ¯çš„ç®€å•ä»‹ç»ï¼Œå¥½åƒè§‰å¾—è¿™æ ·æ˜¯æœ‰ç‚¹å„¿é“ç†çš„å“¦~~
ç”¨IPP exampleæä¾›çš„è§£ç å·¥å…·simple_playerç®€å•è¯•äº†ä¸‹ï¼Œå¯¹äº44.1khzï¼Œstereoçš„HEv2-AACçš„.mp4ç æµï¼Œç»è¿‡extractå‡º22.05KHZï¼Œmono çš„AAC(ADTS)åï¼Œå†ä½¿ç”¨simple_playerè¿›è¡ŒéŸ³é¢‘è§£ç æµ‹è¯•ï¼Œè§£å®Œåï¼Œæœç„¶å‘ç°åˆæ¢å¤äº†44.1khzå’Œstereoã€‚ï¼ˆä½†ç›®å‰ä¹Ÿæµ‹è¯•äº†å¥½å‡ ç§extractå‡ºçš„HEå’ŒHEv2çš„aacç æµï¼Œæœ‰çš„èƒ½å°†sample rateå’Œchannel åˆdoubleå›æ¥ï¼Œæœ‰çš„åˆä¸èƒ½ï¼Œè¿™ä¸ªå…·ä½“åŸå› æ˜¯ä¸æ˜¯ç”±äºIpp exampleæä¾›çš„è§£ç å™¨çš„é—®é¢˜è¿˜ä¸ç¡®å®šï¼‰ã€‚</p>
<p>å¦å¤–ï¼Œç”¨simple_playerå¦‚æœç›´æ¥decoderç¼–ç å‡ºçš„ç»è¿‡å°è£…çš„.mp4æ ¼å¼çš„AACéŸ³é¢‘çš„è¯ï¼Œå‘ç°ï¼šå…¶å®ƒéƒ½æ­£å¸¸ï¼ŒåªAAC-HEv2æ ¼å¼çš„.mp4éŸ³é¢‘è§£ç åå˜æˆäº†å•å£°é“ã€‚éš¾é“æ˜¯è§£ç å™¨ä¸­çš„PS toolsæ²¡èƒ½å‘æŒ¥ä½œç”¨ï¼Ÿåˆæ­¥ä¼°è®¡åº”è¯¥æ˜¯IPP çš„é‚£ä¸ªå°è§£ç å™¨çš„é—®é¢˜å§ã€‚</p>
<h5 id="AACå°è£…æ ¼å¼"><a href="#AACå°è£…æ ¼å¼" class="headerlink" title="AACå°è£…æ ¼å¼"></a>AACå°è£…æ ¼å¼</h5><p><img src="http://images.wodekouwei.com/media/aac_format.jpg" alt="image">
ä»¥å¸¸ç”¨çš„ä¸¤ä¸ªæ ¼å¼ä¸ºä¾‹:</p>
<ul>
<li><strong>ADIF</strong>ï¼šAudio Data Interchange Format éŸ³é¢‘æ•°æ®äº¤æ¢æ ¼å¼ã€‚è¿™ç§æ ¼å¼çš„ç‰¹å¾æ˜¯å¯ä»¥ç¡®å®šçš„æ‰¾åˆ°è¿™ä¸ªéŸ³é¢‘æ•°æ®çš„å¼€å§‹ï¼Œä¸éœ€è¿›è¡Œåœ¨éŸ³é¢‘æ•°æ®æµä¸­é—´å¼€å§‹çš„è§£ç ï¼Œå³å®ƒçš„è§£ç å¿…é¡»åœ¨æ˜ç¡®å®šä¹‰çš„å¼€å§‹å¤„è¿›è¡Œã€‚æ•…è¿™ç§æ ¼å¼å¸¸ç”¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­ã€‚</li>
<li><strong>ADTS</strong>ï¼šAudio Data Transport Stream éŸ³é¢‘æ•°æ®ä¼ è¾“æµã€‚è¿™ç§æ ¼å¼çš„ç‰¹å¾æ˜¯å®ƒæ˜¯ä¸€ä¸ªæœ‰åŒæ­¥å­—çš„æ¯”ç‰¹æµï¼Œè§£ç å¯ä»¥åœ¨è¿™ä¸ªæµä¸­ä»»ä½•ä½ç½®å¼€å§‹ã€‚å®ƒçš„ç‰¹å¾ç±»ä¼¼äºmp3æ•°æ®æµæ ¼å¼ã€‚
ç®€å•è¯´ï¼ŒADTSå¯ä»¥åœ¨ä»»æ„å¸§è§£ç ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ¯ä¸€å¸§éƒ½æœ‰å¤´ä¿¡æ¯ã€‚ADIFåªæœ‰ä¸€ä¸ªç»Ÿä¸€çš„å¤´ï¼Œæ‰€ä»¥å¿…é¡»å¾—åˆ°æ‰€æœ‰çš„æ•°æ®åè§£ç ã€‚ä¸”è¿™ä¸¤ç§çš„headerçš„æ ¼å¼ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œå…·ä½“çš„ç»„ç»‡ç»“æ„åœ¨è¿™é‡Œå°±ä¸è¯¦è¯´äº†ã€‚</li>
</ul>
<blockquote>
<p>å‚è€ƒ:
<a href="http://blog.csdn.net/axdc_qa_team/article/details/4271043" target="_blank" rel="external">AACçš„å„ç§è§„æ ¼</a></p>
</blockquote>
<h6 id="AACæ ¼å¼å’ŒM4Aæ ¼å¼"><a href="#AACæ ¼å¼å’ŒM4Aæ ¼å¼" class="headerlink" title="AACæ ¼å¼å’ŒM4Aæ ¼å¼"></a>AACæ ¼å¼å’ŒM4Aæ ¼å¼</h6><p>AACï¼ˆAdvanced Audio Codingï¼‰ï¼Œä¸­æ–‡ç§°ä¸ºâ€œé«˜çº§éŸ³é¢‘ç¼–ç â€ï¼Œå‡ºç°äº1997å¹´ï¼ŒåŸºäº MPEG-2çš„éŸ³é¢‘ç¼–ç æŠ€æœ¯ã€‚ç”±Fraunhofer IISã€æœæ¯”å®éªŒå®¤ã€AT&amp;Tã€Sonyï¼ˆç´¢å°¼ï¼‰ç­‰å…¬å¸å…±åŒå¼€å‘ï¼Œç›®çš„æ˜¯å–ä»£MP3æ ¼å¼ã€‚2000å¹´ï¼ŒMPEG-4æ ‡å‡†å‡ºç°åï¼ŒAAC é‡æ–°é›†æˆäº†å…¶ç‰¹æ€§ï¼ŒåŠ å…¥äº†SBRæŠ€æœ¯å’ŒPSæŠ€æœ¯ï¼Œä¸ºäº†åŒºåˆ«äºä¼ ç»Ÿçš„ MPEG-2 AAC åˆç§°ä¸º MPEG-4 AACã€‚AACç¼–ç çš„ä¸»è¦æ‰©å±•åæœ‰ä¸‰ç§ï¼š</p>
<ul>
<li>.AAC - ä½¿ç”¨MPEG-2 Audio Transport Stream( ADTSï¼Œå‚è§MPEG-2 )å®¹å™¨ï¼ŒåŒºåˆ«äºä½¿ç”¨MPEG-4å®¹å™¨çš„MP4/M4Aæ ¼å¼ï¼Œå±äºä¼ ç»Ÿçš„AACç¼–ç ï¼ˆFAACé»˜è®¤çš„å°è£…ï¼Œä½†FAACäº¦å¯è¾“å‡º MPEG-4 å°è£…çš„AACï¼‰</li>
<li>.MP4 - ä½¿ç”¨äº†MPEG-4 Part 14ï¼ˆç¬¬14éƒ¨åˆ†ï¼‰çš„ç®€åŒ–ç‰ˆå³3GPP Media Release 6 Basic (3gp6ï¼Œå‚è§3GP ) è¿›è¡Œå°è£…çš„AACç¼–ç ï¼ˆNero AAC ç¼–ç å™¨ä»…èƒ½è¾“å‡ºMPEG-4å°è£…çš„AACï¼‰ï¼›</li>
<li>.M4A - ä¸ºäº†åŒºåˆ«çº¯éŸ³é¢‘MP4æ–‡ä»¶å’ŒåŒ…å«è§†é¢‘çš„MP4æ–‡ä»¶è€Œç”±è‹¹æœ(Apple)å…¬å¸ä½¿ç”¨çš„æ‰©å±•åï¼ŒApple iTunes å¯¹çº¯éŸ³é¢‘MP4æ–‡ä»¶é‡‡ç”¨äº†â€.M4Aâ€å‘½åã€‚M4Açš„æœ¬è´¨å’ŒéŸ³é¢‘MP4ç›¸åŒï¼Œæ•…éŸ³é¢‘MP4æ–‡ä»¶äº¦å¯ç›´æ¥æ›´æ”¹æ‰©å±•åä¸ºM4Aã€‚æ˜¯ MPEG-4 Audio æ ‡å‡†å®¹å™¨ï¼Œè€Œ AAC ä½œä¸ºä¸€ä¸ªå®¹å™¨æ˜¯ MPEG-2 æ ‡å‡†çš„ã€‚ç°åœ¨çš„ AAC-LC å°±æ˜¯ä»¥å‰åˆ¶å®šçš„ MPEG-2 æ—¶ä»£çš„ AAC çš„æ›´åå»¶ç»­ï¼Œè€Œ MPEG-4 æ—¶ä»£çš„ AAC å« AAC-HE .AAC-LC å¯ä»¥ç”¨ AAC (ADTS) ä½œå®¹å™¨ä¹Ÿå¯ä»¥ç”¨ MP4 åšå®¹å™¨ï¼Œä¸¤è€…å¯ä»¥ç”¨ MP4Box çš„ä¸€ä¸ªå‘½ä»¤ç›´æ¥è½¬æ¢ï¼Œè€Œ AAC-HE åªèƒ½ç”¨ MP4 åšå®¹å™¨ã€‚</li>
</ul>
<h5 id="Sampling-Frequencies"><a href="#Sampling-Frequencies" class="headerlink" title="Sampling Frequencies"></a>Sampling Frequencies</h5><p>There are 13 supported frequencies:</p>
<ul>
<li>0: 96000 Hz</li>
<li>1: 88200 Hz</li>
<li>2: 64000 Hz</li>
<li>3: 48000 Hz</li>
<li>4: 44100 Hz</li>
<li>5: 32000 Hz</li>
<li>6: 24000 Hz</li>
<li>7: 22050 Hz</li>
<li>8: 16000 Hz</li>
<li>9: 12000 Hz</li>
<li>10: 11025 Hz</li>
<li>11: 8000 Hz</li>
<li>12: 7350 Hz</li>
<li>13: Reserved</li>
<li>14: Reserved</li>
<li>15: frequency is written explictly</li>
</ul>
<h5 id="Channel-Configurations"><a href="#Channel-Configurations" class="headerlink" title="Channel Configurations"></a>Channel Configurations</h5><p>These are the channel configurations:</p>
<ul>
<li>0: Defined in AOT Specifc Config</li>
<li>1: 1 channel: front-center</li>
<li>2: 2 channels: front-left, front-right</li>
<li>3: 3 channels: front-center, front-left, front-right</li>
<li>4: 4 channels: front-center, front-left, front-right, back-center</li>
<li>5: 5 channels: front-center, front-left, front-right, back-left, back-right</li>
<li>6: 6 channels: front-center, front-left, front-right, back-left, back-right, LFE-channel</li>
<li>7: 8 channels: front-center, front-left, front-right, side-left, side-right, back-left, back-right, LFE-channel</li>
<li>8-15: Reserved</li>
</ul>
<h5 id="æœ¯è¯­è¯´æ˜"><a href="#æœ¯è¯­è¯´æ˜" class="headerlink" title="æœ¯è¯­è¯´æ˜"></a>æœ¯è¯­è¯´æ˜</h5><ul>
<li>AAC: Advanced Audio Coding é«˜çº§éŸ³é¢‘ç¼–ç </li>
<li>AAC LC: AAC with Low Complexity AACçš„ä½å¤æ‚åº¦é…ç½®</li>
<li>AAC plus: ä¹Ÿå«HE-AAC, AAC+,MPEG4 AAC LCåŠ å…¥SBRæ¨¡å—åå½¢æˆçš„ä¸€ä¸ªAACç‰ˆæœ¬</li>
<li>MPEGï¼šMotion Picture Expert Group</li>
<li>IMDCTï¼šåç¦»æ•£ä½™å¼¦å˜æ¢</li>
<li>ADIFï¼šAudio Data Interchange Format éŸ³é¢‘æ•°æ®äº¤æ¢æ ¼å¼</li>
<li>ADTSï¼šAudio Data Transport Stream éŸ³é¢‘æ•°æ®ä¼ è¾“æµ</li>
<li>SCE: Single Channel Elementå•é€šé“å…ƒç´ </li>
<li>CPE: Channel Pair Element åŒé€šé“å…ƒç´ </li>
<li>CCE: Coupling Channel Element è—•åˆé€šé“å…ƒç´ </li>
<li>DSE: Data Stream Element æ•°æ®æµå…ƒç´ </li>
<li>PCE: Program Config Element ç¨‹åºé…ç½®å…ƒç´ </li>
<li>FIL: Fill Element å¡«å……å…ƒç´ </li>
<li>ICS: Individual Channel Stream ç‹¬ç«‹é€šé“æµ</li>
<li>PNS: Perceptual Noise Substitution çŸ¥è§‰å™ªå£°æ›¿æ¢</li>
<li>SBR: Spectral Band Replication é¢‘æ®µå¤åˆ¶</li>
<li>TNS: Temporal Noise Shaping ç¬æ—¶å™ªå£°æ•´å½¢</li>
<li>chï¼šchannel é€šé“</li>
</ul>
<h5 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h5><p>AAC-LC æ˜¯ä»€ä¹ˆæ ¼å¼ï¼Ÿå’Œ AAC æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
AACæ˜¯æ ‡å‡†åŒ–åœ¨MPEG2å’ŒMPEG4çš„éŸ³é¢‘ç¼–ç é›†åˆçš„æ€»ç§°ã€‚
AAC-LCæ˜¯æ ‡å‡†åŒ–AACä¸­AOTä¸º2çš„ä¸€ç§éŸ³é¢‘ç¼–è§£ç ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯è¿ç®—å¤æ‚åº¦ä½ï¼Œå¯¹å†…å­˜å ç”¨å°ï¼Œæ ‡å‡†åŒ–çš„æ—¶é—´æ—©ï¼Œå¯¹é€šæ€§å¥½ï¼Œå…¼å®¹æ€§å¥½ï¼Œä½¿ç”¨å¹¿ã€‚ä¸è¶³æ˜¯ç®—æ³•æ—¶å»¶é«˜ï¼Œä¸åˆ©äºå®æ—¶çš„éŸ³é¢‘é€šè®¯ã€‚</p>
<h4 id="é—®é¢˜åŸå› åˆ†æ"><a href="#é—®é¢˜åŸå› åˆ†æ" class="headerlink" title="é—®é¢˜åŸå› åˆ†æ"></a>é—®é¢˜åŸå› åˆ†æ</h4><p>é¦–å…ˆ<code>BufferOverFlowException</code>é—®é¢˜,ç”±äºéŸ³é¢‘é‡‡ç”¨AAC-HEå¯¼è‡´MediaExtractorè§£æå‡ºçš„éŸ³é¢‘é‡‡æ ·ç‡ä¸ºæœ¬èº«é‡‡æ ·ç‡çš„ä¸€åŠ,åŒæ—¶åˆ›å»ºå‡ºçš„è§£ç OutputBufferçš„å¤§å°æ˜¯ç¼–ç InputBufferçš„2å€,è€Œmedia-for-mobileå¼€æºé¡¹ç›®ç›´æ¥å°†ä»è§£ç å™¨OutputBufferå–å‡ºçš„æ•°æ®å¡å…¥ç¼–ç å™¨InputBufferä¸­,2å€çš„æ•°æ®æ”¾å…¥ä¸€å€çš„Bufferå¯¼è‡´æº¢å‡º,æš‚æ—¶çš„è§£å†³åŠæ³•æ‰‹åŠ¨æŒ‡å®šç¼–ç å™¨InputBuffer max-sizeä¸ºä¸€ä¸ªè¾ƒå¤§å€¼(10*1024).åŒæ—¶,ç”±äºMediaExtractorä¸èƒ½è·å–æ­£ç¡®çš„audio profile,ä¹Ÿæ— æ³•ç¡®è®¤è·å–åˆ°çš„é‡‡æ ·ç‡æ˜¯å¦ä¸æ­£ç¡®é‡‡æ ·ç‡çš„ä¸€åŠ,æ‰€ä»¥é‡‡ç”¨ffmpegæ¥å£è·å–profile,ä½†æ˜¯ffmpegè°ƒç”¨<code>avcodec_open2</code>è·å–åˆ°çš„profileä¸º-99,è€Œä¸”é‡‡æ ·ç‡ä¾ç„¶ä¸ºæ­£å¸¸é‡‡æ ·ç‡ä¸€åŠ,åªæœ‰åœ¨è§£ç ä¸€å¸§éŸ³é¢‘åæ‰èƒ½å¾—åˆ°æ­£ç¡®çš„profileä¸é‡‡æ ·ç‡.</p>
<p>å…¶æ¬¡,è½¬ç è¿›åº¦ä¸å¢åŠ çš„é—®é¢˜,ä¸»è¦æ˜¯Highçš„H264è§†é¢‘,media-for-mobileä½¿ç”¨ä¸€ä¸ªMediaExtractorä¸€æ¬¡æŠ½å–éŸ³è§†é¢‘å¸§,å¦‚æœæ˜¯éŸ³é¢‘åˆ™äº¤éŸ³é¢‘è§£ç å™¨,å¦‚æœä¸ºè§†é¢‘åˆ™äº¤è§†é¢‘è§£ç å™¨,è§£ç åå°†è§£ç å¸§è½¬äº¤ç¼–ç å™¨,ç¼–ç åå°†æ•°æ®å†™å…¥MediaMuxer,å°†æ•°æ®å†™å…¥MediaMuxerçš„å‰ææ˜¯åŠç”¨è¿‡addTrack,å°†éŸ³è§†é¢‘trackåŠ å…¥åˆ°Muxerä¸­,è€ŒaddTrackéœ€è¦åœ¨éŸ³è§†é¢‘è§£ç è‹¥å¹²å¸§åäº§ç”Ÿ<code>INFO_OUTPUT_FORMAT_CHANGED</code>,è‹¥æ²¡æœ‰addTrackä¼šå¯¼è‡´ç¼–ç åæ•°æ®å¦‚æ³•å†™å…¥Muxer,å¡æ­»ç¼–ç å™¨,Baselineè§†é¢‘åªéœ€è¦å°‘é‡å¸§å°±å¯ä»¥äº§ç”Ÿ<code>INFO_OUTPUT_FORMAT_CHANGED</code>,ä½†Highè§†é¢‘äº§ç”Ÿ<code>INFO_OUTPUT_FORMAT_CHANGED</code>éœ€è¦æ›´å¤šçš„å¸§,è€Œmedia-for-mobileä¸­,MediaExtractoré¦–å…ˆä¸€ç›´è·å–åˆ°çš„æ˜¯éŸ³é¢‘æ•°æ®,éŸ³é¢‘ä¸€ç›´è§£ç ç¼–ç ,ä½†æ˜¯è¾“å‡ºçš„muxeræ—¶,videotrackæœªè¢«æ·»åŠ ,æ‰€ä»¥æ— æ³•å°†éŸ³é¢‘ç¼–ç å™¨çš„æ•°æ®å†™å…¥muxer,éŸ³é¢‘è§£ç å™¨è¢«å¡æ­»,è€Œmediasourceä¸€ç›´è¢«äº§ç”Ÿçš„audioæ•°æ®æ— æ³•è¢«æ¶ˆè´¹,æ— æ³•è·å–åˆ°è§†é¢‘æ•°æ®å¯¼è‡´è§†é¢‘<code>INFO_OUTPUT_FORMAT_CHANGED</code>ä¸€ç›´æ— æ³•äº§ç”Ÿ,æœ€ç»ˆäº§ç”Ÿæ­»é”,å¯¼è‡´audioç­‰å¾…videoçš„<code>INFO_OUTPUT_FORMAT_CHANGED</code>,videoç­‰å¾…audioè¢«è¯»å®Œåè¯»åˆ°videoè§£ç äº§ç”Ÿ<code>INFO_OUTPUT_FORMAT_CHANGED</code>.</p>
<p>æœ€åå°†audioå’Œvideoä½¿ç”¨ä¸¤ä¸ª<code>MediaExtractor</code>å„è¯»å–å„è‡ªå†…å®¹.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://wodekouwei.com/2017/08/30/at-android-start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="è½»å£å‘³">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€å¸æœºç§èœ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/30/at-android-start/" itemprop="url">
                  androidè‡ªåŠ¨åŒ–æµ‹è¯•(ä¸€):UiAutomatorå®˜æ–¹ä»‹ç»
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-08-30T21:43:15+08:00">
                2017-08-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/autotest/" itemprop="url" rel="index">
                    <span itemprop="name">autotest</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>äº†è§£androidæµ‹è¯•éœ€è¦æŸ¥è¯¢androidå®˜æ–¹æ–‡æ¡£,androidå®˜æ–¹åŸ¹è®­æ•™ç¨‹<a href="https://developer.android.com/training/testing/start/index.html" target="_blank" rel="external">Getting Started with Testing</a>ä»‹ç»äº†androidæä¾›çš„æµ‹è¯•ç±»å‹,æµ‹è¯•æ¥å£ç­‰,ç›¸è¾ƒä¸ç½‘ä¸Šæ€»ç»“çš„androidè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶,å®˜æ–¹æ–‡æ¡£æ˜¾ç„¶åˆ†ç±»æ›´åˆç†,å®šä½æ›´å‡†ç¡®.</p>
<h3 id="ä¸¤ç§æµ‹è¯•ç±»å‹"><a href="#ä¸¤ç§æµ‹è¯•ç±»å‹" class="headerlink" title="ä¸¤ç§æµ‹è¯•ç±»å‹"></a>ä¸¤ç§æµ‹è¯•ç±»å‹</h3><p>åœ¨ä½¿ç”¨Android Studioåˆ›å»ºæ¨¡å—æ—¶ä¼šåœ¨<code>src</code>ä¸‹ç”Ÿæˆ<code>androidTest</code>å’Œ<code>test</code>ä¸¤ä¸ªç”¨äºæµ‹è¯•çš„çš„ç›®å½•,å¯¹åº”ä¸‹é¢ä¸¤ç§æµ‹è¯•ç±»å‹.
<img src="http://images.wodekouwei.com/technology/at_sum.png" alt="image"></p>
<h4 id="æœ¬åœ°å•å…ƒæµ‹è¯•-Local-unit-tests"><a href="#æœ¬åœ°å•å…ƒæµ‹è¯•-Local-unit-tests" class="headerlink" title="æœ¬åœ°å•å…ƒæµ‹è¯•(Local unit tests)"></a>æœ¬åœ°å•å…ƒæµ‹è¯•(Local unit tests)</h4><p>ä½äº<code>module-name/src/test/java/.</code>ä¸‹,è¿è¡Œåœ¨PCç«¯æœ¬åœ°çš„JVMè™šæ‹Ÿæœºä¸Š,å¹¶ä¸”ä¸èƒ½è®¿é—®Androidæ¡†æ¶çš„æ¥å£.
å‚è€ƒ<a href="https://developer.android.com/training/testing/unit-testing/local-unit-tests.html" target="_blank" rel="external">Building Local Tests</a></p>
<h4 id="è®¾å¤‡åŒ–æµ‹è¯•"><a href="#è®¾å¤‡åŒ–æµ‹è¯•" class="headerlink" title="è®¾å¤‡åŒ–æµ‹è¯•"></a>è®¾å¤‡åŒ–æµ‹è¯•</h4><p>ä½äº<code>module-name/src/androidTest/java/.</code>ä¸‹,å¿…é¡»è¿è¡Œåœ¨Androidç‰©ç†è®¾å¤‡å’Œè™šæ‹Ÿæœºä¸Š.
å‚è€ƒ<a href="https://developer.android.com/training/testing/unit-testing/instrumented-unit-tests.html" target="_blank" rel="external">Building Instrumented Unit Tests</a></p>
<p>Instrumented unit tests are tests that run on physical devices and emulators, and they can take advantage of the Android framework APIs and supporting APIs, such as the Android Testing Support Library. You should create instrumented unit tests if your tests need access to instrumentation information (such as the target appâ€™s Context) or if they require the real implementation of an Android framework component (such as a Parcelable or SharedPreferences object).</p>
<p>Using instrumented unit tests also helps to reduce the effort required to write and maintain mock code. You are still free to use a mocking framework, if you choose, to simulate any dependency relationships.</p>
<p>è®¾å¤‡åŒ–å•å…ƒæµ‹è¯•åˆ†ä¸º:</p>
<ul>
<li>è®¾å¤‡åŒ–å•å…ƒæµ‹è¯•(Instrumented Unit Test):<a href="https://developer.android.com/training/testing/unit-testing/instrumented-unit-tests.html" target="_blank" rel="external">Building Instrumented Unit Tests</a>: Build complex unit tests with Android dependencies that cannot be satisfied with mock objects.</li>
<li>ç»„ä»¶é›†æˆæµ‹è¯•:<a href="https://developer.android.com/training/testing/ui-testing/index.html" target="_blank" rel="external">Automating User Interface Tests</a>: Create tests to verify that the user interface behaves correctly for user interactions within a single app or for interactions across multiple apps.</li>
<li>appé›†æˆæµ‹è¯•:<a href="https://developer.android.com/training/testing/integration-testing/index.html" target="_blank" rel="external">Testing App Component Integrations</a>: Verify the behavior of components that users do not directly interact with, such as a Service or aContent Provider.</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://images.wodekouwei.com/avatar/winnle_the_pooh.jpg"
               alt="è½»å£å‘³" />
          <p class="site-author-name" itemprop="name">è½»å£å‘³</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">98</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">52</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/qingkouwei" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/LightTaste" target="_blank" title="å¾®åš">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  å¾®åš
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/turnpp/" target="_blank" title="è±†ç“£">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  è±†ç“£
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/shen-jun-wei-9/" target="_blank" title="çŸ¥ä¹">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  çŸ¥ä¹
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              å‹æƒ…é“¾æ¥
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://github.com/ossrs/srs" title="SRS" target="_blank">SRS</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">è½»å£å‘³</span>
</div>

<div>
<a href="http://www.miitbeian.gov.cn/">äº¬ICPå¤‡17018543å·</a>

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      æœ¬ç«™è®¿å®¢æ•°
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      äººæ¬¡
    </span>
  

  
    <span class="site-pv">
      æœ¬ç«™æ€»è®¿é—®é‡
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      æ¬¡
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "bb46b146831e4e34808d09cd94c85f50",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

</body>
</html>
